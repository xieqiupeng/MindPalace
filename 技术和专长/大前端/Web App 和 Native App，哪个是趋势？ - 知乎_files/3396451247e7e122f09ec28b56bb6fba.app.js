(function(a){with(a){
a.Cr=function(b,c){this.ba=b;this.offset=c},a.Dr=function(b){return b.length||b.childNodes.length},a.Er=function(b,c,d){for(;1==b.nodeType;){var e=b.childNodes[c];if(!e&&!b.lastChild)break;e?(b=e.previousSibling,d&&b?c=Dr(b):(b=e,c=0)):(b=b.lastChild,c=Dr(b))}return new Cr(b,c)},a.Fr=function(b,c){b!=k&&this.append.apply(this,arguments)};t=Fr.prototype;t.mh="";t.set=function(b){this.mh=""+b};t.append=function(b,c,d){this.mh+=b;if(c!=k)for(var e=1;e<arguments.length;e++)this.mh+=arguments[e];return this};
t.clear=function(){this.mh=""};t.fr=u(48);t.toString=p("mh");a.Gr=function(b){this.type="anon_change";this.jb=b};y(Gr,fd);a.Hr=function(b){if("outerHTML"in b)return b.outerHTML;var c=Qb(b).createElement("div");c.appendChild(b.cloneNode(j));return c.innerHTML},a.Z=function(b,c){return da[b]=c};Nf.prototype.expand=Z(62,function(b,c,d,e){ra(b)?(this.top-=b.top,this.right+=b.right,this.bottom+=b.bottom,this.left-=b.left):(this.top-=b,this.right+=c,this.bottom+=d,this.left-=e);return this});
no.prototype.expand=Z(61,function(){this.Ka(j)});Oh.prototype.Io=Z(60,function(b){Ph(this);this.zk=b});vi.prototype.Io=Z(59,function(b){this.zk=b;this.za&&wi(this)});Tn.prototype.dm=Z(55,function(b){this.Ha(b)});Wd.prototype.di=Z(54,ca("kF"));Oh.prototype.px=Z(53,function(){return this.tj||150>za()-this.xx});Mo.prototype.Bb=Z(52,function(){var b=this.qc();return 1==b.nodeType?b:b.parentNode});uh.prototype.Ff=Z(51,ca("oi"));Aj.prototype.Ff=Z(50,ca("oi"));sq.prototype.Fe=Z(49,function(b){this.Y.jt(b)});
Fr.prototype.fr=Z(48,function(){return this.mh.length});yl.prototype.fireEvent=Z(37,function(b){this.dispatchEvent(b)});dm.prototype.Fc=Z(32,function(){return Ec(this.m())});Yo.prototype.Fc=Z(31,function(){return this.Q.toString()});cp.prototype.Fc=Z(30,function(){return this.Q.text});mp.prototype.Fc=Z(29,function(){return qp(this).Fc()});sp.prototype.Fc=Z(28,s(""));yp.prototype.Fc=Z(27,function(){return z.map(Oo(this),function(b){return b.Fc()}).join("")});
Pb.prototype.bv=Z(22,function(b,c,d){for(var e=this.Ga,g=!!d,d=["<tr>"],h=0;h<c;h++)d.push(g?"<td>&nbsp;</td>":"<td></td>");d.push("</tr>");d=d.join("");c=["<table>"];for(h=0;h<b;h++)c.push(d);c.push("</table>");b=e.createElement("DIV");b.innerHTML=c.join("");return b.removeChild(b.firstChild)});Th.prototype.Oo=Z(19,ca("Lj"));Tn.prototype.Oo=Z(18,ca("Lj"));uh.prototype.hz=Z(17,function(b){this.Mw=Math.pow(b,2)});
ff.prototype.Mp=Z(14,function(b,c,d){var e=za(),g=d?d:e,h=this.Xk.wg.length?this.Xk.wg.pop():this.Xk.Ik();h.Tq=2;h.Sq=g;h.type=c;h.GB=b;b=(b=this.DW)&&b.isTracing()?b.totalVarAlloc:-1;h.rH=b;this.Wu++;if(d){d=this.Hf.length;for(b=0;b<d;b++)if(this.Hf[b].Sq>g){z.In(this.Hf,h,b);break}b==d&&this.Hf.push(h)}else this.Hf.push(h);if(g=h.type)h=this.Yj.get(g),h||(h=this.$o.wg.length?this.$o.wg.pop():this.$o.Ik(),h.type=g,this.Yj.set(g,h)),h.count++;this.It+=za()-e});
Yd.prototype.config=Z(13,function(b,c){this.log(de,b,c)});so.prototype.dw=Z(12,function(){return vo});Cq.prototype.dr=Z(0,p("Ja"));
a.Ir=function(b){return b.Md?b.Ja:b.Ja.m()},a.Jr=function(b){b.mx=j;b.VB=sg(b.m()).height;hq+=b.VB;z.forEach(fq,function(b){b&&(!b.mx&&b.bl)&&b.zo()})},a.Kr=function(b,c){var d=b.parentNode,e=z.indexOf(d.childNodes,b)+(c?0:1),d=Er(d,e,c);A&&(D("9")&&1==d.ba.nodeType&&"HR"==d.ba.tagName)&&(e=d.ba,d.ba=e.parentNode,d.offset=z.indexOf(d.ba.childNodes,e)+(c?0:1));Fp(d.ba,d.offset).select()},a.Lr=function(b,c){if(Sm(b))b.selectionStart=c,b.selectionEnd=c;else if(A){var c=Vm(b,c),d=b.createTextRange();
d.collapse(j);d.move("character",c);d.select()}},a.Mr=function(b,c){b.Lx=c==k||c instanceof Nf?c:new Nf(c,i,i,i);b.P()&&b.fa()},a.Nr=function(b){var c={};z.forEach(b.data.Cb(),function(b){c[b]=this.data.get(b)},b);return c},a.Or=function(b){b.Xb()&&b.fire()},a.Pr=function(b,c){return b.yd.get(c)},a.Qr=function(b,c,d){var e=Ji,g={title:"确认使用匿名身份？",content:'<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>'},h={title:"确认放弃匿名身份？",
content:"你对该问题的回答、赞同和关注行为将以实名显示。"};Ai(b?g:h,function(g){if(g){var h=new V(j),q="/question/"+(b?"set_anonymous":"set_public"),r="qid="+(d||ch.ka);h.on("success",function(){var c=He(h);c&&!c.r&&e.dispatchEvent(new Gr(b))});h.ajax(q,r)}c&&c(g)})},a.Rr=function(b,c){return b.Sb&&c?z.indexOf(b.Sb,c):-1},a.Sr=function(b){return b!=k},a.Tr=function(b){return!/[^\t\n\r ]/.test(b)},a.Ur=function(b,c,d){this.qF=b;this.qR=!!d;b&&!c&&this.next()};y(Ur,Ld);
Ur.prototype.next=function(){var b=this.qF;b||f(P.Za);this.qF=this.qR?b.previousSibling:b.nextSibling;return b};a.Vr=function(b){return 1==b.nodeType||3==b.nodeType&&!Tr(b.nodeValue)},a.Wr=function(b){try{return b.next()}catch(c){return k}},a.Xr=function(b,c,d){ka(d)||(d=c&&b.childNodes.length?b.childNodes.length-1:0);Ur.call(this,b.childNodes[d],j,c)};y(Xr,Ur);
a.Yr=function(b){return 1==b.length?"0"+b:b},a.Zr=/^#(?:[0-9a-f]{3}){1,2}$/i,a.$r=function(b,c,d,e,g,h,l,n,q){fd.call(this,b);this.pW=c;this.event=d;this.lW=e;this.qW=g;this.Mq=h;this.rW=l;this.NW=n;this.OW=q};y($r,fd);
a.as=function(b,c){return b>c},a.bs=function(b,c){return b<c},a.cs=function(b){return b.left||0},a.ds=function(b){return b.left+b.width-1},a.es=function(b){return b.top+b.height-1},a.fs=function(b,c){var d=b.Rk;return Math.abs(c.y-(d.top+(d.height-1)/2))},a.gs=function(b,c){var d=$.extend({all:m},gs.defaults,c||{}),e=$(b).get(0).getBoundingClientRect();return!d.all&&(e.bottom<d.paddingTop||e.bottom>$(window).height())||d.all&&(e.top<d.paddingTop||e.bottom>$(window).height())?m:j};gs.defaults={paddingTop:0};
a.hs=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,a.is=/#(.)(.)(.)/,a.js=function(b,c,d){var e=cg(b);c instanceof Lb&&(d=c.y,c=c.x);Zf(b,b.offsetLeft+(c-e.x),b.offsetTop+(d-e.y))},a.ks=function(b){var c=b.body,b=b.documentElement;return new Lb(c.scrollLeft||b.scrollLeft,c.scrollTop||b.scrollTop)},a.ls=function(b){for(var c;c=!b||1!=b.nodeType?k:Wr(P.filter(new Xr(b,m),Vr));)b=c;return b},a.ms=function(b,c,d){Do.call(this,b,0,d?"添加父话题":"添加子话题");this.qx=d;this.rf=c;this.Lr=
"";this.uG="/topic/parent/remove";this.LV=j};y(ms,Do);t=ms.prototype;t.o=function(b){if(this.isEnabled=!b.getAttribute("data-disabled"))ms.n.o.call(this,b),this.Be(j),R(this.LC,m)};t.Dg=function(b){var c;this.qx&&(c="/topic/autocomplete?no_create=true");ms.n.Dg.call(this,b,c);this.T.gf.JC=m};t.Zl=function(){return v(function(b,c){return z.filter(b,function(b){return 3>=b.length?m:z.every(this.data,function(e){return e[1]===b[2]?c===b[1]?(b[0]="plain_text",b[1]='"'+c+'"已在现有列表中',j):m:j})},this)},this)};
t.Me=function(b,c){this.Kg||(this.Kg=j,this.xhr=new V(j),me(this.h(),this.xhr,"complete",this.lu),b||(b=-1),this.qx?this.xhr.ajax("/topic/add","tid="+this.rf+"&pid="+b+"&topic_text="+encodeURIComponent(c)):this.xhr.ajax("/topic/add","tid="+this.rf+"&cid="+b+"&topic_text="+encodeURIComponent(c)))};t.SC=function(b){return'<a class="nor" href="/topic/'+b[1]+'/organize">'+b[0]+"</a>"};
t.so=function(b){if(!this.ga||!this.ga.Xb()){var c=new V(j);this.h().e(c,"success",function(){var d=He(c);d.r?U(d.msg):(Fo(this),this.Ge(),this.dispatchEvent({type:"remove_tag",data:{id:b}}))});this.qx?c.ajax(this.uG,"cid="+this.rf+"&pid="+b):c.ajax(this.uG,"pid="+this.rf+"&cid="+b);this.ga=c}};a.ns=function(){N.call(this);this.Nc=[];this.Sk=[];this.uv={};this.N=new ke(this);this.SN=this.qE=m;this.cA=j};y(ns,Fd);t=ns.prototype;t.QD=0;t.hz=ca("QD");a.os=function(b,c,d){c.sC=d;c.Pi=i;b.Nc.push(c)};
t.z=function(){if(!this.qE){for(var b=0,c=this.Nc.length;b<c;b++)for(var d=nc(this.Nc[b]),e=0,g=d.length;e<g;++e){var h=d[e],l=h,n=ua(l);this.uv[n]=h;this.uC&&(this.N.e(h,"mouseover",this.gM),this.N.e(h,"mouseout",this.fM));this.tC&&(this.N.e(l,"mouseover",this.eM),this.N.e(l,"mouseout",this.dM));this.Sk.push(h);this.N.e(l,["mousedown","touchstart"],this.LM)}this.qE=j}};
t.w=function(){this.N.G();for(var b=0,c=this.Nc.length;b<c;b++){var d=this.Nc[b];d.sC=i;d.Pi=i}this.Nc.length=0;this.Sk.length=0;this.uv=k;ps(this);ns.n.w.call(this)};a.qs=function(b,c){for(var d=0,e=b.Nc.length;d<e;d++){var g=b.Nc[d];g.Rk=ng(g)}d=0;for(e=b.Sk.length;d<e;d++)g=b.Sk[d],g!=c&&(g.Rk=ng(g))};
t.LM=function(b){var c=ua(b.currentTarget);this.xa=this.uv[c];a:{var c=this.xa,d=c.cloneNode(j);switch(c.tagName.toLowerCase()){case "tr":c=L("table",k,L("tbody",k,d));break a;case "td":case "th":c=L("table",k,L("tbody",k,L("tr",k,d)));break a;default:c=d}}this.yb=c;this.Nq&&F.add(this.yb,this.Nq);this.yb.style.margin="0";this.yb.style.position="absolute";this.yb.style.visibility="hidden";Qb(this.xa).body.appendChild(this.yb);c=cg(this.xa);js(this.yb,c);this.zb=new uh(this.yb);this.zb.hz(this.QD);
O(this.zb,"start",this.ww,m,this);O(this.zb,"end",this.bM,m,this);O(this.zb,"earlycancel",this.Qu,m,this);this.zb.om(b)};
t.ww=function(b){if(this.dispatchEvent(new $r("beforedragstart",this,b.rB,this.xa,k,k))){this.Bs=this.xa.parentNode;this.TB=this.sy=this.xa.nextElementSibling!=i?this.xa.nextElementSibling:oc(this.xa.nextSibling,j);this.gv=this.Bs;this.fv?F.add.apply(k,z.concat(this.xa,this.fv)):this.xa.style.visibility="hidden";var c=mg(this.yb);this.yb.KL=c.width/2;this.yb.JL=c.height/2;this.yb.style.visibility="";this.cA&&(this.xa.style.display="none");qs(this,this.xa);this.xa.style.display="";O(this.zb,"drag",
this.hM,m,this);this.dispatchEvent(new $r("dragstart",this,b.rB,this.xa,this.yb,this.zb))}else b.preventDefault(),this.Qu()};
t.hM=function(b){var c=cg(this.yb),c=new Lb(c.x+this.yb.KL,c.y+this.yb.JL),d;a:{d=k;if("none"!=this.xa.style.display){d=this.xa.parentNode;var e=ng(d);if(rs(c,e))break a}for(var e=0,g=this.Nc.length;e<g;e++){var h=this.Nc[e];if(h!=d&&rs(c,h.Rk)){d=h;break a}}d=k}var l;if(d){d==k&&f(Error("getHoverNextItem_ called with null hoverList."));var n,q,e=m,g=i;switch(d.sC){case 0:l=c.y;n=es;q=bs;break;case 4:e=j;case 2:l=c.x;n=ds;q=bs;break;case 5:e=j;case 3:l=c.x,n=cs,q=as}for(var h=k,r,w=nc(d),E=0,H=w.length;E<
H;E++){var I=w[E];if(I!=this.xa){var Q=n(I.Rk);if(e){var X=fs(I,c);ka(g)||(g=X);if(q(l,Q)&&(r==i||X<g||X==g&&(q(Q,r)||Q==r)))h=I,r=Q;X<g&&(g=X)}else if(q(l,Q)&&(r==i||q(Q,r)))h=I,r=Q}}l=h!==k&&fs(h,c)>g?k:h}else l=k;if(!this.dispatchEvent(new $r("beforedragmove",this,b,this.xa,this.yb,this.zb,c,d,l)))return m;if(d)this.cA?(this.xa.parentNode!=d||(this.xa.nextElementSibling!=i?this.xa.nextElementSibling:oc(this.xa.nextSibling,j))!=l)&&d.insertBefore(this.xa,l):l&&(this.TB=l),this.xa.style.display=
"",d.Pi&&F.add(d,d.Pi);else{this.SN||(this.xa.style.display="none");n=0;for(q=this.Nc.length;n<q;n++)r=this.Nc[n],r.Pi&&F.remove(r,r.Pi)}d!=this.gv&&(this.gv=d,qs(this,this.xa));this.dispatchEvent(new $r("dragmove",this,b,this.xa,this.yb,this.zb,c,d,l));return m};t.Qu=function(){ps(this);this.zb=this.yb=this.sy=this.Bs=this.gv=this.xa=k;for(var b=0,c=this.Nc.length;b<c;b++)this.Nc[b].Rk=k;b=0;for(c=this.Sk.length;b<c;b++)this.Sk[b].Rk=k};
t.bM=function(b){if(!this.dispatchEvent(new $r("beforedragend",this,b,this.xa,this.yb,this.zb)))return m;this.cA||this.Bs.insertBefore(this.xa,this.TB);ps(this);this.dispatchEvent(new $r("dragend",this,b,this.xa,this.yb,this.zb));this.Qu();return j};
a.ps=function(b){Sc(b.zb);b.yb&&M(b.yb);b.xa&&"none"==b.xa.style.display&&(b.Bs.insertBefore(b.xa,b.sy),b.xa.style.display="");b.fv&&b.xa?F.remove.apply(k,z.concat(b.xa,b.fv)):b.xa&&(b.xa.style.visibility="visible");for(var c=0,d=b.Nc.length;c<d;c++){var e=b.Nc[c];e.Pi&&F.remove(e,e.Pi)}};t.gM=function(b){F.add.apply(k,z.concat(b.currentTarget,this.uC))};t.fM=function(b){F.remove.apply(k,z.concat(b.currentTarget,this.uC))};t.eM=function(b){F.add.apply(k,z.concat(b.currentTarget,this.tC))};
t.dM=function(b){F.remove.apply(k,z.concat(b.currentTarget,this.tC))};a.rs=function(b,c){return b.x>c.left&&b.x<c.left+c.width&&b.y>c.top&&b.y<c.top+c.height},a.ss=function(b,c){this.rh=b instanceof Lb?b:new Lb(b,c)};y(ss,$l);ss.prototype.fa=function(b,c,d,e){var g=ks(Qb(b)),h=this.rh.x+g.x,g=this.rh.y+g.y,l=Xl(b),h=h-l.x,g=g-l.y;Yl(new Lb(h,g),b,c,d,k,k,e)};
a.ts=function(b,c){if(b){"number"===$.type(c)&&(c={offsetTop:c});var d=$.extend({OH:gs},Mk,c||{});if(!d.OH(b,d)){var e=$(b).offset().top-d.paddingTop-d.offsetTop||0;d.$A?$(document.documentElement).add(document.body).animate({scrollTop:e}):$(window).scrollTop(e)}}},a.us=function(b,c){c.all=j;return gs(b,c)},a.vs=function(b,c,d,e){var g=k;e&&(d&&(d=$.proxy(d,e)),g&&(g=$.proxy(g,e)));$.get("/node/"+b,{params:c},function(b){b&&b.r?g&&g(b):d&&d(b)})},a.ws=function(b){var c=b.match(hs);if(c){var b=Number(c[1]),
d=Number(c[2]),c=Number(c[3]);if(0<=b&&255>=b&&0<=d&&255>=d&&0<=c&&255>=c)return[b,d,c]}return[]},a.xs=function(b){Zr.test(b)||f(Error("'"+b+"' is not a valid hex color"));4==b.length&&(b=b.replace(is,"#$1$1$2$2$3$3"));return b.toLowerCase()},a.ys={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",
chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",
darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",
lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",
mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",
peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",
wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},a.zs=/[^\d]+$/,a.As=function(b){Fp(ls(b),0).select()},a.Bs=function(b,c){var d=Fc(b);if(b.getElementsByTagName)for(var e in dq)if(b.tagName==e||0<b.getElementsByTagName(e).length)return m;return!c&&" "==d||Tr(d)},a.Cs=j,a.Ds=function(b){if(b=No(b||window))if(b.empty)try{b.empty()}catch(c){}else try{b.removeAllRanges()}catch(d){}},a.Es=function(b){Do.call(this);this.WB=k;this.we="例如：互联网、医学、法律、数学...";this.data=
b||[]};y(Es,Do);t=Es.prototype;
t.o=function(b){this.g=b;this.bg=K("zm-tag-editor-labels",this.g);this.Be(j);this.je();this.gb();this.If=J("zh-expert-topics");this.ym=J("zh-active-topics");if(this.If)$(this.If).on("click",".del",$.proxy(function(b){var d=$(b.target).parents(".item");d.data("active")?(kc(this.ym,d[0],0),wk(d[0])):M(d[0]);z.forEach(this.data,function(b,c){b+""===d.data("url-token")+""&&this.data.splice(c,1)},this);Fs(this);this.dispatchEvent("remove")},this));if(this.ym)$(this.ym).on("click",".add",$.proxy(function(b){b=
$(b.target).parents(".item");kc(this.If,b[0],0);wk(b[0]);Fs(this);this.dispatchEvent("add")},this));this.data=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();this.Xl()};t.hn=function(){this.Oc||(this.Oc=L("div","zm-tag-editor-editor",[this.Ue=L("div","zg-section zm-tag-editor-command-buttons-wrap",[this.fb=J("profile-expert-edit-input")])]),this.we&&(this.vx=new Em(this.we),this.vx.o(this.fb),this.fb.title=this.we),jc(this.Oc,this.bg),this.Dg(this.Ue))};
t.Dg=function(b){this.T=new yn("/topic/autocomplete",this.fb,k,k,b,j);this.T.gi(j);this.T.Bl=this.Ce;this.T.Po(this.Zl());this.T.Gv=[this.we];this.h().e(this.T,"select",this.ho);this.h().e(this.T,Mm.ih.wi,this.ku);this.h().e(this.T,Mm.ih.wi,this.hu);this.h().e(this.T,Mm.ih.nI,function(){$(this.T.M.g).hide()})};t.hu=function(){if(0===this.T.eb.length){var b=L("div",{className:"zu-autocomplete-empty"},"没有名字为 "+$(this.fb).val()+" 的话题");$(this.T.M.g).html(b).show()}};
t.ho=function(){var b=this.T.$i().slice(1);b&&3<b.length&&(this.$B=b,this.Me(b))};t.Me=function(b){this.data.push(b[1]);var c=$(this.If).find("[data-url-token='"+b[1]+"']")[0];c?wk(c):(vs("TopicMediumV2",{member_url_token:S[1],topic_url_token:b[1]},this.zq,this),$(this.ym).find("[data-url-token='"+b[1]+"']").remove(),this.dispatchEvent("add"))};t.zq=function(b){b=$(b)[0];kc(this.If,b,0);wk(b);Fs(this)};t.Ge=ba();
t.Xl=function(){if(!ah.uc){var b=this;this.Ef&&this.Ef.G();var c=new ns;c.Nq="expert-item-moving";os(c,this.If,4);c.z();this.Ef=c;this.h().e(this.Ef,"dragend",function(){this.dispatchEvent("sort")});$("a, input, .del, .add",this.If).each(function(){b.h().e(this,"mousedown",function(b){b.stopPropagation()})});this.h().e(this.Ef,"beforedragstart",function(){return K("editing",this.If)?m:j})}};
a.Fs=function(b){var c=$(b.If).children().length;6<c&&M($(b.If).children()[6]);R(J("zh-profile-expert-empty"),0>=c);0<c&&R(J("zh-profile-expert-warning"),m);R(J("active-topics-wrap"),$(b.ym).children().length);b.Xl()};t.Zl=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d+""!==b[2]+""&&3<b.length})},this)},this)};a.Gs=function(b){Do.call(this,b,0);this.Lr="";this.oB="/topic/ignore"};y(Gs,ms);
Gs.prototype.Me=function(b){this.Kg||(this.Kg=j,this.xhr=new V(j),me(this.h(),this.xhr,"complete",this.lu),this.xhr.ajax(this.oB,"tid="+b+"&method=add"))};Gs.prototype.so=function(b){this.Kg||(this.Kg=j,this.xhr=new V(j),this.h().e(this.xhr,"complete",function(){Fo(this);this.Ge();this.Kg=m}),this.xhr.ajax(this.oB,"tid="+b+"&method=del"))};a.Hs=function(){Do.call(this,k,k,"搜索话题");this.WB=k;this.we="";this.data=[fh[0]]};y(Hs,Do);t=Hs.prototype;
t.o=function(b){this.g=b;this.bg=K("zm-tag-editor-labels",this.g);this.Be(j);this.je();this.gb()};t.hn=function(){this.Oc||(this.Oc=L("div","zm-tag-editor-editor",[this.cn=L("div","zg-section zg-clear"),this.Ue=L("div","zg-section zm-tag-editor-command-buttons-wrap",[this.fb=J("zh-topic-merge-input"),L("a",{"class":"zg-mr15 zg-btn-blue",href:"#",name:"add",style:"display:none;"},"添加"),this.LC=J("zh-topic-merge-btn")])]),jc(this.Oc,this.bg),this.Dg(this.Ue))};
t.Dg=function(b){this.T=new yn("/topic/autocomplete",this.fb,k,k,b,j);this.T.gi(j);this.T.Bl=this.Ce;this.T.Po(this.Zl());this.T.Gv=[this.we];this.h().e(this.T,"select",this.ho);this.h().e(this.T,Mm.ih.wi,this.ku)};t.Zl=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d[1]!==b[1]&&3<b.length})},this)},this)};t.ho=function(){var b=this.T.$i().slice(1);b&&3<b.length&&(this.$B=b,this.Me(b[3],b[0]))};
t.Me=function(b,c){var d=this;setTimeout(function(){d.fb.value=c});this.WB=b};t.Ge=ba();a.Is=function(b,c,d){T.call(this,d);this.M=c||so.O();this.vb=b||this.M.dw()};y(Is,T);t=Is.prototype;t.tx=k;t.lb=k;t.M=k;t.vb=k;t.kb=j;t.dc=j;t.Uv=j;t.Db=-1;t.hc=k;t.Rf=m;t.iJ=m;t.kQ=j;t.og=k;t.fc=function(){return this.tx||this.M.fc(this)};t.er=function(){return this.lb||(this.lb=new Wm(this.fc()))};t.v=function(){this.g=this.M.v(this)};t.U=function(){return this.M.U(this.m())};t.nc=function(b){return this.M.nc(b)};
t.$=function(b){this.g=this.M.o(this,b);"none"==b.style.display&&(this.kb=m)};t.B=function(){Is.n.B.call(this);Lh(this,function(b){b.za&&Js(this,b)},this);var b=this.m();this.M.ve(this);this.D(this.kb,j);this.h().e(this,"enter",this.xw).e(this,"highlight",this.Cw).e(this,"unhighlight",this.Kw).e(this,"open",this.IM).e(this,"close",this.UL).e(b,"mousedown",this.se).e(Qb(b),"mouseup",this.aM).e(b,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.SL);this.Kh()&&Ks(this,j)};
a.Ks=function(b,c){var d=b.h(),e=b.fc();c?d.e(e,"focus",b.re).e(e,"blur",b.Qc).e(b.er(),"key",b.Vb):d.Ea(e,"focus",b.re).Ea(e,"blur",b.Qc).Ea(b.er(),"key",b.Vb)};t.ib=function(){this.Mb(-1);this.hc&&this.hc.qb(m);this.Rf=m;Is.n.ib.call(this)};t.w=function(){Is.n.w.call(this);this.lb&&(this.lb.G(),this.lb=k);this.M=this.hc=this.og=this.tx=k};t.xw=s(j);
t.Cw=function(b){var c=Rr(this,b.target);if(-1<c&&c!=this.Db){var d=Ls(this);d&&d.nd(m);this.Db=c;d=Ls(this);this.Rf&&d.setActive(j);this.kQ&&(this.hc&&d!=this.hc)&&(d.Nb&64?d.qb(j):this.hc.qb(m))}Mc(this.m(),Tc.um,b.target.m().id)};t.Kw=function(b){b.target==Ls(this)&&(this.Db=-1);Mc(this.m(),Tc.um,"")};t.IM=function(b){if((b=b.target)&&b!=this.hc&&b.getParent()==this)this.hc&&this.hc.qb(m),this.hc=b};t.UL=function(b){b.target==this.hc&&(this.hc=k)};
t.se=function(b){this.dc&&(this.Rf=j);var c=this.fc();c&&Bc(c)?c.focus():b.preventDefault()};t.aM=function(){this.Rf=m};t.SL=function(b){var c;a:{c=b.target;if(this.og)for(var d=this.m();c&&c!==d;){var e=c.id;if(e in this.og){c=this.og[e];break a}c=c.parentNode}c=k}if(c)switch(b.type){case "mousedown":c.se(b);break;case "mouseup":c.Nf(b);break;case "mouseover":c.hd(b);break;case "mouseout":c.Hh(b);break;case "contextmenu":c.vn(b)}};t.re=ba();t.Qc=function(){this.Mb(-1);this.Rf=m;this.hc&&this.hc.qb(m)};
t.Vb=function(b){return this.isEnabled()&&this.P()&&(0!=Mh(this)||this.tx)&&this.bf(b)?(b.preventDefault(),b.stopPropagation(),j):m};
t.bf=function(b){var c=Ls(this);if(c&&"function"==typeof c.Vb&&c.Vb(b)||this.hc&&this.hc!=c&&"function"==typeof this.hc.Vb&&this.hc.Vb(b))return j;if(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey)return m;switch(b.keyCode){case 27:if(this.Kh())this.fc().blur();else return m;break;case 36:Ms(this);break;case 35:Ns(this,function(b,c){b--;return 0>b?c-1:b},0);break;case 38:if(this.vb==vo)Os(this);else return m;break;case 37:if(this.vb==uo)this.wd()?Ps(this):Os(this);else return m;break;case 40:if(this.vb==
vo)Ps(this);else return m;break;case 39:if(this.vb==uo)this.wd()?Os(this):Ps(this);else return m;break;default:return m}return j};a.Js=function(b,c){var d=c.m(),d=d.id||(d.id=c.Od());b.og||(b.og={});b.og[d]=c};t.H=function(b,c){Is.n.H.call(this,b,c)};t.vk=function(b,c,d){b.Xj|=2;b.Xj|=64;(this.Kh()||!this.iJ)&&Wn(b,32,m);b.Mo(m);Is.n.vk.call(this,b,c,d);b.za&&this.za&&Js(this,b);c<=this.Db&&this.Db++};
t.removeChild=function(b,c){if(b=oa(b)?Jh(this,b):b){var d=Rr(this,b);-1!=d&&(d==this.Db?b.nd(m):d<this.Db&&this.Db--);(d=b.m())&&(d.id&&this.og)&&G.remove(this.og,d.id)}b=Is.n.removeChild.call(this,b,c);b.Mo(j);return b};t.No=function(b){this.m()&&f(Error("Component already rendered"));this.vb=b};t.P=p("kb");
t.D=function(b,c){if(c||this.kb!=b&&this.dispatchEvent(b?"show":"hide")){this.kb=b;var d=this.m();if(d){R(d,b);if(this.Kh()&&(d=this.fc()))d.tabIndex=this.dc&&this.kb?0:-1;c||this.dispatchEvent(this.kb?"aftershow":"afterhide")}return j}return m};t.isEnabled=p("dc");
t.Xa=function(b){if(this.dc!=b&&this.dispatchEvent(b?"enable":"disable"))if(b?(this.dc=j,Lh(this,function(b){b.RH?delete b.RH:b.Xa(j)})):(Lh(this,function(b){b.isEnabled()?b.Xa(m):b.RH=j}),this.Rf=this.dc=m),this.Kh()){var c=this.fc();c&&(c.tabIndex=b&&this.kb?0:-1)}};t.Kh=p("Uv");t.Ie=function(b){b!=this.Uv&&this.za&&Ks(this,b);this.Uv=b;if(this.dc&&this.kb){var c=this.fc();c&&(c.tabIndex=b?0:-1)}};t.Mb=function(b){(b=Nh(this,b))?b.nd(j):-1<this.Db&&Ls(this).nd(m)};
t.nd=function(b){this.Mb(Rr(this,b))};a.Ls=function(b){return Nh(b,b.Db)},a.Ms=function(b){Ns(b,function(b,d){return(b+1)%d},Mh(b)-1)},a.Ps=function(b){Ns(b,function(b,d){return(b+1)%d},b.Db)},a.Os=function(b){Ns(b,function(b,d){b--;return 0>b?d-1:b},b.Db)},a.Ns=function(b,c,d){for(var d=0>d?Rr(b,b.hc):d,e=Mh(b),d=c.call(b,d,e),g=0;g<=e;){var h=Nh(b,d);if(h&&b.uB(h)){b.gz(d);break}g++;d=c.call(b,d,e)}};t.uB=function(b){return b.P()&&b.isEnabled()&&!!(b.Nb&2)};t.gz=function(b){this.Mb(b)};
a.Qs=function(b,c){ss.call(this,b,c)};y(Qs,ss);Qs.prototype.Tn=0;Qs.prototype.fm=ca("Tn");Qs.prototype.fa=function(b,c,d,e){var g=$f(b),g=eg(g),h;h=Rb(b);h=Yb(h.Ga);h=new Lb(this.rh.x+h.scrollLeft,this.rh.y+h.scrollTop);var l=c,n=Yl(h,b,l,d,g,10,e);if(0!=(n&496)){if(n&16||n&32)l^=2;if(n&64||n&128)l^=1;n=Yl(h,b,l,d,g,10,e);0!=(n&496)&&Yl(h,b,c,d,g,this.Tn,e)}};a.Rs=function(b,c,d,e){am.call(this,b,c);this.Tn=d?5:0;this.vy=e||i};y(Rs,am);Rs.prototype.qn=p("Tn");Rs.prototype.fm=ca("Tn");
Rs.prototype.fa=function(b,c,d,e){var g=Zl(this.element,this.Bf,b,c,k,d,10,e,this.vy);if(g&496){var h=Ss(g,this.Bf),c=Ss(g,c),g=Zl(this.element,h,b,c,k,d,10,e,this.vy);g&496&&(h=Ss(g,h),c=Ss(g,c),Zl(this.element,h,b,c,k,d,this.qn(),e,this.vy))}};
a.Ss=function(b,c){b&48&&(c^=2);b&192&&(c^=1);return c},a.Ts={},a.Us=function(b){if(b){var c=b.getBoundingClientRect(),d=c.bottom,c=c.top;d<Xb().height&&0>c&&setTimeout(function(){var c=b.getBoundingClientRect().bottom,g=ks(document);window.scrollTo(g.x,g.y+c-d)})}},a.Vs=function(b){function c(b){return $.isNumeric(b)?b+" ":b}var d;d=d||+new Date;if(0>=d-b)return"刚刚";b=Math.floor((d-b)/1E3);d=Math.floor(b/31536E3);if(1<=d)return c(d)+"年前";d=Math.floor(b/2592E3);if(1<=d)return c(d)+"月前";d=Math.floor(b/
604800);if(1<=d)return c(d)+"周前";d=Math.floor(b/86400);if(1<=d)return c(d)+"天前";d=Math.floor(b/3600);if(1<=d)return c(d)+"小时前";d=Math.floor(b/60);if(1<=d)return c(d)+"分钟前";d=Math.floor(b);return c(d)+"秒前"},a.Ws=function(){var b=S;return 1===b||0===b?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'" title="'+b[0]+'" class="','zm-item-link-avatar">','<img class="zm-item-img-avatar" src="'+b[2]+'" />',"</a>"].join("")},a.Xs=function(b,c){return!ma(b)?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',
b[1],'"',c?' class="'+c+'"':"",' title="',b[0],'">',b[0],"</a>"].join("")},a.Ys=function(b){if(0===b||1===b)return"匿名用户";var c=L("a",{href:"/people/"+b[1],title:b[0]},b[0]);c.setAttribute("data-tip","p$t$"+b[1]);return c},a.Zs=function(b){if(0===b||1===b)return L("span");if(ma(b)){var c=L("a",{href:"/people/"+b[1],title:b[0],"class":"zm-item-link-avatar"},L("img",{src:b[2],"class":"zm-list-avatar"}));c.setAttribute("data-tip","p$t$"+b[1]);return c}},a.$s=function(b){return 1===b?j:ma(b)?b[3]===S[3]:
m},a.at=function(b,c){return $.post("/question/askpeople",{qid:b,uid:c,op:"remove"})},a.bt=function(b,c,d){return $.post("/question/askpeople",{qid:b,uid:c,_source_type:d,op:"add"})},a.ct=function(b,c){return $.post("/node/AnswerVoteBarV2",{method:c,params:{answer_id:b}},function(b){b&&b.r&&Bi("提示信息","<p>"+b.msg+'</p><p><a href="/question/24752645" target="_blank">为什么回答会被建议修改？</a></p>')})},a.dt=function(b,c){return $.get(c?"/node/AnswerFullVoteInfoV2":"/node/AnswerVoteInfoV2",{params:{answer_id:b}})},
a.et=function(b,c,d,e,g){Dj.call(this,b,[c],[d],e,g)};y(et,Dj);et.prototype.gh=function(){this.element.style.height=Math.round(this.coords[0])+"px"};a.ft=function(b,c,d,e,g){Dj.call(this,b,[c],[d],e,g)};y(ft,Dj);ft.prototype.gh=function(){this.element.style.width=Math.round(this.coords[0])+"px"};a.gt=function(b,c,d,e,g){(2!=c.length||2!=d.length)&&f(Error("Start and end points must be 2D"));Dj.apply(this,arguments)};y(gt,Dj);
gt.prototype.gh=function(){var b=this.oi&&this.wd()?"right":"left";this.element.style[b]=Math.round(this.coords[0])+"px";this.element.style.top=Math.round(this.coords[1])+"px"};
a.ht=function(b){var c={},b=String(b),d="#"==b.charAt(0)?b:"#"+b;if(Zr.test(d))return c.xr=xs(d),c.type="hex",c;d=ws(b);if(d.length){var e=d[0],b=d[1],d=d[2],e=Number(e),b=Number(b),d=Number(d);(isNaN(e)||0>e||255<e||isNaN(b)||0>b||255<b||isNaN(d)||0>d||255<d)&&f(Error('"('+e+","+b+","+d+'") is not a valid RGB color'));e=Yr(e.toString(16));b=Yr(b.toString(16));d=Yr(d.toString(16));c.xr="#"+e+b+d;c.type="rgb";return c}if(ys&&(d=ys[b.toLowerCase()]))return c.xr=d,c.type="named",c;f(Error(b+" is not a valid color string"))},
a.it=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||112<=b.keyCode&&123>=b.keyCode)return m;switch(b.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 224:case 92:return m;case 0:return!B;default:return 166>b.keyCode||183<b.keyCode}},a.jt=function(b){var c=Qb(b),d=A&&b.currentStyle;if(d&&Jc(Rb(c))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing)return c=
tg(b,d.width,"width","pixelWidth"),b=tg(b,d.height,"height","pixelHeight"),new Nb(c,b);d=sg(b);c=vg(b);b=fg(b);return new Nb(d.width-b.left-c.left-c.right-b.right,d.height-b.top-c.top-c.bottom-b.bottom)},a.kt=function(b,c){var d=Rb(c),e=k;if(A)d=e=d.Ca().createStyleSheet(),A?d.cssText=b:d.innerHTML=b;else{var g=Sb(d.Ga,"head",i,i)[0];g||(e=Sb(d.Ga,"body",i,i)[0],g=d.v("head"),e.parentNode.insertBefore(g,e));var h=e=d.v("style");A?h.cssText=b:h.innerHTML=b;d.appendChild(g,e)}},a.lt=function(b,c){var d=
b.style[eb(c)];return"undefined"!==typeof d?d:b.style[Tf(b,c)]||""},a.mt=function(b){var c=arguments,d=c.length;return function(){for(var b,g=0;g<d;g++)b=c[g].apply(this,arguments);return b}},a.nt=function(b,c,d){return Math.min(Math.max(b,c),d)},a.ot=function(){f(Error("unimplemented abstract method"))},a.pt=function(){N.call(this)};y(pt,Qk);
pt.prototype.z=function(){this.Ir=J("help-index");(new gq).o(this.Ir);var b=window.location.href,c="";0<b.indexOf("#")&&(c=b.substring(b.indexOf("#")),b=b.substring(0,b.indexOf("#")));"/help"===b.substring(b.length-5)&&(b+="/faq");var d=Tb("a",k,this.Ir);z.forEach(d,function(d){(d.href===b||d.href===b+c)&&Gc(d,function(b){"UL"===b.tagName&&F.add(b,"force-display");"LI"===b.tagName&&F.add(b,"current")})},this);this.h().e(this.Ir,"click",this.qM)};
pt.prototype.qM=function(b){if((b=Ck(this.Ir,b.target))&&0<b.href.indexOf("#")){var c=Hc(b,"ul",k),c=Tb("li",k,c);z.forEach(c,function(b){F.remove(b,"current")},this);F.add(b.parentNode,"current")}};a.qt=function(b){N.call(this);this.view=this.name=k;G.extend(this.options={},this.defaults,b||{})};y(qt,Fd);a.rt={},a.st=function(b,c){function d(c){qt.call(this,c);this.name=b}y(d,qt);ya(d.prototype,c);rt[b]=d};qt.prototype.defaults={};qt.prototype.h=function(){return this.Ag||(this.Ag=new ke(this))};qt.prototype.z=ba();qt.prototype.w=function(){qt.n.w.call(this);this.view&&(G.remove(this.view.ld,this.name),this.view=k);this.Ag&&(this.Ag.G(),this.Ag=k)};a.tt=function(b){T.call(this);G.extend(this.F={},this.defaults,b||{});this.source=this.F.source;this.promise=$.Deferred().resolve();this.ld={}};y(tt,T);t=tt.prototype;t.defaults={source:k,ma:["autoload","shortcut"],Wg:j,Mm:"zg-btn-white zu-button-more"};t.ma=function(b,c){var d,e=rt[b];e||f(Error("Cannot find constructor"));d=new e(c);d.view=this;this.za?d.z(this):this.h().e(this,"initialized",function(){d.z(this)});this.ld[b]=d;return this};
t.Hi=function(){!this.Ed&&this.F.Wg&&(this.Ed=this.hq(),jc(this.Ed,this.g),this.h().e(this.Ed,"click",this.Gx))};t.B=function(){tt.n.B.call(this);this.Hi();z.forEach(this.Hb(),this.zq,this);z.forEach(this.F.ma,this.ma,this);this.dispatchEvent("initialized")};t.w=function(){G.forEach(this.ld,function(b){b.G()});this.ld=k;tt.n.w.call(this)};a.ut=function(b,c,d){b.za&&z.forEach(b.Hb(),c,d);b.h().e(b,"itemcreated",function(b){c.call(d,b.item)})};t.Hb=function(){return nc(this.g)};
t.zq=function(b,c){this.Fj(b,c);this.dispatchEvent({type:"itemcreated",item:b,index:c})};t.Fj=ha;a.vt=function(b){b.Ed&&(M(b.Ed),b.Ed=k);b.dispatchEvent("complete")};t.AP=function(b){if(b){var c=b.results,d=!c||!c.length;d||this.X(c);this.dispatchEvent("next");(d||b.next===m)&&vt(this)}};t.X=function(b,c){var b=$.isArray(b)?b.join(""):b,d=ec(b+" ");z.forEach($.makeArray(nc(d)),this.zq,this);kc(this.g,d,c)};
t.Gx=function(){this.dispatchEvent("beforeloadnext")!==m&&"pending"!==this.promise.state()&&(this.sz(j),this.promise=this.source().done(v(this.AP,this)).always(v(xa(this.sz,m),this)))};t.ed=p("Ed");t.hq=function(){return L("a",{"aria-role":"button","class":this.F.Mm},"更多")};t.sz=function(b){this.Ed&&(this.Ed.innerHTML=b?'<i class="spinner-gray"></i> 加载中':"更多",F.enable(this.Ed,"loading",b))};a.xt=function(b,c){var d=Array.prototype.slice.call(arguments),e=d.shift();"undefined"==typeof e&&f(Error("[goog.string.format] Template required"));return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,c,e,n,q,r,w,E){if("%"==r)return"%";var H=d.shift();"undefined"==typeof H&&f(Error("[goog.string.format] Not enough arguments"));arguments[0]=H;return wt[r].apply(k,arguments)})},a.wt={s:function(b,c,d){return isNaN(d)||""==d||b.length>=d?b:b=-1<c.indexOf("-",0)?b+Array(d-b.length+
1).join(" "):Array(d-b.length+1).join(" ")+b},f:function(b,c,d,e,g){e=b.toString();isNaN(g)||""==g||(e=b.toFixed(g));var h;h=0>b?"-":0<=c.indexOf("+")?"+":0<=c.indexOf(" ")?" ":"";0<=b&&(e=h+e);if(isNaN(d)||e.length>=d)return e;e=isNaN(g)?Math.abs(b).toString():Math.abs(b).toFixed(g);b=d-e.length-h.length;0<=c.indexOf("-",0)?e=h+e+Array(b+1).join(" "):(c=0<=c.indexOf("0",0)?"0":" ",e=h+Array(b+1).join(c)+e);return e},d:function(b,c,d,e,g,h,l,n){return wt.f(parseInt(b,10),c,d,e,0,h,l,n)}};wt.i=wt.d;
wt.u=wt.d;st("activeSource",{defaults:{PJ:"%d 条新动态",Mm:"zu-main-feed-fresh-button",OX:ha},z:function(b){this.data=[];this.button=this.hq();ic(this.button,b.m());this.h().e(this.button,"click",function(){b.X(this.data,0);this.setData([])});var c=this,d=this.options.source(function(b){b&&b.length&&c.setData(b.concat(c.data))},function(){return c.data});(!d||!qa(d.G))&&f(Error("Source must return a disposable object."));this.TK=d},setData:function(b){this.data=b;this.jP()},jP:function(){var b=this.data.length;
wc(this.button,xt(this.options.PJ,b));R(this.button,!!b)},hq:function(){return L("a",{href:"javascript:;",style:"display:none","class":this.options.Mm})},G:function(){qt.prototype.G.call(this);Sc(this.TK);this.options=k;this.button&&(M(this.button),this.button=k)}});a.yt=function(){N.call(this);this.size=k;this.TV=vg(document.body).top;this.ca=new ke(this);this.dp=k;this.NK=250;this.cf()};y(yt,Fd);ia(yt);yt.prototype.cf=function(){this.size=Xb();var b=this.dp=new Rl(this.update,this.NK,this);this.ca.e(window,"scroll",b.fire,m,b).e(window,"resize",b.fire,m,b)};yt.prototype.h=p("ca");yt.prototype.w=function(){yt.n.w.call(this);this.ca.G();this.ca=k;this.dp.G();this.dp=k};yt.prototype.update=function(){this.size=Xb();this.dispatchEvent("update")};
a.At=function(b,c,d){var e=zt;e.ca.e(e,"update",function h(){b.getBoundingClientRect().bottom<this.size.height&&(c.call(d),this.ca.Ea(this,"update",h))})},a.zt=yt.O();$(function(){zt.update()});st("autoload",{defaults:{vR:function(b){return 0!==b%3}},z:function(b){if(b.ed()&&S.ha()){var c=this,d=zt;c.h().e(d,"update",function(d){var e;e=ua(c);var l=rd[e];if(l){var n=ka("abouttosee"),q=ka(i);n&&q?(l=qd.abouttosee,e=!!l&&!!l[i]&&e in l[i]):e=!n&&!q?j:z.some(l,function(b){return n&&"abouttosee"==b.type||q&&b.capture==i})}else e=m;e&&(pg(b.ed())&&400>=b.ed().getBoundingClientRect().top-d.target.size.height)&&c.dispatchEvent("abouttosee")});var e=0;this.h().e(b,"complete",this.G).e(b,"next",
function(){e+=1;this.options.vR(e)&&this.enable()});this.enable()}},enable:function(){me(this.h(),this,"abouttosee",function(){this.view.Gx()})}});st("childConstructor",{defaults:{Ji:k,factory:k},z:function(b){qa(this.options.Ji)&&ut(b,this.sK,this);qa(this.options.factory)&&ut(b,this.LQ,this)},sK:function(b){var c=new this.options.Ji;this.view.H(c);c.o(b)},LQ:function(b){var c=this.options.factory(b);this.view.H(c);c.o(b)}});st("dataPagingSource",{defaults:{yB:j},z:function(b){var c=$(b.m()).data("paging").next;c||vt(b);b.source=function(){return $.get(c).then(function(b){c=b.paging.next;return{results:b.htmls,next:!!c}})}}});a.Bt=function(b){G.extend(this.F={},this.defaults,b||{});this.content="";this.yc=this.Ke=this.Le=k;this.sd=m;this.valid=j};y(Bt,T);t=Bt.prototype;t.defaults={jH:"textarea.content",sB:".toggle-expand",sS:".summary",Zu:"zm-editable-content",ar:m};
t.B=function(){Bt.n.B.call(this);var b=this.g,c=this.F;c.ar?(this.Le=$("."+c.Zu,b),this.content=this.Le.val(),this.yc=$(c.sB,b)):(this.Ep=$(c.jH,b),this.content=this.Ep.is(":input")?this.Ep.val():this.Ep.html(),this.Le=$(c.sS,b),this.yc=$(c.sB,this.Le));if(this.Le.length){if(this.yc.length)this.yc.click(m).on("click",$.proxy(this.expand,this));this.Le.on("click",$.proxy(this.RM,this))}else this.valid=m,this.expand=this.collapse=ha,this.dispatchEvent("invalid")};t.ed=function(){return this.yc.get(0)};
t.ab=p("content");t.Ka=function(b,c){b?this.expand(c):this.collapse(c)};t.RM=function(b){var c=Dp();if(!c||!c.Fc())c=$(b.target).closest("a").get(0),c&&"javascript:"!==c.protocol||(b.preventDefault(),this.expand())};
t.expand=function(b){!this.sd&&this.dispatchEvent("beforeexpand")!==m&&(this.sd=j,this.F.ar?(this.Le.removeClass("fixed-summary"),this.yc.remove()):(this.Ke?this.Ke.show():this.Le.length&&(this.Ke=$("<div>",{html:this.content,"class":this.F.Zu}).insertBefore(this.Ep)),this.Le.hide()),b!==j&&this.dispatchEvent("expand"))};t.collapse=function(b){this.sd&&(this.sd=m,this.Ke&&this.Ke.hide(),this.F.ar?this.Le.addClass("fixed-summary"):this.Le.show(),b!==j&&this.dispatchEvent("collapse"))};st("expandLimit",{defaults:{FS:3},z:function(b){var c=Xi.create("ExpandLimit");c.get("expandCount")||c.Wd("expandCount","0");S.ha()||(this.h().e(b,"beforeexpand",function(b){var e=parseInt(c.get("expandCount"),10)||0;if(b.target instanceof Bt&&(b=e+1,c.Wd("expandCount",b),b>=this.options.FS))return nl("expand"),m}),this.h().e(b,"beforeloadnext",function(){nl("expand");return m}))}});st("locationSource",{defaults:{ds:20,param:k,Es:m,offset:function(b){return b.length}},z:function(b){function c(b){return{start:d.Es?z.Td(b).id.split("-")[1]:0,offset:d.offset(b)}}var d=this.options,e=d.url||location.href,g=b.Hb().length;(!g||g<d.ds)&&vt(b);b.source=function(){return $.post(e,(d.param||c)(b.Hb())).then(function(c){if(!c.r){var c=c.msg,e=c[0];pa(e)&&e<d.ds&&vt(b);return{results:c[1]}}})}}});st("nodeSource",{defaults:{yB:j},z:function(b){var c=$(b.m()).data("init"),d="/node/"+c.nodename,e=c.params,g=e.offset||0,c=e.limit,h=e.pagesize;this.options.yB&&(c&&b.Hb().length<c)&&vt(b);b.source=function(){return $.post(d,{method:"next",params:$.extend(e,{offset:g+b.Hb().length})}).then(function(b){var c=j;h&&(!b.r&&b.msg.length<h)&&(c=m);return!b.r&&{results:b.msg,next:c}})}}});st("shortcut",{defaults:{items:">div"},z:function(b){b.Hb().length&&(this.eo=new Nl(this.options),this.eo.o(b.m()),this.h().e(this.eo,"action",function(c){c.data.index>=c.data.size&&b.ed()&&pg(b.ed())&&b.ed().click()}))},G:function(){qt.prototype.G.call(this);this.eo&&(this.eo.G(),this.eo=k)}});a.Ct=function(b){tt.call(this,b)};y(Ct,tt);a.Dt=function(){N.call(this)};y(Dt,Fd);Dt.prototype.IA={question:"问题",comment:"评论",answer:"回答",favlist:"收藏",member:"用户",message:"私信",image:"图片",video:"视频",post:"文章"};Dt.prototype.ev="report-dialog";Dt.prototype.PE="loading";Dt.prototype.vL='<form><div class="header"><% if (headnote) { %><span class="headnote"><%=headnote%></span><% } %>请选择理由</div><ul class="options clearfix"><% each(options, function(option) { %><li><label><input value="<%=option.value%>" name="reason" type="radio"><%=option.label%></label><% if (option.description) { %><div class="description visible-if-checked"><%=option.description%></div><% } %><% if (option.options) { %><ul class="group-options clearfix visible-if-checked"><% each(option.options, function(opt) { %><li><label><input required data-description="<%=opt.description%>" value="<%=opt.value%>" name="reason-<%=option.value%>" type="radio"><%=opt.label%></label></li><% }) %></ul><div class="group-description visible-if-checked"></div><% } %><% if (option.value == 0) { %><p class="input-container visible-if-checked"><input placeholder="请填写原因" type="text" name="detail" class="reason-text zg-form-text-input"></p><p class="error-container visible-if-checked"></p><% } %></li><% }) %></ul><p class="footnote"></p></form>';
Dt.prototype.submit=ot;t=Dt.prototype;t.ew=p("bn");t.Hu=function(){var b=new vi;Zh(b,j);b.Qk=j;ei(b,gi);b.addEventListener(fi,this.YL,m,this);Qc(b,this);return b};t.YL=function(b){if("ok"===b.key)return(b=$("form",this.bn.m()).valid())&&this.submit(),b};
t.open=function(b,c,d){var e=this.bn=this.Hu();e.Ya(this.ZC(b));e.Ha(this.Iu());e.D(j);F.add(e.m(),this.ev);F.add(e.m(),this.PE);this.fD(b).then(v(function(g){e.Ha(Ik(this.vL,{each:z.forEach,options:g,headnote:d}));F.remove(e.m(),this.PE);e.fa();xi(e,450);this.Dv={type:b,id:c};this.zu(b,g)},this))};t.tD=ba();
t.zu=function(b,c){var d=this,e=$(this.bn.m()),g=$("form",e),h=$(".reason-text",e);e.on("change",":radio",function(b){b=$(b.target);e.find("li").removeClass("checked");b.parentsUntil(g,"li").addClass("checked");var n=this.value,q=z.find(c,function(b){return n===String(b.value)});d.tD(q);q="0"===n;h.toggle(q);q&&h.placeholder();b.closest("li").find("ul, :text").length||g.valid()});e.find("ul ul").on("change",":radio",function(b){$(b.delegateTarget).parent().find(".group-description").text($(this).data("description"))});
g.validate({rules:{reason:"required",detail:{rangelength:[2,100],required:function(){return!!$("input[name=reason]:checked",e).length}}},messages:{reason:"请选择理由",detail:"理由为 2-100 字"},errorLabelContainer:$(".error-container",g)})};t.Iu=s('<div class="loading">理由加载中<i class="spinner-gray"></i></div>');a.Et=function(){N.call(this)};y(Et,Dt);Et.prototype.fD=v(Ar(function(b){return $.getJSON(Ga("/report/%s/options",b))}),fa);Et.prototype.ZC=function(b){return Ga("为什么举报这个%s？",this.IA[b]||"条目")};Et.prototype.submit=function(){var b=this.ew(),c=$($("form",this.bn.m())[0]).serialize()+"&"+$.param(this.Dv);$.post("/report",c).done(function(c){b.D(m);c.r?U(c.msg):U("您的举报我们已经收到，处理完成后会私信告知处理结果。",2E3)});Y.ia({type:"ga_click_report",data:{type:this.Dv.type}})};
a.Ft=ol(function(b,c,d){Y.ia({type:"ga_click_report_box",data:{type:b}});(new Et).open(b,c,d)},{ha:"question_answer_report",ad:j});a.Gt=function(){N.call(this);this.ze="zm-pm-item"};y(Gt,Qk);Gt.prototype.z=function(){var b=J("zh-create-pm");b&&this.h().e(b,"click",this.hP);var b=J("zh-pm-item-wrap"),c=new Ct;c.ma("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}});c.o(b);this.h().e(b,"click",this.ra);$(function(){$("#zh-change-pm-admin").change(function(){var b=$(this).find("option:selected").attr("data-token");location.href="self"===b?"/admin_feedback":"/admin_feedback/"+b})})};
Gt.prototype.hP=ol(function(){var b;this.Dn();this.Lb.show();Dn(this.Lb,-1);(b=Wa(location.pathname,"admin_inbox")?"admin":$("#zh-change-pm-admin option:selected").attr("data-token"))&&this.Lb.jt(b)},j);Gt.prototype.Dn=function(){this.Lb||(this.Lb=new zn({Ss:j}))};
Gt.prototype.ra=function(b){if(b=Ck(this.wX,b.target)){var c=b.name,d=Hc(b,k,this.ze);if(!d||!b.name)return j;var e=$(d).data(),g=e.member,h=e.name;switch(c){case "reply":ol(v(function(){this.Dn();this.Lb.show();var b=this.Lb,c=e.type;b.cp=e.token;b.Pz=c;Dn(this.Lb,g,h,m);this.Lb.Wb.focus()},this),j)();break;case "report":Ft("message",e.reportToken,"被举报私信将会被管理员查阅");break;case "delete":var l=d.getAttribute("data-token");Ai("删除私信会话","你确定要删除与 "+h+"的所有会话吗？",function(b){if(b){var c=new V(j);c.on("success",
function(){var b=He(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=thread&token="+l)}},this);break;case "edit":b=this.fg,R(this.Jc,j),R(b,m),this.ji=-1}}};a.Ht=function(){N.call(this);this.ze="zm-pm-item"};y(Ht,Qk);
Ht.prototype.z=function(){this.gs=J("zh-pm-detail-item-wrap");this.h().e(this.gs,"click",this.ra);var b=J("zh-pm-editor-form");if(b){this.Lb=new zn({Ss:j});this.Lb.qp=m;this.Lb.Ug(b);this.Lb.show();if(b=this.Hb()[0]){var b=$(b).data(),c=this.Lb,d=b.type;c.cp=b.token;c.Pz=d;Dn(this.Lb,b.member,b.name)}else b=gh,Dn(this.Lb,b.id,b.$v);this.Lb.focus()}else this.Lb=new zn({Ss:j});this.Hb().length&&(b=new Ct,b.ma("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}}),
b.o(this.gs))};Ht.prototype.Hb=function(){return nc(this.gs)};
Ht.prototype.ra=function(b){var c=Ck(this.gs,b.target);if(c&&(b=c.name,c=Hc(c,k,this.ze))){var c=$(c).data(),d=c.token;switch(b){case "reply":this.Lb.show();var b=this.Lb,e=c.type;b.cp=d;b.Pz=e;Dn(this.Lb,c.member,c.name,m);this.Lb.focus();break;case "delete":Ai("删除私信","你确定要删除这封私信吗？",function(b){if(b){var c=new V(j);me(this.h(),c,"success",function(){var b=He(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=single&token="+d)}},this);break;case "report":Ft("message",d,"被举报私信将会被管理员查阅")}}};a.It=function(){};y(It,Kn);ia(It);It.prototype.L=s("goog-menuheader");a.Jt=function(b,c,d){Tn.call(this,b,d||It.O(),c);Wn(this,1,m);Wn(this,2,m);Wn(this,4,m);Wn(this,32,m);this.Z=1};y(Jt,Tn);Rn("goog-menuheader",function(){return new Jt(k)});a.Kt=function(){this.Pu=[]};y(Kt,Kn);ia(Kt);a.Lt=function(b,c){var d=b.Pu[c];if(!d){switch(c){case 0:d=b.L()+"-highlight";break;case 1:d=b.L()+"-checkbox";break;case 2:d=b.L()+"-content"}b.Pu[c]=d}return d};t=Kt.prototype;t.pc=function(){return Uc.sI};t.v=function(b){var c=b.J().v("div",this.Ze(b).join(" "),Mt(this,b.ab(),b.J()));Nt(this,b,c,!!(b.Nb&8)||!!(b.Nb&16));Mn(this,b,c);return c};t.U=function(b){return b&&b.firstChild};
t.o=function(b,c){var d=pc(c),e=Lt(this,2);d&&F.has(d,e)||c.appendChild(Mt(this,c.childNodes,b.J()));F.has(c,"goog-option")&&(b.Jo(j),this.Jo(b,c,j));return Kt.n.o.call(this,b,c)};t.Ha=function(b,c){var d=this.U(b),e=Ot(this,b)?d.firstChild:k;Kt.n.Ha.call(this,b,c);e&&!Ot(this,b)&&d.insertBefore(e,d.firstChild||k)};a.Mt=function(b,c,d){b=Lt(b,2);return d.v("div",b,c)};t.fi=function(b,c,d){c&&(Lc(c,d?Uc.uI:this.pc()),Nt(this,b,c,d))};t.Jo=function(b,c,d){c&&(Lc(c,d?Uc.tI:this.pc()),Nt(this,b,c,d))};
a.Ot=function(b,c){var d=b.U(c);if(d){var d=d.firstChild,e=Lt(b,1);return!!d&&F.has(d,e)}return m},a.Nt=function(b,c,d,e){e!=Ot(b,d)&&(F.enable(d,"goog-option",e),d=b.U(d),e?(b=Lt(b,1),d.insertBefore(c.J().v("div",b),d.firstChild||k)):d.removeChild(d.firstChild))};t.nn=function(b){switch(b){case 2:return Lt(this,0);case 16:case 8:return"goog-option-selected";default:return Kt.n.nn.call(this,b)}};
t.nw=function(b){var c=Lt(this,0);switch(b){case "goog-option-selected":return 16;case c:return 2;default:return Kt.n.nw.call(this,b)}};t.L=s("goog-menuitem");a.Pt=function(b,c,d,e){Tn.call(this,b,e||Kt.O(),d);this.Aa(c)};y(Pt,Tn);t=Pt.prototype;t.W=function(){var b=this.Tx;return b!=k?b:this.xg()};t.Aa=ca("Tx");t.fi=function(b){Wn(this,8,b);this.xe()&&!b&&this.Wc(m);var c=this.m();c&&this.M.fi(this,c,b)};t.Jo=function(b){Wn(this,16,b);var c=this.m();c&&this.M.Jo(this,c,b)};
t.xg=function(){var b=this.ab();return ma(b)?(b=z.map(b,function(b){var d=F.get(b);return z.contains(d,"goog-menuitem-accel")||z.contains(d,"goog-menuitem-mnemonic-separator")?"":Fc(b)}).join(""),Ka(b)):Pt.n.xg.call(this)};t.Nf=function(b){var c=this.getParent();if(c){var d=c.RF;c.RF=k;if(c=d&&pa(b.clientX))c=new Lb(b.clientX,b.clientY),c=d==c?j:!d||!c?m:d.x==c.x&&d.y==c.y;if(c)return}Pt.n.Nf.call(this,b)};t.bf=function(b){return b.keyCode==this.Rx&&this.Ud(b)?j:Pt.n.bf.call(this,b)};t.EL=p("Rx");
Rn("goog-menuitem",function(){return new Pt(k)});a.Qt=function(){};y(Qt,so);ia(Qt);t=Qt.prototype;t.pc=function(){return Uc.rI};t.nc=function(b){return"UL"==b.tagName||Qt.n.nc.call(this,b)};t.pn=function(b){return"HR"==b.tagName?new ro:Qt.n.pn.call(this,b)};t.Af=function(b,c){return rc(b.m(),c)};t.L=s("goog-menu");t.ve=function(b){Qt.n.ve.call(this,b);Mc(b.m(),Tc.sk,"true")};a.Rt=function(b){ro.call(this,qo.O(),b)};y(Rt,ro);Rn("goog-menuseparator",function(){return new ro});a.St=function(b,c){Is.call(this,vo,c||Qt.O(),b);this.Ie(m)};y(St,Is);t=St.prototype;t.zm=j;t.jJ=m;t.L=function(){return this.M.L()};t.Af=function(b){if(this.M.Af(this,b))return j;for(var c=0,d=Mh(this);c<d;c++){var e=Nh(this,c);if("function"==typeof e.Af&&e.Af(b))return j}return m};t.Fa=function(b){this.H(b,j)};t.zi=function(b,c){this.vk(b,c,j)};t.removeItem=function(b){(b=this.removeChild(b,j))&&b.G()};t.Eh=function(b){return Nh(this,b)};t.hl=function(){return Mh(this)};
t.Hb=function(){var b=[];Lh(this,function(c){b.push(c)});return b};t.Xc=function(b,c){var d=this.P();d||R(this.m(),j);js(this.m(),b,c);d||R(this.m(),m)};t.D=function(b,c,d){(c=St.n.D.call(this,b,c))&&(b&&this.za&&this.zm)&&this.fc().focus();this.RF=b&&d&&pa(d.clientX)?new Lb(d.clientX,d.clientY):k;return c};t.xw=function(b){this.zm&&this.fc().focus();return St.n.xw.call(this,b)};t.uB=function(b){return(this.jJ||b.isEnabled())&&b.P()&&!!(b.Nb&2)};
t.$=function(b){var c=this.M,d;d=this.J();d=Sb(d.Ga,"div",c.L()+"-content",b);for(var e=d.length,g=0;g<e;g++)to(c,this,d[g]);St.n.$.call(this,b)};t.bf=function(b){var c=St.n.bf.call(this,b);c||Lh(this,function(d){!c&&(d.EL&&d.Rx==b.keyCode)&&(this.isEnabled()&&this.nd(d),c=d.Vb(b))},this);return c};t.Mb=function(b){St.n.Mb.call(this,b);(b=Nh(this,b))&&gg(b.m(),this.m())};a.Tt=function(b,c,d){T.call(this);this.offset=this.Xg=0;this.SR=d;this.aL=b;this.url=c||window.location.href;this.Gg="zm-item";this.params={}};y(Tt,T);t=Tt.prototype;t.gA=!sb;t.fA=!sb;t.ci=ca("Gg");t.z=function(){this.Yb=J("zh-load-more");this.o(this.aL)};
t.B=function(){Tt.n.B.call(this);this.Cm=1;Ut(this);this.pk=$(this.Yb);this.Yb&&Vt(this)&&(this.h().e(this.Yb,"click",function(){this.Mn=j;this.hh&&"pending"===this.hh.state()&&1===this.Cm?(this.hh.done(v(this.hf,this)),this.qz=j,Wt(this,j)):this.ly()}),this.gA&&(this.Qz=new Rl(this.iy,100,this),this.h().e(window,"scroll",function(){this.Qz.fire()})));Xt(this,this.Hb())};a.Wt=function(b,c){c?b.pk.html('<i class="spinner-gray"></i>正在加载').prop("disabled",j):b.pk.html("更多").prop("disabled",m)};
t.iy=function(){var b=this.Yb;if(b&&pg(b)&&1E3>=b.getBoundingClientRect().top-Xb().height&&!(this.Js||this.hh&&"pending"===this.hh.state()))this.fA&&(3===this.Cm?(this.Cm=1,this.qz=m):(this.Mn=m,this.Cm++,this.qz=j)),Yt(this)};t.ly=function(){this.gA&&this.Js?(this.hf(this.Js),this.Js=k):(Wt(this,j),Yt(this))};
a.Vt=function(b){var c=b.Hb();b.offset=b.Zx?b.Zx(c):c.length;if(b.vr)return c=b.vr(),R(b.Yb,c),c;if(b.Yb){if("-1"===b.pk.attr("data-next")||!c||10>c.length)return b.pk.hide(),m;b.pk.removeClass("hidden").show()}return j},a.Yt=function(b,c,d,e){d=d||ha;if(!(b.hh&&"pending"===b.hh.state())){var g=b.gG($.extend(b.params,{offset:b.offset,start:b.Xg}));"live"!==g.start&&Y.ia({type:"topstory_feed_more"});b.hh=$.post(b.url,g).done(d).done($.proxy(function(b){if(e)return e.call(this,b);this.gA&&!c?this.qz?
this.hf(b):(this.Js=b,Wt(this,m)):this.hf(b)},b));1!==b.Cm&&Wt(b,j);return b.hh}};t.gG=aa();t.hf=function(b){if(b&&!b.r){var c=b.msg,d=c[0],e=c[1],g;2<c.length&&(g=c[2],this.Yb.setAttribute("data-next",g));0<d&&(this.Wp(e),this.offset=this.Zx?this.Zx(this.Hb()):this.offset+d);c=j;c=this.vr?this.vr(b):!(-1===g||10>d);R(this.Yb,c);Wt(this,m);Zt(this)}};a.Zt=function(b){b.dispatchEvent({data:{Mn:b.Mn,fA:b.fA},type:"afterload"})};t.Hb=function(){return Ub(this.Gg,this.g)};t.$F=function(b){return b.id.split("-")[1]};
a.Ut=function(b){var c=b.Hb(),d;if(b.SR)if(b.Yb&&(d=b.Yb.getAttribute("data-next")),d)b.Xg=d;else if(c=z.Td(c))b.Xg=b.$F(c)};t.Wp=function(b,c){var d=ma(b)?b.join(""):b,d=ec(d+" "),e=Ub(this.Gg,d);Xt(this,e);"prepend"===c?ic(d,this.g.firstChild):this.g.appendChild(d);Ut(this)};a.Xt=function(b,c){z.forEach(c,function(b){var c=this.Fj(b);this.dispatchEvent({data:{item:b,iO:c},type:"itemcreated"})},b)};t.Fj=ha;a.$t=function(b,c){return $.post("/node/ColumnPostVoteBarV2",{method:c,params:{post_id:b}})},a.au=function(b,c){return $.get(c?"/node/ColumnPostFullVoteInfoV2":"/node/ColumnPostVoteInfoV2",{params:{post_id:b}})};a.bu=function(b,c,d){T.call(this);this.ub=b;this.entryType=c||"answer";this.rd=k;this.F=$.extend({},this.defaults,d||{})};y(bu,T);a.cu={de:1,kg:-1,BA:0};bu.prototype.defaults={WS:"up",VK:"down",vK:"count",Ks:"pressed"};G.extend(bu.prototype,cu);t=bu.prototype;t.Z=cu.BA;
t.o=function(b){bu.n.o.call(this,b);var c=this.F,b=this.K=$(b);this.Xt=$("."+c.WS,b);this.Ut=$("."+c.VK,b);this.nA=$("."+c.vK,b);c=this.Xt.hasClass(this.F.Ks);b=this.Ut.hasClass(this.F.Ks);c?this.Z=cu.de:b&&(this.Z=cu.kg);du(this);this.Xt.click($.proxy(this.Gt,this));this.Ut.click($.proxy(this.Ft,this));return this};t.Pd=p("Z");
t.Zb=ol(function(b){if(b!==this.Z&&G.qg(cu,b)){this.dispatchEvent({type:"action",data:{state:b}});this.rd&&"pending"===this.rd.state()&&this.rd.abort();var c=this.Z,d=+this.nA.text(),e=0;b===cu.de?e=1:c===cu.de&&(e=-1);this.nA.text(d+e);this.Z=b;du(this);b={};b[cu.de]="vote_up";b[cu.kg]="vote_down";b[cu.BA]="vote_neutral";this.rd=("post"===this.entryType?$t:ct)(this.ub,b[this.Z]);this.rd.done(v(function(b){b.r||this.Sh()},this))}},function(b){var c={};c[cu.de]="question_answer_vote_up";c[cu.kg]="question_answer_vote_down";
return{ha:c[b],ad:j}});t.PS=function(b){b===cu.de?Gk("vote","voteup","side_vote"):b===cu.kg&&Gk("vote","votedown","side_vote")};t.Gt=function(){this.Zb(this.Z===cu.kg?cu.de:this.Z^cu.de)};t.Ft=function(){this.Zb(this.Z===cu.de?cu.kg:this.Z^cu.kg)};
a.du=function(b){var c=b.Z,d=b.F,e=c===cu.de,c=c===cu.kg,g=e?"取消赞同":"赞同",h=c?"取消反对":"反对，不会显示你的姓名";b.Xt.toggleClass(d.Ks,e).find(".label").text(g).end().attr("aria-pressed",e).attr("title",g);b.Ut.toggleClass(d.Ks,c).find(".label").text(h).end().attr("aria-pressed",c).attr("title",h)};t.Sh=function(){this.dispatchEvent("change")};a.eu=function(b){N.call(this);this.g=b;b=A||C&&!D("531")&&"TEXTAREA"==b.tagName;this.N=new ke(this);this.N.e(this.g,b?["keydown","paste","cut","drop","input"]:"input",this)};y(eu,Fd);eu.prototype.na=k;
eu.prototype.handleEvent=function(b){if("input"==b.type)fu(this),(!rb||this.g==Qb(this.g).activeElement)&&this.dispatchEvent(gu(b));else if("keydown"!=b.type||it(b)){var c="keydown"==b.type?this.g.value:k;A&&229==b.keyCode&&(c=k);var d=gu(b);fu(this);this.na=Jd(function(){this.na=k;this.g.value!=c&&this.dispatchEvent(d)},0,this)}};a.fu=function(b){b.na!=k&&(Gd.clearTimeout(b.na),b.na=k)},a.gu=function(b){b=new jd(b.Ub);b.type="input";return b};
eu.prototype.w=function(){eu.n.w.call(this);this.N.G();fu(this);delete this.g};a.iu=function(b,c,d,e){N.call(this);this.Id=b;this.wh=c;this.Mg=d;this.qC=e||hu;this.oj=new eu(b);O(this.oj,"input",this.lo,m,this);this.Fi()};y(iu,Fd);a.hu=0;t=iu.prototype;t.lo=function(){this.Fi()};t.Fi=function(){var b=this.fr();this.wh&&(0>this.Mg-b?(wc(this.wh,"已超出 "+(b-this.Mg)+" 字"),F.add(this.wh,"zg-text-error")):(wc(this.wh,"还可以输入 "+(this.Mg-b)+" 字"),F.remove(this.wh,"zg-text-error")))};t.w=function(){iu.n.w.call(this);delete this.Id;this.oj.G();this.oj=k};
t.isValid=function(){return 0<=this.Mg-this.Id.value.length};t.fr=function(){return this.Id.value.length};a.ju=function(b,c,d,e){iu.call(this,b,c,d,e)};y(ju,iu);ju.prototype.fr=function(){return Ek(this.Id.value)};a.ku=function(b,c){N.call(this);this.S=k;this.LK=c;this.MR.apply(this,b);this.z()};y(ku,Qk);ku.prototype.Qe={};a.lu=Ar(function(){return $.get("/node/WebShareDialogV2")});t=ku.prototype;t.z=function(){this.h().e(Ji,"question_title_change",function(){this.Qe[this.vf]=k});lu().then(v(function(b){b=ec(La(b));this.v(b);this.gb();this.show();mu(this,this.LK)},this))};t.show=function(){nu(this);this.vc&&(this.vc.checked=m,this.Hj());po.O().refresh();this.S.D(j)};t.hide=function(){this.S.D(m)};
t.MR=function(b,c,d,e){this.nf={title:b,type:c,LS:d,params:e};this.vf=c+":"+d};
a.nu=function(b){b.S.Ya(b.nf.title);b.Qe[b.vf]||(b.xhr=new V(j),me(b.h(),b.xhr,"success",b.NR),b.xhr.ajax("/"+b.nf.type+"/"+b.nf.LS+"/sharetext","","GET"));J("zh-webshare-sina-pm").value=b.Qe[b.vf]&&b.Qe[b.vf].sina||"加载中...";b.ZG.Fi();Rk(b.yz);b.yz.Jt();var c=b.jk;c.Wb.value=b.Qe[b.vf]&&b.Qe[b.vf].pm||"加载中...";c.TJ&&c.TJ.Fi();Rk(c.cG);c.cG.Jt();R(c.Jc,j);R(c.fg,m);if("answer"===b.nf.type||"post"===b.nf.type)$(b.g).find("#tb-webshare-daily").parent().removeClass("zg-hide"),b.Qe[b.vf]&&$(b.g).find(".tb-webshare-daily-title").html(b.Qe[b.vf].daily)};
t.NR=function(){var b=He(this.xhr);b&&b.r?U(b.msg):(this.Qe[this.vf]=b,nu(this))};t.v=function(b){this.g=b;this.S=new vi(k,m);ei(this.S,k);this.S.Qk=j;this.S.U().appendChild(this.g);this.jk=new zn({bG:"share"});this.jk.nb=this.S;this.jk.Ug(J("tb-webshare-letter-content"));this.jk.Fk=m;this.jk.z()};t.kz=function(){this.vc.checked=j;this.Hj()};
a.mu=function(b,c){var d=J(c+"-content"),e=J(c);z.forEach(b.vS,function(b){F.remove(b.parentNode,"active")});z.forEach(b.uS,function(b){R(b,m)});F.add(e.parentNode,"active");R(d,j);b.lR||(b.S.fa(),b.lR=j)};
t.gb=function(){var b=K("tab-navs",this.g);this.h().e(b,"click",this.XP);this.vS=$(".tab-nav > a",this.g);this.uS=Ub("zm-tab-content",this.g);$(".zm-command",this.g).on("click",$.proxy(this.ra,this));this.By=J("zh-webshare-sina-pm");this.yz=new Tk(this.By);this.ZG=new ju(this.By,J("zg-webshare-sina-counter"),140,hu);this.h().e(Y,"sina_callback",function(b){this.kz(b.Hc.id,b.Hc.name)});this.yu();b=K("zg-btn-blue",this.jk.m());S.yi||F.gH(b,"zg-btn-blue","zg-btn-disabled");this.h().e(b,"click",this.ra)};
t.yu=function(){this.vc=K("sina-checkbox",this.g);this.h().e(this.vc,"change",this.oy)};t.Hj=function(){var b=K("weibo-share-button",this.g),c=this.vc.checked;F.enable(b,"zg-btn-blue",c);F.enable(b,"zg-btn-disabled",!c)};t.oy=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.vc&&!oh.id?(window.open(c),b.checked=m,b=j):b=i;b||this.Hj()};t.XP=function(b){(b=this.Ye(b.target))&&mu(this,b.id)};
t.ra=function(b){var c=this.Ye(b.target);if(c)switch(c.name){case "send_sina":if(!F.has(c,"zg-btn-disabled")){var d=this.By.value;d&&this.vf in this.Qe&&(c=new Dk(j),c.add("content",d),d=[],this.vc.checked&&d.push("sina"),c.add("via",d.join(",")),this.Kj(c),this.nf&&Y.ia({type:"ga_click_share_"+this.nf.type+"_weibo",data:{NH:d}}))}break;case "send":if(!F.has(c,"zg-btn-disabled"))if(c=this.jk,"-1"===String(c.ji))Bn(c,"请填写收信人。");else if(d=c.Wb.value,this.vf in this.Qe)if(La(d)){var e=new Dk(j);e.add("talker_id",
c.ji);e.add("content",d);e.add("via","pm");this.Kj(e);this.nf&&Y.ia("ga_click_share_"+this.nf.type+"_message")}else Bn(c,"请填写私信内容。");break;case "send_daily":c=new Dk(j);c.add("content",$(".tb-webshare-daily-form [name=recommend-reason]").val());c.add("via","daily");this.Kj(c);break;case "cancel":this.hide()}b.stopPropagation();b.preventDefault()};
t.Kj=function(b){G.forEach(this.nf.params,function(c,d){b.add(d,c)});this.xhr=new V(j);me(this.h(),this.xhr,"complete",this.nu);this.xhr.ajax("/"+this.nf.type+"/share",b.fd())};t.nu=function(){var b=He(this.xhr);b&&b.r?U(b.msg):(this.S.D(m),U(b.msg||"分享发送完毕"))};t.P=function(){return this.S.P()};a.ou=void 0,a.pu=[],a.qu=[].slice,a.ru=Ok(550,function(){if(pu.length){var b=pu;S.ha()&&(b={items:JSON.stringify(b)},$.post("/lastread/touch",b));pu=[]}});ou=function(){pu.push(qu.call(arguments));ru()};a.su=function(b){var c=k;try{c=b.rules||b.cssRules}catch(d){15==d.code&&(d.styleSheet=b,f(d))}return c},a.tu=function(b){var c=[],b=b||document.styleSheets,d=ka(i)?i:m;if(b.imports&&b.imports.length)for(var e=0,g=b.imports.length;e<g;e++)z.extend(c,tu(b.imports[e]));else if(b.length){e=0;for(g=b.length;e<g;e++)z.extend(c,tu(b[e]))}else{var h=su(b);if(h&&h.length)for(var e=0,g=h.length,l;e<g;e++)l=h[e],l.styleSheet&&z.extend(c,tu(l.styleSheet))}(b.type||b.rules||b.cssRules)&&(!b.disabled||d)&&c.push(b);
return c};a.uu=/a(:(link|visited|active|hover))?/,a.vu=function(){this.$m="";this.Tg=[]};vu.prototype.clone=function(){var b=new vu;b.Tg=this.Tg.concat();b.$m=this.$m;return b};
a.wu=function(b,c,d){var e=[],g;for(g in c){var h=c[g];h&&e.push(g,":",h,d?" !important":"",";")}b.$m=e.join("")},a.xu=/(^|;|{)\s*color:([^;]+);/g,a.zu=function(b){this.zy=[];this.su={};if(b){for(var c=[],b=b.split(/\s+/gm),d=0;d<b.length;d++)if(b[d]){var e=new yu(b[d]);c.push(e)}this.Vh=c}},a.yu=function(b){var c=Au[b];if(c)return c;for(var c=b.match(/[#\.]/)?b.split(/(?=[#\.])/):[b],d={},e=0;e<c.length;e++){var g=c[e];"."==g.charAt(0)?d.className=g.substring(1,g.length):"#"==g.charAt(0)?d.id=g.substring(1,
g.length):d.tagName=g.toUpperCase()}this.cE=b;this.AO=d;this.kH={};Au[b]=this},a.Au={},a.Bu=function(b,c){var d=c.uid,e=b.kH[d];if("undefined"!=typeof e)return e;var g=b.AO,e=g.tagName,h=g.className,g=g.id,l=j;e&&"*"!=e&&e!=c.nodeName?l=m:g&&g!=c.id?l=m:h&&!c.$J[h]&&(l=m);return b.kH[d]=l},a.Du=function(b){var c=ua(b),d=Cu[c];if(d)return d;d=[];do{var e={id:b.id,nodeName:b.nodeName};e.uid=ua(e);var g={};if(b.className)for(var h=F.get(b),l=0;l<h.length;l++)g[h[l]]=1;e.$J=g;d.unshift(e)}while(b=b.parentNode);
this.rF=d;this.uid=ua(this);Cu[c]=this},a.Cu={},a.Eu={},a.Fu="color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "),a.Gu="font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" ");a.Hu=function(){N.call(this);this.dc=this.Lp()};y(Hu,Fd);t=Hu.prototype;t.C=k;t.zJ=j;t.Jb=je("goog.editor.Plugin");t.CH=function(){this.C&&(this.disable(this.C),this.C=k)};t.enable=function(b){this.C==b?this.dc=j:this.Jb.log(ae,"Trying to enable an unregistered field with this plugin.",i)};t.disable=function(b){this.C==b?this.dc=m:this.Jb.log(ae,"Trying to disable an unregistered field with this plugin.",i)};t.isEnabled=function(b){return this.C==b?this.dc:m};t.Lp=lf;t.dO=lf;
t.w=function(){this.C&&this.CH(this.C);Hu.n.w.call(this)};a.Iu=G.qm({Ew:1,uM:2,pr:3,gj:4,qr:5,execCommand:6,queryCommandValue:7,fG:8,bK:10,aK:11}),a.Ju=G.th(8,10,11);Hu.prototype.execCommand=function(b,c){var d=this.dO(b);d||(B&&Ku(this.C,j,j),this.C.vh());try{var e=this.We.apply(this,arguments)}finally{d||(this.C.Te(),Lu(this.C))}return e};Hu.prototype.ye=s(m);a.Mu=function(b,c,d,e,g){this.IC=b;this.Bz=c;this.dq=d;this.MC=e;this.Lv=g||{}},a.Nu=function(b,c){this.mT=b;this.SB=c},a.Ou=function(b,c,d,e){var g=[];b.dq&&b.Bz&&g.push("<!DOCTYPE HTML>");g.push('<html style="background:none transparent;min-width:0;');b.dq&&g.push("height:",b.MC?"100%":"auto");g.push('">');g.push("<head><style>");d&&d.SB&&g.push(d.SB);B&&b.Bz&&g.push(" img {-moz-force-broken-image-icon: 1;}");g.push("</style></head>");g.push('<body g_editable="true" hidefocus="true" ');Cs&&g.push("contentEditable ");
g.push('class="editable ');g.push('" id="',b.IC,'" style="min-width:0;');B&&b.dq&&(g.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",b.Bz?"100%":"auto"),b.MC?g.push(";overflow:auto"):g.push(";overflow-y:hidden;overflow-x:auto"));rb&&g.push(";outline:hidden");for(var h in b.Lv)g.push(";"+h+":"+b.Lv[h]);g.push('">',c,"</body></html>");b=g.join("");e=e.contentDocument||e.contentWindow.document;e.open();e.write(b);e.close()};a.Vu=function(b,c){N.call(this);this.Bg=this.id=b;this.hb=k;this.ld={};this.mj={};for(var d in Iu)this.mj[d]=[];this.Jk="";this.$j={};this.$j[Pu]=1;this.$j[Qu]=1;this.kx=this.Wr=m;this.Hq=new vj(this.oC,Ru,this);this.Fq={};for(var e in Su)this.Fq[Su[e]]=0;B&&(this.ie=new vj(this.un,Tu,this));this.ec=new ke(this);this.nT=[];this.zj=Uu;this.Ll=Rb(c||document);this.Gc=this.Ll.m(this.id);this.xk=this.Ll.Oa()};y(Vu,Fd);Vu.prototype.field=k;Vu.prototype.Gc=k;Vu.prototype.Jb=je("goog.editor.Field");
a.Pu="change",a.Qu="delayedchange",a.Su={JT:"cvc",zU:"load",HV:"unload",AT:"beforechange",HT:Pu,OT:Qu,BT:"beforefocus",XT:"focus",DT:"blur",CT:"beforetab",mU:"ifrsz",kV:"selectionchange"},a.Uu=0,a.Wu=k;t=Vu.prototype;t.Cg=m;t.IH=m;t.Nt=m;t.m=p("field");t.addListener=function(b,c,d,e){var g=this.m();Np&&(g&&this.lc())&&(g=g.ownerDocument);this.ec.e(g,b,c,d,e)};t.Fh=function(b){return this.ld[b]};a.Tu=15,a.Ru=250;Vu.prototype.lc=mf;Vu.prototype.Nn=mf;Vu.prototype.VG=lf;a.Xu={46:j,8:j};A||(Xu[9]=j);
a.Yu={86:j,88:j};A&&(Xu[229]=j);a.Zu=function(b){var c=!(b.ctrlKey||b.metaKey)&&b.keyCode in Xu;return(b.ctrlKey||b.metaKey)&&b.keyCode in Yu||c},a.$u=function(b,c){b.zj=2;b.field=c;b.hb=Rb(c);b.Wr=m;b.kx=m;c.setAttribute("g_editable","true")};
Vu.prototype.Su=function(){this.ec&&this.ec.removeAll();if((Kg||Lg)&&this.lc()&&this.VG()){try{var b=this.hb.Oa();b.removeEventListener("keydown",this.Jm,m);b.removeEventListener("touchend",this.Jm,m)}catch(c){}delete this.Jm}if(rb&&this.lc()){try{b=this.hb.Oa(),b.removeEventListener("focus",this.Du,m),b.removeEventListener("blur",this.Cu,m)}catch(d){}delete this.Du;delete this.Cu}this.ie&&this.ie.stop();this.Hq.stop()};
Vu.prototype.w=function(){(1==this.zj||this.Rd())&&this.Jb.hk("Disposing a field that is in use.");this.Gc&&this.execCommand("clearlorem");this.zj=Uu;for(var b in this.ld){var c=this.ld[b];c.Lp()||c.disable(this)}this.hb=this.field=k;this.Su();this.Zk&&(yd(this.Zk),this.Zk=k);this.Ll=k;this.ec&&(this.ec.G(),this.ec=k);for(;b=this.nT.pop();)b.G();Wu==this.id&&(Wu=k);for(var d in this.ld)b=this.ld[d],b.zJ&&b.G();delete this.ld;Vu.n.w.call(this)};
a.av=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];Vu.prototype.nz=function(){if(Kp||!this.lc())this.ec.e(this.m(),"DOMSubtreeModified",this.Fw);else{var b=this.hb.Ca();this.ec.e(b,av,this.Fw,j);this.ec.e(b,"DOMAttrModified",v(this.kD,this,this.Fw),j)}};
a.bv=function(b,c){if(9==c.keyCode&&!b.dispatchEvent({type:"beforetab",shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.ctrlKey})||B&&c.metaKey&&(37==c.keyCode||39==c.keyCode))return c.preventDefault(),m;var d;if(!(d=c.charCode))d=Zu(c)?j:!(!B||c.ctrlKey||c.metaKey||B&&!c.charCode);b.qw=d;b.qw&&b.vh();return j},a.cv={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},a.dv={65:j,86:j,88:j},a.ev={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};t=Vu.prototype;
t.Ln=function(b,c){for(var d=this.mj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];if((h.isEnabled(this)||Ju[b])&&h[Iu[b]].apply(h,e))return j}return m};t.RN=function(b,c){for(var d=this.mj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];(h.isEnabled(this)||Ju[b])&&h[Iu[b]].apply(h,e)}};t.Ps=function(b,c,d){for(var e=this.mj[b],g=z.slice(arguments,1),h=0;h<e.length;++h){var l=e[h];if(l.isEnabled(this)||Ju[b])g[0]=l[Iu[b]].apply(l,g)}return g[0]};
a.fv=function(b,c,d){var e={},b=b.Ps(8,c||"",e);Sf(d,e);d.innerHTML=b};t.af=function(b){(B||bv(this,b))&&!this.Ln(1,b)&&Up&&gv(this,b)};t.vM=function(b){if(B){if(!bv(this,b))return}else this.qw=j,this.vh();!this.Ln(2,b)&&!Up&&gv(this,b)};t.wM=function(b){!B&&(this.qw||Zu(b))&&this.un();this.Ln(3,b);hv(this,"selectionchange")||(cv[b.keyCode]||(b.ctrlKey||b.metaKey)&&dv[b.keyCode])&&this.MG.start()};
a.gv=function(b,c){if(!c.altKey){var d=kb?c.metaKey:c.ctrlKey;if(d||ev[c.keyCode]){var e=c.charCode||c.keyCode;17!=e&&b.Ln(5,c,String.fromCharCode(e).toLowerCase(),d)&&c.preventDefault()}}};t.execCommand=function(b,c){for(var d=arguments,e,g=this.mj[6],h=0;h<g.length;++h){var l=g[h];if(l.isEnabled(this)&&l.ye(b)){e=l.execCommand.apply(l,d);break}}return e};
t.queryCommandValue=function(b){var c=this.Rd()&&this.ef;if(oa(b))return this.Ns(b,c);for(var d={},e=0;e<b.length;e++)d[b[e]]=this.Ns(b[e],c);return d};t.Ns=function(b,c){for(var d=this.mj[7],e=0;e<d.length;++e){var g=d[e];if(g.isEnabled(this)&&g.ye(b)&&(c||g.Lp()))return g.queryCommandValue(b)}return c?k:m};t.kD=function(b,c){if(!hv(this,Pu)){var d=c.Ub;try{if(d.originalTarget.prefix||"scrollbar"==d.originalTarget.nodeName)return}catch(e){return}d.prevValue!=d.newValue&&b.call(this,d)}};
t.Fw=function(b){hv(this,Pu)||(b=b.WC?b.Ub:b,b.target.firebugIgnore||(this.kx=this.Wr=j,this.ie.start()))};t.nr=function(){A&&this.execCommand("clearlorem",j);B&&this.sv();this.Te()};a.iv=function(b){var c;return b.lc()&&(c=b.hb)?(b=c.Oa())&&b.frameElement:k},a.jv=function(b){return(b=b.hb&&b.hb.Oa())&&Dp(b)},a.Lu=function(b,c,d){if(!hv(b,"selectionchange")){var e=jv(b),e=e&&e.Bb();b.ef=!!e&&rc(b.m(),e);b.dispatchEvent("cvc");b.dispatchEvent({type:"selectionchange",uX:c&&c.type});b.Ln(4,c,d)}};
t.PM=function(){var b=this.LG;this.LG=k;Lu(this,i,b)};t.vh=function(){hv(this,"beforechange")||this.dispatchEvent("beforechange")};a.Ku=function(b,c,d){c&&(b.ie&&Or(b.ie),b.$j[Pu]=1);d&&(kv(b),b.$j[Qu]=1)},a.lv=function(b,c,d){!c&&b.ie&&Or(b.ie);b.$j[Pu]=0;b.$j[Qu]=0;c&&b.un();d&&b.oC()},a.hv=function(b,c){return!!b.$j[c]||b.Fq[c]&&500>=za()-b.Fq[c]};t.Te=function(b){lv(this,j,b)};t.un=function(){hv(this,Pu)||(this.ie&&this.ie.stop(),this.kx=this.Wr=j,hv(this,Qu)||this.Hq.start())};
t.oC=function(){hv(this,Qu)||(this.Hq.stop(),this.Wr=m,this.dispatchEvent(Qu))};a.kv=function(b){b.ie&&Or(b.ie);Or(b.Hq)};t.sv=function(){this.nC();this.pC()};t.nC=function(){hv(this,"beforefocus")||(this.execCommand("clearlorem",j),this.dispatchEvent("beforefocus"))};t.pC=function(){if(!hv(this,"focus")){Wu=this.id;this.ef=j;this.dispatchEvent("focus");if(B){var b=this.m(),c=jv(this);if(c){var d=Qo(c);0==Ro(c)&&(!d||d==b||"BODY"==d.tagName)&&As(b)}}!Lp&&this.lc()&&this.hb.Oa().parent.getSelection().removeAllRanges()}};
t.Kq=function(){hv(this,"blur")||(Wu==this.id&&(Wu=k),this.ef=m,this.dispatchEvent("blur"))};a.mv=function(b){Hc(b.target,"A")&&b.preventDefault()};t.dj=function(b){Wu=this.id;if(A){var c=b.target;c&&("A"==c.tagName&&b.ctrlKey)&&this.Ll.Oa().open(c.href)}this.Nt=j};t.ww=function(){this.Nt=m};t.qD=function(b){if(!this.IH||this.Nt)this.Nt=m,Lu(this,b),A&&(this.LG=b.target,this.MG.start())};t.CM=function(b){Lu(this,b)};
t.dl=function(){if(this.queryCommandValue("usinglorem"))return" ";if(!this.Rd()){var b=this.Gc;b||this.Jb.log($d,"Couldn't get the field element to read the contents",i);return b.innerHTML}var c=this.m(),b=c.cloneNode(m),c=c.innerHTML;A&&c.match(/^\s*<script/i)&&(c=" "+c);b.innerHTML=c;this.RN(11,b);return this.Ps(10,b.innerHTML)};
t.zd=function(b,c,d,e){if(1==this.zj)this.Jb.log(ae,"Can't set html while loading Trogedit",i);else{e&&this.execCommand("clearlorem");c&&b&&(c="<p>"+c+"</p>");d&&Ku(this,m,j);b=c;if(c=this.m()){if(this.lc()&&C)for(var g=c.ownerDocument.getElementsByTagName("HEAD"),h=g.length-1;1<=h;--h)g[h].parentNode.removeChild(g[h])}else c=this.Gc;c&&fv(this,b,c);e&&this.execCommand("updatelorem");this.Rd()&&(d?(B&&Or(this.ie),lv(this)):this.Te())}};
t.Yz=function(){var b=this.hb.Ca();b.designMode="on";Qp&&b.execCommand("styleWithCSS",m,m)};t.eE=function(){this.Jk&&nv(this)&&kt(this.Jk,this.m())};t.Rd=function(){return 2==this.zj};t.focus=function(){if(!Cs&&this.lc())this.hb.Oa().focus();else{if(rb)var b=this.xk.pageXOffset,c=this.xk.pageYOffset;this.m().focus();rb&&this.xk.scrollTo(b,c)}};t.Lf=function(){(Ip||C)&&ov(this);this.focus()};a.ov=function(b){var c=b.m();if(c){var d=ls(c);c==d?Fp(c,0).select():Kr(d,j);Lu(b)}};
t.Be=function(b){this.zj=1;var c=this.Gc;this.nodeName=c.nodeName;this.JX=c.className;this.cssText=c.style.cssText;c.className+=" editable";this.Jx(b)};t.Jx=function(b){var c=this.Gc;if(c){var c=c.innerHTML,d={},c=this.Ps(8,c,d),e=this.Ll.v("IFRAME",this.dD());if(nv(this)){var g=v(this.TD,this,e,c,d);this.Zk=O(e,"load",g,j);b&&(e.src=b)}this.gB(e);nv(this)||this.TD(e,c,d)}};
t.or=function(){A&&Ds(this.hb.Oa());Wu!=this.id&&this.execCommand("updatelorem");if((Kg||Lg)&&this.lc()&&this.VG()){var b=this.hb.Oa();this.Jm=v(b.focus,b);b.addEventListener("keydown",this.Jm,m);b.addEventListener("touchend",this.Jm,m)}rb&&this.lc()?(this.Du=v(this.sv,this),this.Cu=v(this.Kq,this),b=this.hb.Oa(),b.addEventListener("focus",this.Du,m),b.addEventListener("blur",this.Cu,m)):(Tp?(this.addListener("focus",this.pC),this.addListener(hd,this.nC)):this.addListener("focus",this.sv),this.addListener("blur",
this.Kq,B));if(B)this.nz();else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.vh);var c=this.Te,d;d=d||0;this.addListener(["cut","paste"],function(){return c.apply(this,Array.prototype.slice.call(arguments,0,d))});this.addListener("drop",this.nr)}this.addListener(C?"dragend":"dragdrop",this.nr);this.addListener("keydown",this.af);this.addListener("keypress",this.vM);this.addListener("keyup",this.wM);this.MG=new vj(this.PM,250,this);Rp&&this.addListener("click",mv);this.addListener("mousedown",
this.dj);this.IH?(this.ec.e(this.hb.Ca(),"mouseup",this.qD),this.addListener("dragstart",this.ww)):this.addListener("mouseup",this.qD);this.addListener("mouseover",this.CM);this.eE();lv(this);this.Jb.info("Dispatching load "+this.id);this.dispatchEvent("load");for(var e in this.ld)this.ld[e].enable(this)};a.nv=function(b){if(!ka(b.nx)&&(b.nx=m,A&&b.lc())){for(var c=b.Ll.Oa();c!=c.parent;)try{c=c.parent}catch(d){break}c=c.location;b.nx="https:"==c.protocol&&-1==c.search.indexOf("nocheckhttps")}return b.nx};
t.gB=function(b){var c=this.Gc;b.className=c.className;b.id=c.id;lc(b,c)};t.fw=function(b){var c=Jc(Rb(this.Gc));return new Mu(this.id,c,m,m,b)};t.WH=function(b,c,d){d=this.fw(d);nv(this)?(b=(b.contentDocument||b.contentWindow.document).body,Cs&&(b.contentEditable=j),b.className="editable",b.setAttribute("g_editable",j),b.hideFocus=j,b.id=d.IC,Sf(b,d.Lv),b.innerHTML=c):Ou(d,c,new Nu(this.m(),this.Jk),b)};
t.TD=function(b,c,d){this.Zk&&(yd(this.Zk),this.Zk=k);b.MV="true";this.WH(b,c,d);$u(this,(b.contentDocument||b.contentWindow.document).body);!Cs&&this.lc()&&this.Yz();this.or()};t.dD=function(){var b="padding:0;"+this.Gc.style.cssText;Fa(b,";")||(b+=";");b+="background-color:white;";A&&(b+="overflow:visible;");return{frameBorder:0,style:b}};a.pv=function(b,c){Vu.call(this,b,c)},a.qv=void 0;y(pv,Vu);t=pv.prototype;t.Jb=je("goog.editor.SeamlessField");t.nE=m;t.WN=m;t.Nn=p("nE");t.uD=function(){hv(this,Pu)||rv(this)};
t.zz=function(){if(this.Vo?0:this.Vo=j){var b=m,c=iv(this);if(c){var d,e=iv(this),g=e.contentDocument.body;d=g.parentNode;0===parseInt(lt(e,"height"),10)&&Sf(e,"height","1px");if(Jc(Rb(g)))e=d.offsetHeight;else if(e=d.scrollHeight,d.clientHeight!=d.offsetHeight){d=e;if(!(e=qv))e=document.createElement("div"),e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",g=document.createElement("div"),kg(g,"200px","200px"),e.appendChild(g),document.body.appendChild(e),g=e.offsetWidth-
e.clientWidth,M(e),e=qv=g;e=d+e}d=e;this.HO&&(d=Math.max(d,this.HO));parseInt(lt(c,"height"),10)!=d&&(c.style.height=d+"px",b=j)}this.Vo=m;b&&this.dispatchEvent("ifrsz")}};
a.rv=function(b){if(b.Vo?0:b.Vo=j){var c=iv(b),d=b.m(),e=m;if(c&&d){var g,h=c.parentNode,l=h.offsetWidth;parseInt(lt(c,"width"),10)!=l&&(g=vg(d),c.style.width=l+"px",d.style.width=l-g.left-g.right+"px",e=j);h=h.offsetHeight;b.Nn()&&parseInt(lt(c,"height"),10)!=h&&(g||(g=vg(d)),c.style.height=h+"px",d.style.height=h-g.top-g.bottom+"px",e=j)}b.Vo=m;e&&b.dispatchEvent("ifrsz")}},a.sv=function(b){b.m()&&(rv(b),b.Nn()||b.zz())};t.Pw="";a.tv=m;t=pv.prototype;t.lc=function(){return!Cs};
t.nz=function(){pv.n.nz.call(this);if(this.lc()){var b=iv(this).ownerDocument;this.ec.e(b,av,this.uD,j);this.pO=vd(this.hb.Oa(),"load",this.zz,j,this);this.ec.e(b,"DOMAttrModified",v(this.kD,this,this.uD),j)}};t.un=function(){hv(this,Pu)||(pv.n.un.call(this),this.lc()&&this.zz())};
t.Kq=function(){if(!hv(this,"blur")&&(pv.n.Kq.call(this),!Cs&&!Lp)){var b=this.hb.Oa(),c=m;yd(this.GE);this.GE=vd(b.document.body,"dragover",function(){c=j});fa.setTimeout(v(function(){if(!c&&this.hb){var b=jv(this),e=this.hb.Oa();Ds(e);b&&(b.collapse(j),b.select())}},this),0)}};t.Yz=function(){pv.n.Yz.call(this);var b=this.hb.Ca();b.execCommand("enableInlineTableEditing",m,"false");b.execCommand("enableObjectResizing",m,"false")};
t.eE=function(){!this.lc()&&!tv&&(this.Jk&&kt(this.Jk,this.m()),tv=j)};t.Jx=function(b){if(this.lc())pv.n.Jx.call(this,b);else if(b=this.Gc)$u(this,b),b.contentEditable=j,fv(this,b.innerHTML,b),this.or()};t.or=function(){if(this.lc()){var b=this;fa.setTimeout(function(){sv(b)},0)}pv.n.or.call(this)};t.dD=function(){return{frameBorder:0,style:"padding:0;"}};
t.gB=function(b){if(!this.WN){var c=this.Gc;c&&(this.nE="auto"==Wf(c,"overflowY"))}var c=this.Gc,d=Rb(c),e=c.style.width,g=c.style.height;Sf(c,"visibility","hidden");var d=d.v("DIV",{style:"height:0;clear:both",innerHTML:"&nbsp;"}),h=d.cloneNode(j);c.insertBefore(d,c.firstChild);c.appendChild(h);var h=jt(c),d=h.width,h=h.height,l="";this.Nn()&&(l="&nbsp;",Sf(c,"position","relative"),Sf(c,"overflow","visible"),Sf(b,"position","absolute"),Sf(b,"top","0"),Sf(b,"left","0"));kg(c,d,h);Jc(Rb(c))&&(this.tX=
c.style.lineHeight,Sf(c,"lineHeight","0"));c.innerHTML=l;kg(b,d,h);kg(c,e,g);Sf(c,"visibility","");c.appendChild(b);nv(this)||(c=b.contentWindow.document,Jc(Rb(b.ownerDocument))&&(c.open(),c.write("<!DOCTYPE HTML><html></html>"),c.close()))};t.fw=function(b){var c=this.Gc;if(c)return new Mu(this.id,Jc(Rb(c)),j,this.Nn(),b);f(Error("no field"))};
t.WH=function(b,c,d){Sf(b,"visibility","hidden");var d=this.fw(d),e=this.Gc,g=this.Jk;if(!this.Pw){var h=this.Gc;if(h){var l=h.ownerDocument,n=ua(l);if(!Eu[n]){for(var q=ua(l),r=[],l=tu(l.styleSheets),w=0,E;E=l[w];w++)if((E=su(E))&&E.length)for(var H=0,I=E.length;H<I;H++){var Q=new vu,X;X=Q;var la=E[H],Ya=la.style;if(Ya){var Ma=i,Qa=i;Ya&&(Ma=la.selectorText)&&(Qa=Ya.cssText)?A&&(Qa+="/* */"):la.cssText&&(Qa=/([^\{]+)\{/,Ma=Qa.exec(la.cssText)[1],Qa=la.cssText.replace(Qa,"").replace(/\}[^\}]*$/g,
""));if(Ma){la=X;la.Tg=[];Ma=Ma.split(/,\s*/gm);for(Ya=0;Ya<Ma.length;Ya++){var te=Ma[Ya];0<te.length&&la.Tg.push(new zu(te))}X.$m=Qa;X=j}else X=m}else X=m;X&&r.push(Q)}Eu[q]=r}q=Eu[n];n=[];for(r=0;r<q.length;r++)n.push(q[r].clone());l=new Du(h);w=new yu("body");for(q=0;q<n.length;q++){E=n[q].Tg;r=E.length;for(H=0;H<r;H++){I=E[H];Q=I;X=l.uid;if(Q.su[X])X=Q.su[X];else{for(var Qa=0,Ya=Ma=la=k,te=l.rF,ZD=te.length,Zj=0;Zj<=Q.Vh.length;Zj++){for(Ma=Q.Vh[Zj];Qa<ZD;){var Sx=te[Qa];if(Ma&&Bu(Ma,Sx)){la=
{xC:Qa,NG:Zj};Qa++;break}else Ya&&Bu(Ya,Sx)&&(la={xC:Qa,NG:Zj-1});Qa++}Ya=Ma}X=Q.su[X]=la}X&&(Q=X.NG,I=I.Vh,Qa=I.length-1,X.xC==l.rF.length-1||Q<Qa?(I=I.concat(),I.splice(0,Q+1,w),Q=new zu,Q.Vh=I,E.push(Q)):0<Q&&Q==Qa&&(Q=new zu,Q.Vh=[w,I[Qa]],E.push(Q)))}}l=new vu;h=h.currentStyle||Qb(h).defaultView.getComputedStyle(h,"")||{};q=new zu;q.Vh=[new yu("html")];l.Tg=[q];w={};for(q=0;r=Fu[q];q++)w[r]=h[eb(r)];wu(l,w);n.push(l);l=new vu;w=new zu;w.Vh=[new yu("body")];E={position:"relative",top:"0",left:"0",
right:"auto",display:"block",visibility:"visible"};for(q=0;r=Gu[q];q++)E[r]=h[eb(r)];wu(l,E,j);l.Tg=[w];n.push(l);h=[];r=n.length;for(q=0;q<r;q++){E=n[q];l=h;H=E.Tg.length;w=m;for(I=0;I<H;I++){Q=E.Tg[I].Vh;X=Q.length;for(Qa=0;Qa<X;Qa++)l.push(Q[Qa].cE," ");I<H-1&&l.push(",");B&&!D("1.9a")&&(w=w||uu.test(Q[X-1].cE))}E=E.$m;w&&(E=E.replace(xu,"$1 color: $2 ! important; "));l.push("{",E,"}\n")}this.Pw=h.join("")}}e=new Nu(e,g+this.Pw);d.dq&&(g=vg(e.mT),(g.top||g.left||g.right||g.bottom)&&Sf(b,"margin",
-g.top+"px "+-g.right+"px "+-g.bottom+"px "+-g.left+"px"));Ou(d,c,e,b);sv(this);Sf(b,"visibility","visible")};t.Su=function(){yd(this.GE);yd(this.pO);pv.n.Su.call(this)};a.uv={};uv._default_={jw:function(b){return $.get("/node/CommentV2",{params:{comment_id:b}})},el:ot,fl:ot,add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},remove:function(b){return $.post("/node/CommentV2",{method:"remove_comment",params:{comment_id:b}})},Dx:function(b,c){return $.post("/node/CommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})}};
uv.answer={el:function(b,c){return $.get("/node/AnswerCommentBoxV2",{params:{answer_id:b,load_all:c}})},fl:function(b){return $.get("/node/AnswerCommentListV2",{params:{answer_id:b}})},add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},yJ:function(b,c){return $.post("/node/AnswerCommentV2",{method:"author_remove_comment",params:{comment_id:b,is_block:c}})}};
uv.question={el:function(b){return $.get("/node/QuestionCommentBoxV2",{params:{question_id:b}})},fl:function(b){return $.get("/node/QuestionCommentListV2",{params:{question_id:b}})},add:function(b){return $.post("/node/QuestionCommentAddV2",{method:"add_comment",params:b})}};
uv.favlist={el:function(b){return $.get("/node/FavlistCommentBoxV2",{params:{favlist_id:b}})},fl:function(b){return $.get("/node/FavlistCommentListV2",{params:{favlist_id:b}})},add:function(b){return $.post("/node/FavlistCommentAddV2",{method:"add_comment",params:b})}};
uv.post={jw:function(b){return $.get("/node/PostCommentV2",{params:{comment_id:b}})},el:function(b,c){return $.get("/node/PostCommentBoxV2",{params:{post_id:b,load_all:c}})},fl:function(b){return $.get("/node/PostCommentListV2",{params:{post_id:b}})},add:function(b){return $.post("/node/PostCommentV2",{method:"add_comment",params:b})},Dx:function(b,c){return $.post("/node/PostCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/PostCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};
uv.roundtable={jw:function(b){return $.get("/roundtable/comments/"+b)},el:function(b,c){return $.get("/node/RoundtableCommentBoxV2",{params:{roundtable_id:b,load_all:c}})},fl:function(b){return $.get("/roundtable/comments",{roundtable_id:b})},add:function(b){return $.post("/node/RoundtableCommentV2",{method:"add_comment",params:b})},Dx:function(b,c){return $.post("/node/RoundtableCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/RoundtableCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};a.wv=function(b,c){var d=b.split("!");this.type=d[0]+"!";this.namespace=d[1];this.xc=new vv(c)};y(wv,fd);a.vv=function(b){this.category=b.category;this.action=b.action;this.label=b.label;this.value=b.value};vv.prototype.fill=function(b,c){this[b]=this[b].replace("?",c);return this};a.xv=function(){N.call(this)};y(xv,Dt);a.yv=function(b,c,d){$.post(b,c).done(function(b){if(b.r)U(b.msg);else{var c=b.msg;(c=c&&c.redirect)?window.location.href=c:(U("操作成功！"),d&&d(b))}})},a.zv=void 0,a.Av=Ar($.getJSON);zv=function(b,c){return Av(Ga("/manage/%s/options?action=%s",b,c))};t=xv.prototype;t.xA={remove:"删除",lock:"锁定",unlock:"解除锁定",collapse:"折叠",uncollapse:"解除折叠",mute:"隔离",unmute:"解除隔离"};t.fD=function(b){return zv(b,this.cl())};
t.Hu=function(){var b=xv.n.Hu.call(this);b.mc.set("ok",this.xA[this.cl()]);return b};t.cl=function(){return $(this.Gu).data("op").split("-")[0]};t.ZC=function(b){return Ga("确定要%s该%s？",this.xA[this.cl()],this.IA[b]||"条目")};t.QG=function(b){$(".footnote",this.ew().m()).text(b)};t.tD=function(b){b&&(b.trackable?(b=$.extend({action:"get_member_info",reason:b.value},this.Dv),$.post("/manage",b).then(function(b){return Ga("用户已被警告 %s 次，禁言 %s 次",b.warn_num,b.ban_num)}).then(v(this.QG,this))):this.QG(""))};
xv.prototype.submit=function(){var b=$(this.Gu).data(),c=b.action,b=b.content,d=$($("form",this.bn.m())[0]).serialize();b&&(d+="&"+b);yv(c,d,this.Ek)};xv.prototype.w=function(){this.Ek=this.Gu=k;xv.n.w.call(this)};xv.prototype.open=function(b,c,d){this.Gu=b;this.Ek=d||ea.nX;xv.n.open.call(this,c.type,c.id,"")};a.Bv=function(b){T.call(this);G.extend(this.F={},this.defaults,b||{});this.tk=new Md;this.xf=k};y(Bv,T);t=Bv.prototype;t.defaults={trigger:{A:"data-editable"},RI:"hc-actionbar",hO:"checked",WR:100,iN:100};
t.B=function(){Bv.n.B.call(this);this.Em=L("div");document.body.appendChild(this.Em);var b=this.F,c=new sm(b.trigger,m,k,this.g);c.ot=b.WR;c.zr=b.iN;c.Ug(this.Em);O(c,"trigger",function(b){c.Xc(new am(b.anchor,1))});O(c,"beforeshow",function(b){this.xf=b.target.anchor;this.X()},m,this);c.className=b.RI;this.nN=c};t.hw=p("nN");
a.Cv=function(b,c){var d=b.F.hO,e=nc(b.Em),g=z.find(e,function(b){return b.getAttribute("data-action")===c});if(!g||F.has(g,d))return m;z.forEach(e,function(b){F.remove(b,d)});F.add(g,d);return j};t.OJ=function(b,c,d){c=L("div",{title:b.R,"data-action":b.name,className:"button "+b.name+(0===c?" first":c===d.length-1?" last":"")},[L("i","icon icon-actionbar-"+b.name)]);rg(c,j);this.h().e(c,"click",function(){Cv(this,b.name)&&b.Dk(this.xf)});return c};
t.X=function(){this.Em.innerHTML="";gc(this.Em,z.map(G.Ma(this.tk.Et()),this.OJ,this))};a.Dv=function(b){T.call(this);G.extend(this.F={},this.defaults,b||{})};y(Dv,T);Dv.prototype.defaults={KD:{},vJ:j};
Dv.prototype.B=function(){Dv.n.B.call(this);var b=this,c=this.g;if(this.F.vJ){var d=new Bv({});d.tk.set("link",{name:"link",R:"链接",Dk:function(b){wc(b,b.href)}||ha});d.tk.set("text",{name:"text",R:"文本",Dk:function(b){wc(b,b.getAttribute("data-title"))}||ha});d.o(c);var e=d.hw();Mr(e,new Nf(2,0,0,0));e.tl=new Nf(2,0,0,0)||k;var g=d.h();g.e(e,"beforeshow",function(b){var b=b.target.anchor,c=Ec(b);c===b.href?Cv(d,"link"):(c!==b.getAttribute("data-title")&&b.setAttribute("data-title",c),Cv(d,"text"))}).e(e,
"beforehide",function(b){if((b=b.target)&&c.contains(b)&&Ev(b))return m});var h;g.e(e,"show",function(b){h=b.target.anchor;F.add(h,"hover")}).e(e,"hide",function(){h&&(F.remove(h,"hover"),h=k)});this.Kp=d}this.h().e(c,"paste",function(){setTimeout(function(){var c=b.F,d=b.g,e=yc(d,function(b){return 3===b.nodeType&&!Fv(b,d,function(b){return Ev(b)||"CODE"===b.nodeName||"PRE"===b.nodeName})}),g,h=Dp(),E=h&&Po(h);z.forEach(e,function(b){var c=b.nodeValue,d=c.replace(Gv,function(b){Ea(b,"http")||(b=
"http://"+b);return b.link(b)});d!==c&&(c=ec(d),E===b&&(g=c.lastChild),lc(c,b))});g&&Kr(g);var H=c.KD,c=z.filter(d.getElementsByTagName("A"),function(b){var c=b.getAttribute("href");if(c=!(!c||"#"===c))if(c=!b.getAttribute("data-editable"))if(c=z.contains(Hv,b.protocol))c=Ec(b),Ea(b.href,c)?b=i:(b.setAttribute("data-editable",j),b.setAttribute("data-title",c),b=j),c=!b;return c}),c=z.map(c,function(b){return Iv(b.href).done(function(c){var e=H;if(c&&d.contains(b)){var e=e||{},g=function(b,c,d){var e=
Dp();if(e){var g=e.V(),h=e.ta(),l=e.ea(),n=e.Ia();rc(c,g)&&(g=b,h=0);rc(c,l)&&(l=b,n=0);d(function(){g===b&&l===b?Kr(b):pp(g,h,l,n).select()})}else d(ha)},h={link:function(b,c){b.setAttribute("data-editable",j);c.title===b.href?b.setAttribute("data-title",b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname)?-2:-3).join(".").replace(/^www\./,"")+" 的页面"):(b.setAttribute("data-title",c.title),g(b,b,function(d){wc(b,c.title);d()}))},image:function(b,c){var d=document.createElement("img");
d.src=c.src;d.setAttribute("data-rawwidth",c.width);d.setAttribute("data-rawheight",c.height);g(d,b,function(c){lc(d,b);c()})}};(e=e[c.type]||h[c.type])&&e(b,c)}})});c.length&&(b.dispatchEvent("willScrape"),$.when.apply($,c).always(function(){b.dispatchEvent("didScrape")}))})}).e(c,"keydown",this.dN)};
Dv.prototype.dN=function(b){var c=qh(b.keyCode),d=8===b.keyCode;if(!(b.ctrlKey||(b.altKey||b.metaKey)||!c&&!d)){var c=Dp(),e=c.V(),g=c.ea(),h=this.g,l,n=Fv(e,h,Ev)||g!==e&&(l||(l=Fv(g,h,Ev)));if(n){var q=Ec(n),r=c.ta(),w=c.Ia();if(n.getAttribute("data-editable")&&q===n.href){var E=m;l=l||Fv(g,h,Ev)||n;var h=n.contains(e),H=l.contains(g);if(d)h&&(e=n,r=0,E=j),H&&(g=l,w=Dr(l),E=j),E&&pp(e,r,g,w).select();else if(h&&H&&l===n){if(!c.isCollapsed()||!(0===r||q.length===r))b.preventDefault(),Kr(n)}else h&&
(e=n.nextSibling,r=0,E=j),H&&(g=l.previousSibling,w=Dr(g),E=j),E&&pp(e,r,g,w).select()}}}};a.Gv=/\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig,a.Hv=["http:","https:"],a.Fv=function(b,c,d){for(;b&&b!==c;){if(d(b))return b;b=b.parentNode}},a.Ev=function(b){return"A"===b.nodeName},a.Iv=Ar(function(b){return $.post("/scraper",{url:b})});a.Jv=function(b,c,d){T.call(this);this.id=b;this.type=c;this.field=k;this.sd=this.Pg=m;this.Vd="写下你的评论…";this.placeholder='<p style="color:#999">'+this.Vd+"</p>";this.zl="";this.da=-1;this.NE=$.Deferred().resolve();this.Hy=this.ks=k;this.DB="zm-comment-box";this.fh=k;(b=uv[c])||f(Error("API not found"));this.Bi=$.extend({},uv._default_,b);G.extend(this.F={},this.defaults,d||{})};y(Jv,T);t=Jv.prototype;t.defaults={KE:m,autofocus:j,wv:"empty",ze:"zm-item-comment"};
t.$=function(b){Jv.n.$.call(this,b);Kv(this);Lv(this);this.sd=j;z.forEach(Mv(this),this.gy,this)};a.Nv=function(b,c,d){var e=K(b.DB,c);d&&(b.fh=d);e?b.o(e):(b.Pg=j,b.X(c))};t.tJ="zm-comment-bubble";t.cB="."+Jv.prototype.tJ;t.St=function(b){return $(b,this.g)};t.v=function(){this.g=L("div",{"class":this.DB,style:"display:none"});this.Ve()};t.Ii=s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');
t.w=function(){Jv.n.w.call(this);this.field=this.HB=this.Tm=this.VA=this.fh=this.Hy=this.LE=k};a.Ov=function(b){var c=b.Tk,d=c.m();if(c.dl()!==b.placeholder){c.zd(m,b.placeholder);var e=["click","focus","keydown"],g=function(){c.zd(m,this.zl||"");this.field.lastChild?Kr(this.field.lastChild):c.Lf();wd(d,e,g,m,this)};O(d,e,g,m,b);var h;window.getSelection?(h=window.getSelection(),h.anchorNode&&rc(b.field,h.anchorNode)&&h.removeAllRanges()):document.selection&&b.field.blur()}};
t.Pr=function(b){(b=b.m&&b.m())&&(new Dv({KD:{image:ha}})).o(b)};t.Or=function(b,c){if(b.m){var d=(new hj).add("type",this.type+"_comment").add("resource_id",this.id),e=b.m();this.gX=d=new uq(e,{wm:{source:"/people/autocomplete?"+d.toString()},Jj:K("zu-main")||document.body});new qq(e,{Ty:wq});qa(c)&&c(d)}};
t.aS=ol(function(b){var c=K("zm-comment-content-wrap",b),d=K("zm-comment-form",b),e=b.getAttribute("data-id"),g=this,h;if(d){h=K("zm-comment-editable",d);if(pg(d)){if(gs(d))return R(d,m)}else R(d,j);Pv(h)}else{(b=K("zm-comment-reply-hack"))?(b=ec(Hr(b)),F.ju(b,"zm-comment-reply-hack","zm-comment-reply-hacked"),jc(b,c)):(b="",S.ha()&&(b='<img class="avatar" src="'+S.BL()+'">'),b=ec('<div class="zm-comment-form expanded"><div class="zm-comment-editable-wrap">'+b+'<div class="zm-comment-editable" aria-label="写下你的回复"></div></div><div class="zm-command zg-clear"><a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a><a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a></div></div>'),
c.appendChild(b));d=b;h=K("zm-comment-editable",d);var l=new pv(h);l.zd(m,"");l.Be();this.Or(l,function(){Pv(h)});this.Pr(l);c=K("zm-comment-close",d);b=K("zm-comment-submit",d);b.name="";var n=function(){var b=La(l.dl()),c=La(Ec(h));b&&c?Qv(g,{content:b,jR:e},function(b){b.r||(R(d,m),l.zd(m,""),(b=z.Td(Mv(g)))&&ts(b,{offsetTop:100,$A:j}))}):(U("请填写内容"),h.focus())};O(c,"click",function(){R(d,m)});O(b,"click",n);O(h,"keydown",function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))n(),b.preventDefault()})}ts(d,
100)},function(){return{ha:{question:"question_comment_reply",answer:"question_answer_comment_reply"}[this.type]||j,ad:j}});a.Pv=function(b){b.focus();b=So(b);b.collapse();b.select()},a.Lv=function(b){var c=location.hash.slice(1).split("-"),d="comment"===c[0]&&c[1];d&&(b=z.find(Mv(b),function(b){return b.getAttribute("data-id")===d}),wk(b),ts(b))},a.Mv=function(b){return $(b.Tm).children(".zm-item-comment").get()};t.nt=function(b){F.enable(this.HB,"expanded",b)};
t.ki=function(b,c){this.dispatchEvent(new wv("click!comment",{category:"?",action:this.type+"_comments",label:"?_"+b,value:pa(c)?c:this.Ra()}))};t.cj=function(){this.sd?Rv(this):this.Pg=j};t.yP=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))this.Mp(),$(this.field).blur(),b.preventDefault();27===b.keyCode&&Sv(this)};
t.ra=function(b){var c=Ck(this.g,b.target,"BUTTON")||Ck(this.g,b.target);if(c&&c.name){var d=Hc(c,k,this.F.ze);b.preventDefault();switch(c.name){case "reply_comment":this.aS(d);break;case "cancelanon":b=$(this.g).parents(".feed-item-hook").data("qid");Qr(0,k,b);break;case "delcomment":this.lr(c);break;case "like_comment":this.yM(c);break;case "author_delcomment":var e=this,g=Hc(c,k,this.F.ze),h=g.getAttribute("data-id"),b=$(".zm-item-link-avatar",g).prop("href");$.get(b+"/block",function(b){var c=
Ai("删除评论","你确定要删除这条评论吗？"+('<p style="margin-top: 0.2em;color:#999;'+(b.r||b.msg?"display:none":"")+'"><label><input type="checkbox">同时将此人屏蔽</label></p>'),function(b){if(b){var b=$(":checkbox",c.m()).prop("checked"),d=xa(M,g);e.Bi.yJ(h,Number(b)).done(v(function(){qa(d)&&d();this.da-=1;Tv(this)},e))}},e)});break;case "admin_delcomment":var l=Hc(c,k,this.F.ze);(new xv).open(c,{id:l.getAttribute("data-id"),type:"comment"},v(function(){M(l);this.da-=1;Tv(this)},this));break;case "closeform":Sv(this);
break;case "report":this.rr(c);b.stopPropagation();break;case "addnew":this.Mp();break;case "load-more":this.ki("comments_all"),this.LE(c)}}};
t.LE=function(b){this.ks&&"pending"===this.ks.state()||(b&&F.add(b,"loading"),this.ks=this.Hy||this.ME(),this.ks.done(v(function(c){c=$(c).filter(".zm-item-comment").get();if(c.length){var d=Mv(this);d.length&&(c=z.filter(c,function(b){return!z.find(d,function(c){return c.getAttribute("data-id")===b.getAttribute("data-id")})}),c=z.concat(d,c).sort(function(b,c){return b.getAttribute("data-id")-c.getAttribute("data-id")}),z.forEach(c,this.eB,this),b&&M(b));gc(this.Tm,c)}},this)))};
t.yM=ol(function(b){var c=$(b),d=Hc(b,k,this.F.ze),b=$(".like-num",d),e=d.getAttribute("data-id");(d=!c.hasClass("liked"))&&this.ki("like_comment");this.Bi.Dx(e,d);var e=$("em",b),g=+e.text()+(d?1:-1);b.toggleClass("liked",d).toggleClass("nil",0>=g).attr("data-tip","s$r$"+g+" 人觉得这个很赞");e.text(g);c.toggleClass("liked",d);pk(c[0],d?"取消赞":"赞")},function(){return{ha:{question:"question_comment_like",answer:"question_answer_comment_like"}[this.type]||j,ad:j}});
a.Sv=function(b){0<b.Ra()?(b.zl=b.ab(),b.nt(m),Ov(b)):b.fh?b.collapse():b.nt();b.Df()};t.expand=function(){this.Ka(j)};t.collapse=function(){this.Ka(m)};t.tc=p("sd");
t.Ka=function(b){if(b!==this.sd){b&&(this.St(this.cB).hide(),this.Ve());this.sd=b;this.dispatchEvent(b?"beforeexpand":"beforecollapse");R(this.g,this.sd);var c=v(function(){b&&Uv(this);this.dispatchEvent(b?"expand":"collapse");this.al&&!b&&(mq(this.al),ts(this.al.g))},this),d;b&&this.Pg?(d=Rv(this))&&d.done(c):setTimeout(c);this.fh&&(b?(this.sQ=Ec(this.fh),pk(this.fh,"收起评论")):pk(this.fh,0>this.da?this.sQ:this.da?this.da+" 条评论":"添加评论"))}};t.uf=function(){this.Ka(!this.sd)};
a.Uv=function(b){if(b.fh){var c=$(b.fh);b.St(b.cB).show().css("left",c.position().left+c.width()/2)}},a.Rv=function(b){if("pending"!==b.NE.state()){b.ib();b.g.innerHTML=b.Ii();b.expand();var c=b.Bi.el(b.id,b.F.KE).done(v(b.cR,b));return b.NE=c}};t.ME=function(){return this.Bi.fl(this.id)};a.Vv=function(b,c,d,e){var c=$(c),g=$(d);d?($(".zm-command, .zm-comment-info",b.g).hide(),$(b.field).hide().after(g).after(c)):c.insertAfter(b.field);e&&e.call(b,c,g)};
t.cR=function(b){b=ec(La(b));R(b,this.sd);z.forEach($("."+this.F.ze,b).get(),this.gy,this);this.Pg=m;this.ib();lc(b,this.g);this.g=b;Kv(this)};
a.Kv=function(b){G.forEach({VA:".load-more",Tm:".zm-comment-list",HB:".zm-comment-form",field:".zm-comment-editable"},function(b,c){this[c]=$(b,this.g)[0]},b);b.field&&b.field.setAttribute("aria-label",b.Vd);if(Pg){var c=b.field;c.setAttribute("contentEditable",j);var d=b.Tk={m:function(){return c},dl:function(){return c.innerHTML},zd:function(b,d){c.innerHTML=d},Lf:function(){As(c)}};b.Or(d);b.Pr(d)}else{var e=L("textarea",{placeholder:b.Vd,"class":"zm-comment-textarea"});lc(e,b.field);new Tk(e,
22);b.field=e;b.Tk={m:function(){return e},dl:function(){return e.value},zd:function(){e.value="";e.style.height=Yf(22,j)},Lf:function(){e.focus()}}}b.h().e(b.field,["change","keyup"],function(b){27!==b.keyCode&&(this.zl=Bs(this.field)?"":this.ab())});S.ha()&&!S.yi&&Vv(b,'<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,c){function d(){Wk.O().D(j)}b.on("click",d);c.on("click",
d)});S.ha()||Vv(b,'<div class="signin-mask-tip-comment"></div>',k,function(c,d){function e(){nl({question:"question_comment_box",answer:"question_answer_comment_box"}[b.type])}c.on("click",e);d.on("click",e)});Ov(b);b.h().e(b.g,"click",b.ra).e(b.field,"keydown",b.yP).e(Ji,"anon_change",b.cj).e(b.Tk.m(),["click","focus"],xa(b.nt,j)).e(b.Tk.m(),"focus",xa(b.ki,"add_comment_start"));b.da=Number(b.g.getAttribute("data-count"));$(b.g).on("focusin focusout","."+b.F.ze,function(b){$(this).toggleClass("focusin",
"focusin"===b.type)});!sb&&b.VA&&(b.Hy=$.Deferred(function(b){setTimeout(b.resolve,2E3)}).promise().then($.proxy(b.ME,b)));Tv(b);Uv(b)},a.Tv=function(b){var c=b.F,d=!b.Ra();F.enable(b.g,c.wv,d);d&&b.field&&c.autofocus&&b.field.focus();b.dispatchEvent("change")};t.ab=function(){var b=La(this.Tk.dl());return b===this.placeholder?"":b};t.Mp=function(){var b=this.ab(),c=La(Ec(this.field));b&&"TEXTAREA"===this.field.tagName&&c||b?Qv(this,b):(U("请填写内容"),this.field.focus())};t.Ra=p("da");
a.Qv=function(b,c,d){if(!(b.Rl&&"pending"===b.Rl.state())){var e;ra(c)&&(e=c.jR,c=c.content);var c=Oa(c),g=new Md;g.set(b.type+"_id",b.id);g.set("content",c);e&&g.set("reply",e);c=b.Bi.add(g.Et());c.done($.proxy(b.ML,b)).done(d);b.Rl=c;b.zl=b.ab();b.ki("add_comment_submit")}};t.ML=function(b){if(b.r)return U(b.msg);this.Bi.jw(b.msg).done($.proxy(this.dR,this));this.Tk.zd("");Ov(this);this.nt(m)};t.gy=function(b){this.eB(b)};
t.eB=function(b){if(nh("auth_f_manage")&&!("favlist"===this.type||$(".del, .op.remove",b).length)){var c=b.getAttribute("data-id");$("<a>",{href:"#",name:"admin_delcomment","class":"del zm-comment-op-link op needsfocus",html:'<i class="zg-icon zg-icon-comment-del"></i>删除',"data-op":"remove-comment","data-action":"/manage?"+$.param({comment_id:c,action:"remove_comment2"})}).appendTo($(".zm-comment-ft, .actions",b))}};
t.dR=function(b){this.zl="";b=ec(b);this.Tm.appendChild(b);this.gy(b);this.da+=1;Tv(this)};t.rr=ol(function(b){b=Hc(b,k,this.F.ze).getAttribute("data-id");Ft("comment",b)},function(){return{ha:{question:"question_comment_report",answer:"question_answer_comment_report"}[this.type]||j,ad:j}});t.lr=function(b){var c=Hc(b,k,this.F.ze),d=c.getAttribute("data-id");Ai("删除评论","你确定要删除这条评论吗？",function(b){if(b){var g=xa(M,c);this.Bi.remove(d).done(v(function(){qa(g)&&g();this.da-=1;Tv(this)},this))}},this)};
t.Ve=function(){$(window).on("beforeunload.CommentForm",v(function(){if(this.zl)return"你的评论还未保存，确认离开该页面吗？"},this))};t.Df=function(){$(window).off("beforeunload.CommentForm")};a.Wv=function(b){if(!b.al&&!ah.uc){var c=Hc(b.g,k,"zm-item-meta");if(c){var d=K("zm-meta-panel",c);d&&(b.al=new oq(k,c),b.al.ah="comment",b.al.o(d))}}};a.Xv=function(b){T.call(this);this.entryType=b};y(Xv,T);t=Xv.prototype;t.Jv="zm-item-expanded";t.os="zm-item-meta";t.vj=k;t.B=function(){Xv.n.B.call(this);var b=$(this.g),c={};$("meta[itemprop]",b).each(function(){var b=$(this);c[b.attr("itemprop")]=b.attr("content")});this.ub=c[this.entryType+"-id"];this.yh=c[this.entryType+"-url-token"];this.Rq=c;this.Hm();this.fe()};
t.Hm=function(b){var c={'a[name="expand"]':function(b){this.Ka(j);this.Pn&&(b.currentTarget.name="toggleExpanded")},'a[name="collapse"]':function(){this.Ka(m)},'a[name="toggleExpanded"]':this.uf,'a[name="ignore"]':this.Bw,".js-close":this.yD,".js-collect":this.nl,".js-hiderelated":this.xD,".js-report":this.NM,".js-share":this.rc,".js-toggle-commentbox":this.DD,".js-unhide":this.HD,'a[name="dislike"]':this.ZL};G.extend(c,b||{});G.forEach(c,function(b,c){$(this.g).on("click",c,$.proxy(b,this))},this);
var d=$(".zm-meta-panel",this.g);G.forEach({'a[name="toggle-comment"]':function(b){this.DD(b);d.toggleClass("focusin",this.sa.tc())},'a[name="share"]':this.rc},function(b,c){d.on("click",c,$.proxy(b,this))},this)};t.DD=function(b){this.gp();this.sa.tc()&&(b=parseInt(Ec(b.currentTarget),10)||0,this.sa.ki("view_comments",b))};t.NM=function(){Ft(this.entryType,this.ub)};t.Mx=function(){ou(this.entryType,this.yh,"read")};t.Bj=function(){ou(this.entryType,this.yh,"touch")};
t.tc=function(){return F.has(this.g,this.Jv)};t.uf=function(){this.Ka(!this.tc())};t.Ka=function(b){if(b===this.tc())return m;b&&jt(this.g).height<Xb().height&&1<$("a.collapse",this.g).length&&$("a.collapse",this.g).eq(0).remove();F.enable(this.g,this.Jv,b);this.dispatchEvent(b?"expand":"collapse");return j};t.jQ=function(){window.open(K(this.vj,this.g).href)};t.yD=function(){$(this.g).fadeOut(150,function(){$(this).remove()})};t.HD=ha;t.xD=ha;
t.rc=ol(function(){new ku(arguments,"tb-webshare-sina")},{ha:"question_answer_share"});
t.ZL=function(){var b=$(this.g),c=$(".feed-item-inner",this.g),d=$(".dislike-wrap",this.g),e=d.data();d.one("click",".revert",function(){c.slideDown();d.slideUp();$.post("/topstory/item/uninterest/revert",e)}).one("click",".close",function(){b.slideUp(function(){b.remove()})}).on("click",".zg-unfollow",function(){var c=$(this).data(),d={roundtable:Sj,column:Rj};Ai("确定取消关注？",xt("确定取消关注%s吗？",c.title),function(e){e&&(d[c.follow](c.token,m),b.slideUp(function(){b.remove()}))},this)});$.post("/topstory/item/uninterest",
e).done(function(){c.slideUp();d.slideDown()})};t.gp=function(){if(!this.sa){var b=$(".toggle-comment",this.g)[0];this.sa=new Jv(this.ub,this.entryType);this.H(this.sa);Nv(this.sa,K(this.os,this.g),b);Wv(this.sa)}this.sa.uf()};t.Aw=function(){this.sa?this.sa.field.focus():this.gp()};
t.fe=function(){this.$f=nk.UH(this.g);mk(this.$f.register("shift+o",this.jQ,this),{group:"操作",name:"新窗口打开条目"});var b=$('a[name="dislike"], a[name="ignore"]',this.g);b.length&&mk(this.$f.register("i g",function(){b.click()}),{group:"操作",name:"不感兴趣"})};a.Yv=function(b){T.call(this);this.vp="votebar-mobile";this.qv="votebar-mobile-dialog";this.lA=b;this.PH=L("span","_votebar-holder")};y(Yv,T);Yv.prototype.$=function(b){Yv.n.$.call(this,b);this.h().e(b,"click",this.mQ)};Yv.prototype.PK=function(){var b=this.lA;lc(b.m(),this.PH);F.remove(b.m(),this.vp)};Yv.prototype.mO='<div class="text zg-clear"><label class="zg-left">赞同</label><label class="zg-right">反对</label></div>';
Yv.prototype.mQ=function(){this.nb&&this.nb.G();var b=new vi(k,m);b.Qk=j;b.Io(j);b.tL=j;var c=this.lA;lc(this.PH,c.m());F.add(c.m(),this.vp);this.h().e(c,"action",function(){this.nb&&setTimeout(v(function(){this.nb.D(m)},this),150)});me(this.h(),b,"hide",this.PK);c=b.U();c.appendChild(this.lA.m());c.appendChild(ec(this.mO));F.add(b.m(),this.qv);b.D(j);this.nb=b;Qc(this,b)};a.Zv=function(){Xv.call(this,"post")};y(Zv,Xv);t=Zv.prototype;t.vj="post-link";
t.B=function(){Zv.n.B.call(this);var b=this.vt=new Bt;this.H(b);Qc(this,b);this.h().e(b,"expand",function(){this.Ka(j)});b.o(this.g);b.ed()&&me(this.h(),b,"expand",this.Mx);At(this.g,this.Bj,this);if(b=K("zm-votebar",this.g))this.sb=new bu(this.ub,this.entryType),Qc(this,this.sb),this.sb.o(b),(b=K("votenum-mobile",this.g))&&(new Yv(this.sb)).o(b);if(b=K("zm-item-vote-info",this.g)){var c=this.WX=new $v(this.ub,this.entryType);Qc(this,c);c.o(b);this.sb&&this.h().e(this.sb,"change",function(){c.Xh()}).e(c,
"change",function(){var b=K("zm-item-vote-count",this.g),e=$(".zm-votebar .count",this.g)[0];b&&pk(b,c.Ra());e&&pk(e,c.Ra())})}};t.rc=function(){Zv.n.rc.call(this,"分享文章","post",this.ub,{post_id:this.ub})};t.Ka=function(b){Zv.n.Ka.call(this,b)&&(b||Us($(".entry-body",this.g)[0]),this.vt.Ka(b),this.mz(b))};t.mz=function(b){var c=this.Hn();c&&lq(c,b)};
t.Hn=function(){if(this.wp)return this.wp;var b=!sb,c=K("zm-editable-content",this.g),d=this.sb&&this.sb.m();b&&(d&&$(d).is(":visible")&&c&&230<$(c).height())&&(b=this.wp=new oq(k,c),this.H(b),b.ah="votebar",b.wy=50,b.o(d))};t.Bw=function(){$(".feed-hide-options",this.g).show().siblings().hide();$.post(xt("/post/uninterest"),{id:this.ub})};t.HD=function(){$(".feed-hide-options",this.g).hide().siblings().show();$.post(xt("/post/undo_uninterest"),{id:this.ub})};
t.xD=function(b){var b=$(b.currentTarget),c=b.data();Ai(b.attr("title"),xt("确定%s吗？",b.text()),function(b){b&&(this.yD(),$.post(xt("/%s/uninterest",c.type),{id:c.id}))},this)};
t.fe=function(){Zv.n.fe.call(this);mk(this.$f.register("v",function(){this.sb&&this.sb.Gt()},this),{group:"操作",name:"赞同"});mk(this.$f.register("d",function(){this.sb&&this.sb.Ft()},this),{group:"操作",name:"反对"});mk(mk(mk(mk(this.$f.register("o",this.uf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.gp,this),{group:"操作",name:"打开评论"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("shift+c",this.Aw,this),{group:"操作",name:"定位到评论框"})};a.aw=function(b){Xv.call(this,b)};y(aw,Xv);aw.prototype.vj="question_link";aw.prototype.Bw=function(){var b=this.Rq["question-id"];this.dispatchEvent({type:"ignore",key:"question-id",value:b});$.post("/question/uninterest",{qid:b})};a.bw=function(){Xv.call(this,"question")};y(bw,aw);bw.prototype.B=function(){bw.n.B.call(this);At(this.g,function(){ou("question",this.yh,"touch")},this)};bw.prototype.rc=function(){bw.n.rc.call(this,"分享问题","question",this.yh,{qid:this.ub})};
bw.prototype.fe=function(){bw.n.fe.call(this);mk(mk(mk(this.$f.register("c",this.gp,this),{group:"操作",name:"打开评论"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("shift+c",this.Aw,this),{group:"操作",name:"定位到评论框"})};a.cw=function(){Xv.call(this,"answer")};y(cw,aw);a.dw=function(b){return K("zm-item-answer",b)||K("entry-body",b)};t=cw.prototype;t.B=function(){cw.n.B.call(this);this.aB=dw(this.g);this.Pn=this.aB.getAttribute("data-isowner");this.Zw();this.vl()};t.rc=ha;
t.Ka=function(b){cw.n.Ka.call(this,b)&&(b||(Us(this.mg.m()),ew(this,m)),b&&this.vl(),this.mg.mz(b),this.mg.vt.Ka(b))};t.Zw=function(){var b=K("zm-item-answer-author-wrap",this.g);b&&(b=K("zm-list-avatar",b),Uj.add(b))};t.vl=function(){this.mg=new fw(this.Rq["question-id"],{mb:this.Rq["question-url-token"]},this.ub);var b=K("zm-item-meta",this.g);this.mg.Tc=b;this.H(this.mg);this.mg.o(this.aB);b=this.mg.vt;this.h().e(b,"expand",function(){this.Ka(j)});this.vl=ha};
t.fe=function(){cw.n.fe.call(this);mk(this.$f.register("o",this.uf,this),{group:"操作",name:"显示全部/收起"})};t.Hm=function(){cw.n.Hm.call(this,{"a[name=expandQuestionDetail]":function(){ew(this,j)}})};a.ew=function(b,c){$(".feed-question-detail-item",b.g).toggleClass("question-detail-expanded",c)};a.gw=function(){Xv.call(this,"roundtable")};y(gw,Xv);t=gw.prototype;t.B=function(){gw.n.B.call(this);this.Gn()};t.vj="roundtable_link";t.Bw=function(){$.post("/roundtable/"+this.yh,{action:"mute"});this.dispatchEvent({type:"ignore",key:"roundtable-id",value:this.ub})};t.Gn=function(){At(this.g,this.Bj,this)};t.Bj=function(){ou("roundtable",this.yh,"touch")};a.hw=function(){Xv.call(this,"column")};y(hw,Xv);hw.prototype.B=function(){hw.n.B.call(this);var b=K("column",this.g);At(b,this.Bj,this)};hw.prototype.Bj=function(){ou("column",this.yh,"touch")};a.iw=function(b){var c=b.getAttribute("data-type");return(c={p:Zv,a:cw,q:bw,r:gw,c:hw}[c])?new c:dw(b)?new cw:new T};a.jw=function(b,c,d){Tt.call(this,b,c,d)};y(jw,Tt);jw.prototype.Fj=function(b){var c=iw(b);this.H(c);c.o(b);c instanceof cw&&c.Ka(m)};a.kw=function(){N.call(this);this.S=k;this.oa=0;this.Ex=[];this.fs=[];this.Tz="最多输入 20 字";this.ov="最多输入 256 字"};y(kw,Qk);ia(kw);t=kw.prototype;
t.v=function(){this.UK=j;this.g=L("div",k,[this.wj=L("div",k,[this.Jg=L("div","zm-favo-list-content"),this.QA=L("div","zh-favo-add-new-wrap zm-command",this.kS=L("a",{"class":"zm-favo-dialog-create zg-left",href:"javascript:;"},"+ 创建收藏夹"),this.Tu=L("a",{href:"javascript:;","class":"zg-btn-blue"},"关闭")),this.iu=L("div","zh-favo-add-new-wrap zm-command",this.gK=L("a",{href:"javascript:;","class":""},"取消"),this.lS=L("a",{"class":"zm-favo-dialog-create zg-btn-blue",href:"javascript:;"},"创建收藏夹"))]),this.Yv=
L("div",{style:"display:none"},[L("div",k,["标题",this.Sz=L("span",{"class":"zh-favo-add-title-error"},"请填写标题")]),L("div","zg-section",this.xj=L("input",{"class":"zg-form-text-input",style:"width:97%;font-size:13px"})),L("div",k,"描述（可选）"),L("div","zg-section zg-editor-simple-wrap zg-form-text-input",this.Al=L("textarea",{"class":"zg-editor-input",style:"height:66px"})),this.MQ=L("label",k,[this.aO=L("input",{type:"radio",checked:"checked",value:"public",name:"mode"}),L("strong",k," 公开 "),L("span","zg-gray-normal",
"公开后不能设置为私密")]),this.kO=L("br"),this.JQ=L("label",k,[this.$N=L("input",{type:"radio",value:"private",name:"mode"}),L("strong",k," 私密 "),L("span","zg-gray-normal","只有你可以查看这个收藏夹")]),L("div","zm-command",[this.Fz=L("a",{href:"javascript:;","class":"zg-mr10"},"取消"),this.rq=L("a",{href:"javascript:;","class":"zg-mr10"},"完成"),this.OA=L("a",{"class":"zg-btn-blue"},"确认创建")])])]);R(this.Sz,m);R(this.iu,m);(new Em(this.Tz)).o(this.xj);(new Em(this.ov)).o(this.Al);z.forEach(this.Ex,function(b){lw(this,b)},this);
this.Ex.length||(this.Jg.innerHTML='<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ',R(this.iu,j),R(this.QA,m));mw(this);this.S.U().innerHTML="";this.S.U().appendChild(this.g);this.S.fa()};
a.mw=function(b,c,d){b.S||(b.S=new vi(k,m),ei(b.S,k),b.S.Ya(c||""),d&&(b.S.U().innerHTML=d),b.h().e(b.S,"afterhide",function(){this.Df()}))},a.lw=function(b,c,d){var e=J("zh-fav-list-item-place-holder");e&&R(e,m);b.Iy=c[5]?"":L("span","zm-fav-list-item-lock",[L("i","icon icon-lock")]);e=L("span","zm-favo-list-item-title");wc(e,c[1]);e=L("a",{"class":"zg-r5px zm-favo-list-item-link",href:"javascript:;"},[b.Iy,e,L("span",{className:"meta zg-gray",innerHTML:'<span class="num">'+c[3]+'</span> 条答案 <span class="zg-bull">•</span> '+
c[4]+" 人关注"})]);b.Iy&&b.Iy.setAttribute("data-tip","s$t$私密收藏夹");e.setAttribute("data-lid",c[0]);z.contains(b.fs,c[0])&&F.add(e,"zm-favo-list-item-link-active");c=K("zm-favo-list-item-link",b.Jg);d&&c?ic(e,c):b.Jg.appendChild(e)};
t.gb=function(){this.h().e(this.Fz,"click",function(){this.oa?nw(this,0):ow(this)}).e(this.kS,"click",function(){Y.ia({type:"ga_click_add_collection"});nw(this,1)}).e(this.Tu,"click",function(){ow(this)}).e(this.lS,"click",function(){Y.ia({type:"ga_click_add_collection"});nw(this,1)}).e(this.gK,"click",function(){ow(this)}).e(this.rq,"click",function(){ow(this)}).e(this.OA,"click",this.Ng).e(this.Jg,"click",this.OP).e(this.xj,"change",function(){R(this.Sz,m)})};
t.OP=function(b){var c=Hc(b.target,"A");if(c&&!this.locked){var b=c.getAttribute("data-lid"),d=m;F.has(c,"zm-favo-list-item-link-active")?(d=j,this.YB=b):this.UB=b;c=new Dk;c.add("answer_id",this.oa);c.add("favlist_id",b);this.dz=new V(j);this.locked=j;me(this.h(),this.dz,"complete",this.fJ);this.dz.ajax(d?"/collection/remove":"/collection/add",c.fd())}};
t.fJ=function(){this.locked=m;this.Tu.innerHTML="关闭";var b=He(this.dz);b&&!b.r?(b=Ub("zm-favo-list-item-link",this.Jg),z.forEach(b,function(b){var d=b.getAttribute("data-lid"),e=K("num",b),g=parseInt(e.innerHTML,10);d===this.YB?(e.innerHTML=g-1+"",F.remove(b,"zm-favo-list-item-link-active")):d===this.UB&&(e.innerHTML=g+1+"",F.add(b,"zm-favo-list-item-link-active"))},this),this.UB=this.YB=k,Gk("Favorite","add_favorite")):U("添加失败: "+b.msg)};
a.pw=function(b,c){if(b.oa!==c&&b.Jg){var d=Ub("zm-favo-list-item-link",b.Jg);z.forEach(d,function(b){F.remove(b,"zm-favo-list-item-link-active")},b)}b.oa=c};t.Gj=function(){this.gb();this.Tu.innerHTML="关闭";this.oa?(R(this.rq,m),nw(this,0)):(nw(this,1),R(this.Fz,m),this.rq.innerHTML="取消")};t.show=function(b){b?(qw(this),this.S.D(j),this.Gj()):(mw(this,"添加到收藏夹",'<div style="text-align: center; color: #999;">收藏夹加载中<i class="spinner-gray"></i></div>'),this.S.D(j),this.gr())};
a.sw=function(b,c,d,e){var g=J("zh-fav-head-title"),h=J("zh-fav-head-description-source"),c=c||(g?Ec(g):""),d=d||(h?Ec(h):"");b.XB=e||hh;qw(b);b.bF=j;b.gb();nw(b,1);R(b.Fz,m);b.rq.innerHTML="取消";b.OA.innerHTML="保存";b.S.Ya("编辑收藏夹");b.xj.value=Za(c);b.Al.value=Za(d);b.XB[1]?(R(b.MQ,m),R(b.JQ,m),R(b.kO,m)):b.$N.setAttribute("checked",j);b.CN=rw(b);b.S.D(j);b.Ur=j};t.gr=function(){this.oa&&!this.bF&&$.get("/collections/json",{answer_id:this.oa}).done(v(this.EP,this))};
a.qw=function(b){if(b.UK){var c=Ub("zm-favo-list-item-link",b.Jg);z.forEach(c,function(b){var c=b.getAttribute("data-lid");F.remove(b,"zm-favo-list-item-link-active");z.contains(this.fs,+c)&&F.add(b,"zm-favo-list-item-link-active")},b)}else b.v()};t.EP=function(b){b&&!b.r&&(this.Ex=b.msg[0],this.fs=b.msg[1],qw(this),this.bF=j,this.Gj())};
a.nw=function(b,c){var d=!!c;b.S.Ya(0===c?"添加到收藏夹":"创建新收藏夹");R(b.wj,!d);R(b.Yv,d);new Zk(b.xj,b.Tz);new Zk(b.Al,b.ov);if(1===c)$(b.Yv).on("change.FavoDiag","input, textarea, select",function(){b.Ve()});else $(b.Yv).off("change.FavoDiag"),b.Df()},a.rw=function(b){var c=new Dk,d=rk(b.xj.value),e=Va(b.Al.value===b.ov?"":b.Al.value);e||(e=-1);c.add("title",d);c.add("description",e);c.add("is_public",b.aO.checked?1:0);return c};
t.Ng=function(){var b=rk(this.xj.value);if(!b||b===this.Tz)R(this.Sz,j);else{b=rw(this);this.oa&&b.add("answer_id",this.oa);if(this.Ur){if(this.CN.fd()===b.fd()){ow(this);return}b.add("favlist_id",this.XB[0])}this.xhr=new V(j);me(this.h(),this.xhr,"complete",this.XI);this.xhr.ajax(this.Ur?"/collection/update":"/collection/create",b.fd())}};
t.XI=function(){var b=He(this.xhr);b&&!b.r?this.Ur?(ow(this),U("编辑成功"),setTimeout(function(){window.location.reload()},1E3),this.Ur=m):this.oa?(R(this.iu,m),R(this.QA,j),nw(this,0),this.fs.push(b.msg[0]),lw(this,b.msg,j),this.xj.value="",this.Al.value=""):(ow(this),U("创建成功"),setTimeout(function(){window.location.href="/collections/mine"},1E3)):U(b.msg)};t.P=function(){return this.S.P()};
a.ow=function(b){b.S.D(m);b.dispatchEvent(tw);Y.ia({type:"ga_click_collect_answer",data:{count:$(".zm-favo-list-item-link-active",b.Jg).length}})},a.tw="close";kw.prototype.Ve=function(){$(window).on("beforeunload.FavoDiag",v(s("你对收藏夹的修改还未保存，确认离开该页面吗？"),this))};kw.prototype.Df=function(){$(window).off("beforeunload.FavoDiag")};a.uw=function(b){var c=b.type;if(!ka(c))return k;switch(c.toLowerCase()){case "checkbox":case "radio":return b.checked?b.value:k;case "select-one":return c=b.selectedIndex,0<=c?b.options[c].value:k;case "select-multiple":for(var c=[],d,e=0;d=b.options[e];e++)d.selected&&c.push(d.value);return c.length?c:k;default:return ka(b.value)?b.value:k}},a.vw=function(b,c){var d=b.elements[c];if(d.type)return uw(d);for(var e=0;e<d.length;e++){var g=uw(d[e]);if(g)return g}return k};a.ww=function(b){N.call(this);this.g=b;b=ra(this.g)&&1==this.g.nodeType?this.g:this.g?this.g.body:k;this.cO=!!b&&dg(b);this.HE=O(this.g,B?"DOMMouseScroll":"mousewheel",this)};y(ww,Fd);
ww.prototype.handleEvent=function(b){var c=0,d=0,e=0,b=b.Ub;if("mousewheel"==b.type){d=1;if(A||C&&(lb||D("532.0")))d=40;e=xw(-b.wheelDelta,d);ka(b.wheelDeltaX)?(c=xw(-b.wheelDeltaX,d),d=xw(-b.wheelDeltaY,d)):d=e}else e=b.detail,100<e?e=3:-100>e&&(e=-3),ka(b.axis)&&b.axis===b.HORIZONTAL_AXIS?c=e:d=e;pa(this.WE)&&(c=nt(c,-this.WE,this.WE));pa(this.XE)&&(d=nt(d,-this.XE,this.XE));this.cO&&(c=-c);c=new yw(e,b,c,d);this.dispatchEvent(c)};a.xw=function(b,c){return C&&(kb||mb)&&0!=b%c?b:b/c};
ww.prototype.w=function(){ww.n.w.call(this);yd(this.HE);delete this.HE};a.yw=function(b,c,d,e){c&&this.z(c,i);this.type="mousewheel";this.detail=b;this.Mi=d;this.Ni=e};y(yw,jd);a.zw=function(){N.call(this)};y(zw,Fd);t=zw.prototype;t.Zd=0;t.bo=0;t.Zn=100;t.Yk=0;t.Zj=1;t.lE=m;t.rs=m;t.Aa=function(b){b=Aw(this,b);this.Zd!=b&&(this.Zd=b+this.Yk>this.Zn?this.Zn-this.Yk:b<this.bo?this.bo:b,!this.lE&&!this.rs&&this.dispatchEvent("change"))};t.W=function(){return Aw(this,this.Zd)};t.Ko=function(b){b=Aw(this,b);this.Yk!=b&&(this.Yk=0>b?0:this.Zd+b>this.Zn?this.Zn-this.Zd:b,!this.lE&&!this.rs&&this.dispatchEvent("change"))};
t.Dh=function(){return this.Zj==k?this.Yk:Math.round(this.Yk/this.Zj)*this.Zj};t.Ec=function(){return Aw(this,this.bo)};t.Pc=function(){return Aw(this,this.Zn)};t.ow=p("Zj");a.Aw=function(b,c){return b.Zj==k?c:b.bo+Math.round((c-b.bo)/b.Zj)*b.Zj};a.Bw=function(b){T.call(this,b);this.SA=k;this.Qa=new zw;O(this.Qa,"change",this.wD,m,this)};y(Bw,T);a.Cw=Ed("dragvaluestart"),a.Dw=Ed("dragvalueend"),a.Ew=Ed("dragextentstart"),a.Fw=Ed("dragextentend"),a.Gw=Ed("dragstart"),a.Hw=Ed("dragend");t=Bw.prototype;t.vb="horizontal";t.Rr=m;t.MO=m;t.zf=10;t.ao=0;t.pE=j;t.dc=j;t.Ld=m;t.v=function(){Bw.n.v.call(this);var b=this.J().v("div",this.L(this.vb));this.$(b)};
t.$=function(b){Bw.n.$.call(this,b);F.add(b,this.L(this.vb));var b=this.m(),c=Tb(k,"goog-slider-thumb",b)[0];c||(c=this.J().v("div","goog-slider-thumb"),Lc(c,Uc.Fp),b.appendChild(c));this.Ta=this.td=c;Lc(this.m(),Uc.DI);Iw(this)};t.B=function(){Bw.n.B.call(this);this.Yd=new uh(this.Ta);this.Jf=new uh(this.td);this.Yd.Ff(this.Ld);this.Jf.Ff(this.Ld);this.Yd.lv=this.Jf.lv=ha;this.lb=new Wm(this.m());Jw(this,j);this.m().tabIndex=0;Kw(this)};
a.Jw=function(b,c){c?(b.h().e(b.Yd,"beforedrag",b.ir).e(b.Jf,"beforedrag",b.ir).e(b.Yd,["start","end"],b.tr).e(b.Jf,["start","end"],b.tr).e(b.lb,"key",b.af).e(b.m(),"mousedown",b.dj),b.pE&&Lw(b,j)):(b.h().Ea(b.Yd,"beforedrag",b.ir).Ea(b.Jf,"beforedrag",b.ir).Ea(b.Yd,["start","end"],b.tr).Ea(b.Jf,["start","end"],b.tr).Ea(b.lb,"key",b.af).Ea(b.m(),"mousedown",b.dj),b.pE&&Lw(b,m))};t.ib=function(){Bw.n.ib.call(this);Rc(this.Yd,this.Jf,this.lb,this.Cj)};
t.ir=function(b){var c=b.Mq==this.Yd?this.Ta:this.td,d;"vertical"==this.vb?(d=this.m().clientHeight-c.offsetHeight,d=(d-b.top)/d*(this.Pc()-this.Ec())+this.Ec()):d=b.left/(this.m().clientWidth-c.offsetWidth)*(this.Pc()-this.Ec())+this.Ec();d=b.Mq==this.Yd?Math.min(Math.max(d,this.Ec()),this.W()+this.Dh()):Math.min(Math.max(d,this.W()),this.Pc());Mw(this,c,d)};
t.tr=function(b){var c="start"==b.type;F.enable(this.m(),"goog-slider-dragging",c);F.enable(b.target.handle,"goog-slider-thumb-dragging",c);b=b.Mq==this.Yd;c?(this.dispatchEvent(Gw),this.dispatchEvent(b?Cw:Ew)):(this.dispatchEvent(Hw),this.dispatchEvent(b?Dw:Fw))};
t.af=function(b){var c=j;switch(b.keyCode){case 36:Nw(this,this.Ec());break;case 35:Nw(this,this.Pc());break;case 33:Ow(this,this.zf);break;case 34:Ow(this,-this.zf);break;case 37:var d=this.Ld&&this.wd()?1:-1;Ow(this,b.shiftKey?d*this.zf:d*this.mp);break;case 40:Ow(this,b.shiftKey?-this.zf:-this.mp);break;case 39:d=this.Ld&&this.wd()?-1:1;Ow(this,b.shiftKey?d*this.zf:d*this.mp);break;case 38:Ow(this,b.shiftKey?this.zf:this.mp);break;default:c=m}c&&b.preventDefault()};
t.dj=function(b){this.m().focus&&this.m().focus();var c=b.target;!rc(this.Ta,c)&&!rc(this.td,c)&&(this.MO?Nw(this,Pw(this,b)):(this.Iz(b),this.Je=Qw(this,Pw(this,b)),this.XD="vertical"==this.vb?this.$r<this.Je.offsetTop:this.$r>Rw(this,this.Je)+this.Je.offsetWidth,b=Qb(this.m()),this.h().e(b,"mouseup",this.Gz,j).e(this.m(),"mousemove",this.Iz),this.Jh||(this.Jh=new Hd(200),this.h().e(this.Jh,Id,this.CD)),this.CD(),this.Jh.start()))};t.rD=function(b){Ow(this,(0<b.detail?-1:1)*this.mp);b.preventDefault()};
t.CD=function(){var b;if("vertical"==this.vb){var c=this.$r,d=this.Je.offsetTop;this.XD?c<d&&(b=Sw(this,this.Je)+this.zf):c>d+this.Je.offsetHeight&&(b=Sw(this,this.Je)-this.zf)}else c=this.$r,d=Rw(this,this.Je),this.XD?c>d+this.Je.offsetWidth&&(b=Sw(this,this.Je)+this.zf):c<d&&(b=Sw(this,this.Je)-this.zf);ka(b)&&Mw(this,this.Je,b)};t.Gz=function(){this.Jh&&this.Jh.stop();var b=Qb(this.m());this.h().Ea(b,"mouseup",this.Gz,j).Ea(this.m(),"mousemove",this.Iz)};
a.Tw=function(b,c){var d=ig(c,b.m());return"vertical"==b.vb?d.y:b.Ld&&b.wd()?b.m().clientWidth-d.x:d.x};t.Iz=function(b){this.$r=Tw(this,b)};
a.Pw=function(b,c){var d=b.Ec(),e=b.Pc();if("vertical"==b.vb){var g=b.Ta.offsetHeight,h=b.m().clientHeight-g,g=Tw(b,c)-g/2;return(e-d)*(h-g)/h+d}g=b.Ta.offsetWidth;h=b.m().clientWidth-g;g=Tw(b,c)-g/2;return(e-d)*g/h+d},a.Sw=function(b,c){if(c==b.Ta)return b.Qa.W();if(c==b.td)return b.Qa.W()+b.Qa.Dh();f(Error("Illegal thumb element. Neither minThumb nor maxThumb"))},a.Ow=function(b,c){var d=Sw(b,b.Ta)+c,e=Sw(b,b.td)+c,d=nt(d,b.Ec(),b.Pc()-b.ao),e=nt(e,b.Ec()+b.ao,b.Pc());Uw(b,d,e-d)},a.Mw=function(b,
c,d){var e=k;c==b.td&&(d<=b.Qa.Pc()&&d>=b.Qa.W()+b.ao)&&(e=d-b.Qa.W());var g=e||b.Qa.Dh();c==b.Ta&&(d>=b.Ec()&&d<=b.Qa.W()+g-b.ao)&&(c=g-(d-b.Qa.W()),Aw(b.Qa,d)+Aw(b.Qa,c)==Aw(b.Qa,d+c)&&(Uw(b,d,c),e=k));e!=k&&b.Qa.Ko(e)},a.Uw=function(b,c,d){b.Ec()<=c&&(c<=b.Pc()-d&&b.ao<=d&&d<=b.Pc()-c)&&!(c==b.W()&&d==b.Dh())&&(b.Qa.rs=j,b.Qa.Ko(0),b.Qa.Aa(c),b.Qa.Ko(d),b.Qa.rs=m,b.wD())};t.Ec=function(){return this.Qa.Ec()};t.Pc=function(){return this.Qa.Pc()};
a.Qw=function(b,c){return c<=b.Qa.W()+b.Qa.Dh()/2?b.Ta:b.td};t.wD=function(){Kw(this);Iw(this);this.dispatchEvent("change")};
a.Kw=function(b){if(b.Ta&&!b.Rr){var c=Vw(b,Sw(b,b.Ta)),d=Vw(b,Sw(b,b.td));if("vertical"==b.vb)b.Ta.style.top=c.y+"px",b.td.style.top=d.y+"px",b.Kb&&(c=Ww(d.y,c.y,b.Ta.offsetHeight),b.Kb.style.top=c.offset+"px",b.Kb.style.height=c.size+"px");else{var e=b.Ld&&b.wd()?"right":"left";b.Ta.style[e]=c.x+"px";b.td.style[e]=d.x+"px";b.Kb&&(c=Ww(c.x,d.x,b.Ta.offsetWidth),b.Kb.style[e]=c.offset+"px",b.Kb.style.width=c.size+"px")}}},a.Ww=function(b,c,d){var e=Math.ceil(d/2);return{offset:b+e,size:Math.max(c-
b+d-2*e,0)}},a.Vw=function(b,c){var d=new Lb;if(b.Ta){var e=b.Ec(),g=b.Pc(),g=c==e&&e==g?0:(c-e)/(g-e);"vertical"==b.vb?(e=b.m().clientHeight-b.Ta.offsetHeight,g=Math.round(g*e),d.x=Rw(b,b.Ta),d.y=e-g):(e=Math.round(g*(b.m().clientWidth-b.Ta.offsetWidth)),d.x=e,d.y=b.Ta.offsetTop)}return d},a.Nw=function(b,c){c=nt(c,b.Ec(),b.Pc());b.Rr&&b.Bq.stop(j);var d=new Ql,e,g=Qw(b,c),h=b.W(),l=b.Dh(),n=Sw(b,g),q=Vw(b,n);e=b.ow();Math.abs(c-n)<e&&(c=nt(n+(c>n?e:-e),b.Ec(),b.Pc()));Mw(b,g,c);n=Vw(b,Sw(b,g));
e="vertical"==b.vb?[Rw(b,g),n.y]:[n.x,g.offsetTop];q=new gt(g,[q.x,q.y],e,100);q.Ff(b.Ld);d.add(q);if(b.Kb){var q=Vw(b,h),r=Vw(b,h+l),l=q;e=r;g==b.Ta?l=n:e=n;"vertical"==b.vb?(g=Ww(r.y,q.y,b.Ta.offsetHeight),l=Ww(e.y,l.y,b.Ta.offsetHeight),n=new gt(b.Kb,[Rw(b,b.Kb),g.offset],[Rw(b,b.Kb),l.offset],100),g=new et(b.Kb,g.size,l.size,100)):(g=Ww(q.x,r.x,b.Ta.offsetWidth),l=Ww(l.x,e.x,b.Ta.offsetWidth),n=new gt(b.Kb,[g.offset,b.Kb.offsetTop],[l.offset,b.Kb.offsetTop],100),g=new ft(b.Kb,g.size,l.size,100));
n.Ff(b.Ld);g.Ff(b.Ld);d.add(n);d.add(g)}b.SA&&(h=b.SA.hW(h,c,100),z.forEach(h,function(b){d.add(b)}));b.Bq=d;b.h().e(d,"end",b.cL);b.Rr=j;d.play(m)};t.cL=function(){this.Rr=m};t.No=function(b){if(this.vb!=b){var c=this.L(this.vb),d=this.L(b);this.vb=b;this.m()&&(F.gH(this.m(),c,d),b=this.Ld&&this.wd()?"right":"left",this.Ta.style[b]=this.Ta.style.top="",this.td.style[b]=this.td.style.top="",this.Kb&&(this.Kb.style[b]=this.Kb.style.top="",this.Kb.style.width=this.Kb.style.height=""),Kw(this))}};
t.w=function(){Bw.n.w.call(this);this.Jh&&this.Jh.G();delete this.Jh;this.Bq&&this.Bq.G();delete this.Bq;delete this.Ta;delete this.td;this.Kb&&delete this.Kb;this.Qa.G();delete this.Qa;this.lb&&(this.lb.G(),delete this.lb);this.Cj&&(this.Cj.G(),delete this.Cj);this.Yd&&(this.Yd.G(),delete this.Yd);this.Jf&&(this.Jf.G(),delete this.Jf)};t.mp=1;t.ow=function(){return this.Qa.ow()};t.W=function(){return this.Qa.W()};t.Aa=function(b){Mw(this,this.Ta,b)};t.Dh=function(){return this.Qa.Dh()};
t.Ko=function(b){Mw(this,this.td,this.Qa.W()+b)};t.D=function(b){R(this.m(),b);b&&Kw(this)};a.Iw=function(b){var c=b.m();if(c){var d=b.Ec();Mc(c,Tc.LI,d);d=b.Pc();Mc(c,Tc.KI,d);b=b.W();Mc(c,Tc.MI,b)}},a.Lw=function(b,c){c?(b.Cj||(b.Cj=new ww(b.m())),b.h().e(b.Cj,"mousewheel",b.rD)):b.h().Ea(b.Cj,"mousewheel",b.rD)};t.Xa=function(b){if(this.dc!=b&&this.dispatchEvent(b?"enable":"disable"))this.dc=b,Jw(this,b),b||this.Gz(),F.enable(this.m(),"goog-slider-disabled",!b)};t.isEnabled=p("dc");
a.Rw=function(b,c){return b.Ld?th(c):c.offsetLeft};a.Xw=function(b){Bw.call(this,b);this.Qa.Ko(0)};y(Xw,Bw);Xw.prototype.L=function(b){return"vertical"==b?"goog-slider-vertical":"goog-slider-horizontal"};a.Yw=function(b){this.options=$.extend({},this.defaults,b)};y(Yw,T);t=Yw.prototype;t.defaults={JB:310,KB:310,gg:250,hg:250,DO:2,opacity:0.25,XX:"#eee"};t.$=function(b){Yw.n.$.call(this,b);this.src=this.g.src;this.options.src=this.src;this.options.sm=(this.options.JB-this.options.gg)/2;this.options.rm=(this.options.KB-this.options.hg)/2;this.yq()};
t.yq=function(){var b=this.options;this.mA=$(Ik('            <div class="avatar-editor-container" style="width:<%=containerWidth%>px">              <div class="avatar-editor-container-inner" style="height:<%=containerHeight%>px;">                <div class="avatar-editor-window" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;margin:<%=windowMarginTop%>px <%=windowMarginLeft%>px;">                  <div class="avatar-editor-window-shadow" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;"></div>                  <div class="avatar-editor-window-inner" style="width:<%=containerWidth%>px; height:<%=containerHeight%>px;margin:-<%=windowMarginTop%>px 0 0 -<%=windowMarginLeft%>px;">                    <img class="inner" title="拖动相片"/>                  </div>                </div>                <img class="outer" style="opacity:<%=opacity%>;"/>              </div>              <div class="goog-slider-wrap">                  <i class="zg-icon image-minus"></i>                  <i class="zg-icon image-plus"></i>                  <div class="goog-slider">                      <div class="line"></div>                      <div class="goog-slider-thumb"></div>                  </div>              </div>            </div>',{containerWidth:b.KB,
containerHeight:b.JB,windowHeight:b.gg,windowWidth:b.hg,windowMarginTop:b.sm,windowMarginLeft:b.rm,src:b.src,opacity:b.opacity}));this.Tb=this.mA[0];this.mA.insertBefore(this.g);R(this.g,m);this.tK=K("avatar-editor-container-inner",this.Tb);this.Er=K("outer",this.Tb);this.Uw=K("inner",this.Tb);this.tm=$(this.Er);this.Vt=$(this.Uw);this.VD=0;this.tm.load(v(this.zH,this));this.Vt.load(v(this.zH,this));this.Uw.src=this.Er.src=this.options.src;this.eS=K("goog-slider",this.Tb)};
t.B=function(){this.Az=new Xw;this.Az.o(this.eS);this.h().e(this.tK,["mousedown","touchstart"],function(b){var c=new uh(this.Tb);c.addEventListener("drag",v(function(b){var c=this.zoom;this.Ae={xp:this.options.hg/c,rn:this.options.gg/c,x:(this.options.rm-(this.bE.left+(b.clientX-this.qt)))/c,y:(this.options.sm-(this.bE.top+(b.clientY-this.rt)))/c};Zw(this)},this));c.addEventListener("end",v(function(){c.G()},this));c.om(b);this.om(b)});this.h().e(this.Tb,["touchmove"],function(b){b.stopPropagation();
b.preventDefault()});this.h().e(this.Az,"change",function(){var b=this.Az.W(),c=this.$H;$w(this,(this.pT-c)*b/100+c)})};a.$w=function(b,c){b.bX=b.zoom;b.zoom=c;ax(b,b.Ae.xp/2+b.Ae.x,b.Ae.rn/2+b.Ae.y)},a.ax=function(b,c,d){var e=b.zoom;b.Ae={xp:b.options.hg/e,rn:b.options.gg/e,x:c-b.options.hg/e/2,y:d-b.options.gg/e/2};Zw(b)};t.zH=function(){this.BN||(this.Uw.complete&&this.Er.complete?this.z():(this.VD++,2<=this.VD&&this.z()))};
t.z=function(){this.Dr=this.tm.width();this.Cr=this.tm.height();var b=this.options.hg/this.Dr,c=this.options.gg/this.Cr;this.$H=b=c>b?c:b;this.pT=this.$H*this.options.DO;this.Ae={rn:this.options.hg/b,xp:this.options.gg/b,x:0,y:0};$w(this,b);ax(this,this.Dr/2,this.Cr/2);this.BN=j};t.om=function(b){this.qt=b.clientX;this.rt=b.clientY;this.bE=this.Vt.position();this.vX=this.tm.position()};
a.Zw=function(b){var c=b.zoom,d=nt(b.options.rm-b.Ae.x*c,b.options.hg+b.options.rm-b.Dr*c,b.options.rm),e=nt(b.options.sm-b.Ae.y*c,b.options.gg+b.options.sm-b.Cr*c,b.options.sm),g={width:c*b.Dr,height:c*b.Cr,left:d,top:e};b.tm.css(g);b.Vt.css(g);b.Ae.x=(b.options.rm-d)/c;b.Ae.y=(b.options.sm-e)/c};t.support=function(){return"getContext"in document.createElement("canvas")};a.cx=function(b,c,d){T.call(this);this.Yp=b||bx;this.BC=c;this.DG=d||"l"};y(cx,T);a.bx=1;t=cx.prototype;t.$=function(b){this.g=b;this.v()};
t.v=function(){this.dA="http://upload."+ah.Yl+"/upload_avatar";this.nk=$(Ik('            <form target="av_up_frame" style="display:none;" method="post" enctype="multipart/form-data" action="<%=uploadAction%>">                <label for="avt_file"></label>                <input type="file" accept="image/*" name="picture" id="avt_file" />                <input type="hidden" name="handle_mode" value="upload" />                <input type="hidden" name="type" value="<%=type%>" />                <input type="hidden" name="dest_id" value="<%=dest_id%>" />                <input type="hidden" name="return_size" value="<%=return_size%>" />            </form>',{uploadAction:this.dA,
type:this.Yp,dest_id:this.Yp===bx?S[3]:this.BC,return_size:this.DG}));this.cI=$('<iframe id="av_up_frame" name="av_up_frame" style="position: absolute; height: 0px; width: 0px; left: -9000px;"></iframe>');this.cI.appendTo(document.body);this.input=this.nk.find("input[type=file]")[0];A?(this.nk.find("label").html($(this.g).html()),this.g.innerHTML="",$(this.g).append(this.nk),this.nk.addClass("avatar-editor-form-ie")):(this.nk.insertAfter(this.g),$(this.g).click($.proxy(function(){this.input.click()},
this)));this.h().e(this.input,"change",this.Sh).e(this.input,"click",function(b){this.dispatchEvent("beforeopen")===m&&b.preventDefault()});this.h().e(Y,"iframe_data",function(b){(b=b.Hc)&&!b.r?"upload"===b.handle_mode?(this.ul=b.url,this.Tw=b.id,dx()||this.ro()):"resize"===b.handle_mode&&($(this.g).find("form").remove(),this.RB(b)):U(b.msg)})};a.dx=function(){return!!window.FileReader};
t.Sh=function(b){this.ul=this.Tw=this.jj="";if(this.va)this.va.fa();else{this.va=new vi(k,m);this.va.Ya("修改图片");var c=ii.hI,d=ii.NI,e=new ai;e.set(c,"取消",m,j).set(d,"确定",j);ei(this.va,e);this.h().e(this.va,fi,function(b){if(b.key===d){if(dx()){var c=this.dv,b=$("<canvas></canvas>");b.attr("width",c.options.hg);b.attr("height",c.options.gg);var e=b[0];$(document.body).append(e);var n=b[0].getContext("2d"),q=c.Ae;n.drawImage(c.Er,q.x,q.y,q.xp,q.rn,0,0,c.options.hg,c.options.gg);c=e.toDataURL("image/png");
b.remove();b=c}else b=this.dv.Ae;if((this.jj=b)&&(dx()||this.Tw))if(this.dispatchEvent("beforepost"),b={type:this.Yp,dest_id:this.Yp===bx?S[3]:this.BC,return_size:this.DG},dx()){var r=new FormData;r.append("handle_mode","upload");r.append("picture",ex(this.jj.replace(/data\:image\/\w{3,4};base64,/,"")),this.file.name);$.each(b,function(b,c){r.append(b,c)});$.ajax({url:this.dA,data:r,method:"post",processData:m,contentType:m,success:$.proxy(this.RB,this),dataType:"json",xhrFields:{withCredentials:j},
crossDomain:j})}else{var b=$.extend(b,{handle_mode:"resize",x:Math.round(this.jj.x),y:Math.round(this.jj.y),height:Math.round(this.jj.rn),width:Math.round(this.jj.xp),hashval:this.Tw}),w='<form target="av_up_frame" style="display:none;" method="post" action="'+this.dA+'">';$.each(b,function(b,c){w+='<input type="hidden" name="'+b+'" value="'+c+'" />'});w+="</form>";b=$(w);b.appendTo(this.g);b[0].submit()}this.va.D(m);return m}})}e=this.va.U();c=$("<div class='new-avatar-editor-loading'><div><span></span></div><div>正在上传...</div></div>");
e=$(e);e.html("");e.append(c);this.va.D(j);F.add(this.va.g,"avatar-edit-dialog");b=this.input=b.target;dx()?b.files&&b.files[0]&&(this.file=b=b.files[0],c=new window.FileReader,c.onload=v(function(b){this.ul=b.target.result;this.ro()},this),c.readAsDataURL(b)):this.nk[0].submit();b=this.input.cloneNode();lc(b,this.input);this.input=b;this.h().e(this.input,"change",this.Sh)};t.ro=function(){var b=this.va.U();this.Sw=new Image;this.Sw.src=this.ul;b=$(b);b.html("");b.append(this.Sw);this.dv=new Yw;this.dv.o(this.Sw)};
t.RB=function(b){b&&!b.r?this.data=b:U(b.msg);this.dispatchEvent({type:"success",src:this.data});this.va.D(m)};t.getData=function(){return this.data||k};a.ex=function(b){var c,d;d="image/png";c=c||512;for(var b=atob(b),e=[],g=0;g<b.length;g+=c){for(var h=b.slice(g,g+c),l=Array(h.length),n=0;n<h.length;n++)l[n]=h.charCodeAt(n);h=new Uint8Array(l);e.push(h)}return new Blob(e,{type:d})};a.fx=function(){T.call(this)};y(fx,T);fx.prototype.$=function(b){fx.n.$.call(this,b);this.h().e(Y,"sina_callback",this.xs);this.h().e(Y,"qqconn_callback",this.xs);this.h().e(J("zh-setting-page-bind-sina-unbindbtn"),"click",this.PF);this.h().e(J("zh-setting-page-bind-qqconn-unbindbtn"),"click",this.PF)};
fx.prototype.xs=function(b){if("sina_callback"===b.type){var c=oh.name=b.Hc.name,b=oh.id=b.Hc.id;J("zh-setting-page-bind-sinaname").innerHTML='<a href="http://weibo.com/'+b+'" target="_blank">@'+c+"</a>";gx(j)}else"qqconn_callback"===b.type&&(J("zh-setting-page-bind-qqconnname").innerHTML=b.Hc.name,hx(j))};
fx.prototype.PF=function(b){var c=b.target.getAttribute("data-weibotype");if(window.confirm("你确定要解除与"+{sina:"新浪微博",qqconn:" QQ "}[c]+"的绑定吗？")){var d=new V(j);me(this.h(),d,"success",function(){var b=He(d);b&&!b.r?"sina"===c?gx():"qqconn"===c&&hx():U(b.msg)});d.ajax("/oauth/unbind/"+c)}};
a.gx=function(b){R(J("zh-setting-page-bind-sina-binded-wrap"),!!b);R(J("zh-setting-page-bind-sina-tobind-wrap"),!b)},a.hx=function(b){R(J("zh-setting-page-bind-qqconn-binded-wrap"),!!b);R(J("zh-setting-page-bind-qqconn-tobind-wrap"),!b)};a.ix=function(b){T.call(this);this.xQ=b};y(ix,T);t=ix.prototype;t.$=function(b){ix.n.$.call(this,b);this.ce=$("input",b);this.pd=$(".zm-profile-details-items",this.g);this.Jp=[];var c=this;c.Jp=this.ce.map(function(){var b=new jx("/topic/autocomplete",this,c.xQ||$(this).parents(".topic-input-wrap")[0]);b.Bm=m;var e=v(c.filter,c);b.filter=e;return b});this.Xl()};
t.B=function(){this.h().e(K("add",this.g),"click",this.add);var b=this;this.ce.each(function(){b.h().e(this,"keydown",function(b){this.keydown(b)})});z.forEach(this.Jp,function(c){b.h().e(c.M,Jm,b.select)});this.pd.on("click","[name='del']",$.proxy(this.remove,this));this.Xl()};t.Xl=function(){if(!ah.uc){var b=this;this.Ef&&this.Ef.G();var c=new ns;c.Nq="profile-edit-item-moving";os(c,this.pd[0],0);c.z();this.Ef=c;$('a, input, [role="button"]',this.pd).each(function(){b.h().e(this,"mousedown",function(b){b.stopPropagation()})})}};
t.keydown=function(b){13===b.keyCode&&setTimeout(v(function(){kx(this)&&this.add();this.ce[0].value&&(this.ce[1]&&!this.ce[1].value)&&this.ce[1].focus()},this));return j};a.kx=function(b){return z.every(b.ce,function(b){return!!b.value})},a.lx=function(b){z.forEach(b.ce,function(b){b.value=""});b.ce[0].focus()};t.select=function(){kx(this)&&this.add()};
t.add=function(){var b=La(this.ce[0].value),c={title:b,member_url_token:gh["1"]};if(this.ce[1]){var d=La(this.ce[1].value);if(!b&&!d)return;c.sub_title=d}vs("ProfileEditItemV2",c,this.XO,this)};t.XO=function(b){var b=$(b),c;if(b.data("title")){if(c=this.pd.find("[data-title='"+b.data("title")+"']")[0]){wk(c);lx(this);return}}else if(b.data("sub-title")&&(c=this.pd.find("[data-sub-title='"+b.data("sub-title")+"']")[0])){wk(c);lx(this);return}this.pd.append(b);this.Xl();lx(this);this.dispatchEvent("add")};
t.remove=function(b){$(b.target).parents("li").remove();this.dispatchEvent("remove")};ix.prototype.filter=function(b){return z.filter(b,function(b){return!this.pd.find("[data-title='"+b+"']")[0]},this)};a.jx=function(b,c,d,e,g){this.gf=b=new sn(b,!g);d=new mn(d);e=new bn(k,k,!!e,300);Mm.call(this,b,d,e);e.Y=this;e.yk(c);(e=c.getAttribute("placeholder"))&&new Zk(c,e)};y(jx,tn);
jx.prototype.Wl=function(b,c){b=b[0].slice(1);b=z.filter(b,function(b){return 3<b.length});b=z.map(b,function(b){return b[1]});this.filter&&(b=this.filter(b));jx.n.Wl.call(this,b,c)};a.mx=function(){T.call(this)};y(mx,T);t=mx.prototype;
t.$=function(b){mx.n.$.call(this,b);if(b=K("profile-edit-avatar-btn")){var c=this.wu=new cx(bx);c.o(b);this.h().e(this.wu,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.h().e(this.wu,"success",function(){$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:c.getData().id}}},function(b){b&&b.r?($(".avatar-edit-preview-loading").remove(),U("更新失败")):($(".avatar-edit-preview-loading").remove(),
$("img.zm-avatar-editor-preview").attr("src",c.getData().url))})})}this.T=[];var d=this;$(".editable-group",this.g).each(function(){var b=new ix;d.T.push(b);b.o(this)});b=J("zm-profile-edit-submit");this.h().e(b,"click",this.my);(new fx).o(this.g);$(this.g).on("change","input, textarea, select",function(){d.Ve()})};
t.B=function(){mx.n.B.call(this);var b=J("zm-profile-progress-anim"),c=new nx;c.addEventListener("update",function(){var d=100*c.W()|0;10>d&&(d=10);b.style.width=b.innerHTML=d+"%"});z.forEach(this.T,function(b,d){c.watch({name:"name"+d,target:b,zh:["add","remove"],qh:function(){return!!b.pd.children().length}})},this);var d=this.g,e=J("zm-profile-edit-male"),g=J("zm-profile-edit-female"),h=J("zm-profile-edit-description"),l=$(".business-selection select")[0],n=J("zm-profile-edit-expert-disable");
c.watch({name:"expert_progress",target:J("zm-profile-edit-expert-enable"),zh:["change"],qh:function(){return k!==vw(d,"enable_expert")}}).watch({name:"expert_progress",target:n,zh:["change"],qh:function(){return k!==vw(d,"enable_expert")}}).watch({name:"gender_progress",target:e,zh:["change"],qh:function(){return k!==vw(d,"gender")}}).watch({name:"gender_progress",target:g,zh:["change"],qh:function(){return k!==vw(d,"gender")}}).watch({name:"desc_progress",target:h,zh:["blur"],qh:function(){return!!La(h.value)}}).watch({name:"business_progress",
target:h,zh:["blur"],qh:function(){return!!La(h.value)}}).watch({name:"headline_progress",target:l,zh:["blur"],qh:function(){return!!La(l.value)}})};t.Ve=function(){$(window).on("beforeunload.profileedit",v(s("你的更改还未保存，确认离开该页面吗？"),this))};t.Df=function(){$(window).off("beforeunload.profileedit")};
t.my=function(){function b(b){U(ma(b)?b[0][1]:b)}var c=$("#zm-profile-edit-male").is(":checked")?1:0,d=$("#zm-profile-edit-headline").val(),e=$("#zm-profile-edit-description").val(),g=$(".business-selection select").val(),h=[];$("#zm-profile-edit-loc-container").children().each(function(){h.push($(this).data("title"))});var l=[];$("#zm-profile-edit-co-container").children().each(function(){var b=$(this);l.push([b.data("title"),b.data("sub-title")||""])});var n=[];$("#zm-profile-edit-edu-container").children().each(function(){var b=
$(this);n.push([b.data("title"),b.data("sub-title")||""])});var q=$("#zm-profile-edit-weibo-enable").is(":checked")?1:0,r=$("#zm-profile-edit-expert-enable").is(":checked")?1:0,c=G.filter({gender:c,headline:d,description:e,location:h,business:g,employment:l,education:n,enable_weibo:q,enable_expert:r},Sr),w=v(function(){this.Df();window.location.href="/people/"+S[1]+"/about"},this),d=new V(j);d.addEventListener("complete",function(){var c;try{c=He(this)}catch(d){}c&&!c.r&&qa(w)?w.call(this,c):qa(b)&&
b.call(this,c.msg)});d.ajax("/people/edit","data="+encodeURIComponent(Yc(c)))};a.nx=function(){this.zy={}};y(nx,Fd);nx.prototype.update=function(b,c){this.zy[b]=c;this.dispatchEvent({type:"update"});return this};nx.prototype.watch=function(b){var c=v(function(){this.update(b.name,b.qh())},this);O(b.target,b.zh,c);c();return this};nx.prototype.W=function(){var b=G.Ma(this.zy);return b.length&&z.filter(b,Boolean).length/b.length};a.ox=function(){this.Si="editing";T.call(this)};y(ox,T);ox.prototype.$=function(b){ox.n.$.call(this,b);this.K=$(b);this.K.on("click",'a[href^="javascript"]',$.proxy(this.ra,this));this.K.on("click",'a[href^="javascript"], input',m);this.K.on("click",".item",$.proxy(this.lQ,this))};a.px=function(b,c,d){if(!ah.uc||navigator.userAgent.match(/iPad/i)!=k)b=$(".item",b.K).index(c),c.siblings().eq(b-b%2).height(d?"auto":c.height())};
ox.prototype.lQ=function(b){var c=$(b.currentTarget),d=c.data("href"),c=d&&!c.hasClass(this.Si),b=b.metaKey||b.ctrlKey;c&&(b?window.open(d):location.href=d)};
ox.prototype.ra=function(b){var c=$(b.currentTarget),d=c.closest(".item"),b=c.attr("name");if("edit"===b)c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.Si).closest(".skilled-topics").addClass(this.Si),px(this,d);else if("cancel"===b)c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.Si).closest(".skilled-topics").removeClass(this.Si),px(this,d,j);else if("save"===b){var e=
new V(j);this.h().e(e,"success",function(){var b=He(e);b.r?U(b.msg):(c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.Si).closest(".skilled-topics").removeClass(this.Si),px(this,d,j))});e.ajax("/topic/bio/update","tid="+c.closest(".item").data("id")+"&bio="+c.parent().siblings("input").val(),"POST")}};a.qx=function(){T.call(this)};y(qx,T);
qx.prototype.$=function(b){qx.n.$.call(this);if(b&&(this.K=$(b),$(".editable-group",this.K).each(function(){(new rx).o(this)}),(b=J("profile-header-description-input"))&&new Tk(b),(b=K("zm-profile-header-avatar-container"))&&F.has(b,"self"))){var c=new cx(bx);c.o(b);this.h().e(c,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.h().e(c,"success",function(){$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:c.getData().id}}},
function(b){b&&b.r?($(".avatar-edit-preview-loading").remove(),U("更新失败")):($(".avatar-edit-preview-loading").remove(),K("zm-avatar-editor-preview").src=c.getData().url)})})}};a.rx=function(){T.call(this)};y(rx,T);rx.prototype.$=function(b){rx.n.$.call(this);this.K=$(b);this.ae=$(".info-wrap",this.K);this.Cd=$(".edit-wrap",this.K);this.sT=$(".title",this.ae);this.rT=$("input",this.Cd)};
rx.prototype.B=function(){rx.n.B.call(this);this.K.on("click","[name='edit']",$.proxy(function(){this.K.addClass("editing");var b=this.Cd.find("input").get(0);b?b.focus():(b=this.Cd.find("textarea").get(0))&&b.focus()},this));var b=this;this.Jp=[];$("input[type=text]",this.K).each(function(){var c=new jx("/topic/autocomplete",this,$(this).parents(".topic-input-wrap")[0]);b.Jp.push(c)});this.Cd.on("keydown","input",function(b){13===b.keyCode&&setTimeout(function(){var c=$(b.target),g=c.parents(".edit-wrap").children().index(c.parent()),
h=c.parents(".edit-wrap").find("input, select").get(g+1),g=c.parents(".edit-wrap").find("input, select").get(g-1);c.val()&&(h?h.focus():g&&!$(g).val()&&g.focus())})});this.Cd.on("click","[name='cancel'], [name='save']",$.proxy(function(b){b=b.target.name;"cancel"===b?this.cancel():"save"===b&&this.save()},this));var c=$(".fold-wrap");c.click(function(b){"fold"===b.target.name?c.addClass("fold"):"unfold"===b.target.name&&c.removeClass("fold")})};
rx.prototype.save=function(){var b=this,c=this.K.data("name");if("location"===c){var c=this.Cd.find("input.location"),d=this.Cd.find("select"),e=this.Cd.find("input.male").is(":checked")?1:0;$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{location:[c.val()],business:d.val(),gender:e}}},function(c){c&&c.r?U(c.msg):(c=c.msg,c.location[0].html||(c.location[0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>"),c.business.html||(c.business.html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>"),
b.ae.find("span.location").attr("title",c.location[0].text).html(c.location[0].html),b.ae.find("span.business").attr("title",c.business.text).html(c.business.html),c=1===parseInt(c.gender,10)?"male":"female",b.ae.find("span.gender i").removeClass("icon-profile-female icon-profile-male").addClass("icon-profile-"+c),b.cancel())})}else"employment"===c?(d=this.Cd.find("input.employment"),c=this.Cd.find("input.position"),d=d.val(),c=c.val(),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{employment:[[d,
c]]}}},function(c){c&&c.r?U(c.msg):(c=c.msg,!c.employment[0][0].text&&!c.employment[0][1].text?b.K.addClass("empty"):b.K.removeClass("empty"),c.employment[0][0].html||(c.employment[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>"),c.employment[0][1].html||(c.employment[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>"),b.ae.find(".employment").attr("title",c.employment[0][0].text).html(c.employment[0][0].html),b.ae.find(".position").attr("title",
c.employment[0][1].text).html(c.employment[0][1].html),b.cancel())})):"education"===c?(d=[this.Cd.find("input.education"),this.Cd.find("input.education-extra")],c=d[0].val(),d=d[1].val(),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{education:[[c,d]]}}},function(c){c&&c.r?U(c.msg):(c=c.msg,!c.education[0][0].text&&!c.education[0][1].text?b.K.addClass("empty"):b.K.removeClass("empty"),c.education[0][0].html||(c.education[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>"),
c.education[0][1].html||(c.education[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>"),b.ae.find(".education").attr("title",c.education[0][0].text).html(c.education[0][0].html),b.ae.find(".education-extra").attr("title",c.education[0][1].text).html(c.education[0][1].html),b.cancel())})):"description"===c&&(c=this.Cd.find("textarea.description"),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{description:c.val()}}},function(c){c&&c.r?U(c.msg):(c=c.msg,
c.description.text?b.K.removeClass("empty"):(c.description.fold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",c.description.unfold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",b.K.addClass("empty")),b.ae.find(".fold-item .content").empty().html(c.description.fold_html),b.ae.find(".unfold-item .content").html(c.description.unfold_html),c.description.shortened?b.ae.removeClass("disable-fold"):b.ae.addClass("disable-fold"),
b.cancel())}))};rx.prototype.cancel=function(){this.K.removeClass("editing")};a.sx=function(){N.call(this);this.Gg="zm-item";this.WV="zm-item-top-btn";this.xR=j};y(sx,Qk);t=sx.prototype;t.z=function(b){this.Tb=b;this.h().e(b,"click",this.ra);this.refresh()};t.ci=ca("Gg");
t.ra=function(b){if(b.target){var c=Ck(this.Tb,b.target);c&&(this.type=c.getAttribute("data-type"),this.id=c.getAttribute("data-id"),this.action=c.name,this.item=Hc(b.target,k,this.Gg),this.type&&(this.id&&this.action&&this.item)&&(this.YH||(this.YH=j,this.xhr=new V(j),this.h().e(this.xhr,"complete",this.hf),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id="+this.id,"POST")),this.UV=c))}};
t.hf=function(){if("cancel-top"===this.action)Zi(this.item,j);else if("top"===this.action){var b=Ub(this.Gg,this.Tb);this.yX=cg(this.item).y;b&&2<=b.length&&ic(M(this.item),K(this.Gg,this.Tb));this.scroll();wk(this.item);R(K("zm-item-top-btn-top",this.item),m);R(K("zm-item-top-btn-cancel",this.item),j);this.refresh()}this.YH=m};t.scroll=function(){if(this.xR){var b=K("zm-profile-section-wrap"),c=Kc(Rb((fa||window).document)).y;b&&0>cg(b).y-c&&b.scrollIntoView()}};
t.refresh=function(){var b=Ub(this.Gg,this.Tb);b&&0<b.length&&z.forEach(b,function(b,d){if(0!==d){var e=K("zm-item-top-btn-top",b);e&&R(e,j)}},this)};a.tx=function(b,c){b.h().e(c,"next",b.refresh)};a.ux=function(){this.Vv=["zg-btn-follow","zg-btn-unfollow"];this.Wv="people"};y(ux,T);ux.prototype.B=function(){this.h().e(this.g,"click",this.ra)};ux.prototype.ra=function(b){var c=Ck(this.g,b.target);this.Rm&&this.Rm(c);c&&(c.name&&"focus"===c.name)&&ql(c,this.Wv,function(){c.getAttribute("data-followme")&&(F.has(c,"zg-btn-follow")?c.setAttribute("data-tip","s$b$对方已关注你"):c.setAttribute("data-tip","s$b$已互相关注"))},this.Vv,{yW:"question"===this.Wv?"关注问题":k})};ux.prototype.PG=ca("Rm");a.wx=function(b,c,d,e){N.call(this);this.Id=b;this.wh=c;this.Mg=d;this.qC=e||vx;b.maxLength=d;this.oj=new eu(b);O(this.oj,"input",this.lo,m,this);this.Fi()};y(wx,Fd);a.vx=0;wx.prototype.lo=function(){this.Fi()};wx.prototype.Fi=function(){var b=this.Id.value.length;if(b>this.Mg){var c=this.Id.scrollTop,d=this.Id.scrollLeft;this.Id.value=this.Id.value.substring(0,this.Mg);b=this.Mg;this.Id.scrollTop=c;this.Id.scrollLeft=d}this.wh&&wc(this.wh,1==this.qC?b:this.Mg-b)};
wx.prototype.w=function(){wx.n.w.call(this);delete this.Id;this.oj.G();this.oj=k};a.xx=function(b){N.call(this);this.S=k;this.ka=b;this.$s=0;this.iG=""},a.yx=void 0;y(xx,Qk);t=xx.prototype;t.z=function(){this.wl||(this.wl=j,this.v(),this.gb())};t.gb=function(){A||(new Em("搜索问题")).o(this.Jc);this.T=new yn("/redirect-question/autocomplete",this.Jc,k,k,J("zh-question-redirect-diag-content"),m);this.T.Bm=m;this.T.gi(j);this.h().e(this.T,Mm.ih.wi,Nk);this.h().e(this.T,"select",this.QP).e(this.NJ,"click",function(){this.S.D(m)})};
t.QP=function(){var b=this.T.$i();if("search_link"===b[0])window.open("/search?q="+encodeURIComponent(b[1])+"&type=question");else{this.Jc.value="";var c=b[3],b=b[1];this.S.D(m);this.Jc.value="";this.xhr=new V(j);me(this.h(),this.xhr,"complete",this.gJ);this.xhr.ajax("/question/redirect","qid="+this.ka+"&rqid="+c);this.$s=c;this.iG=b}};t.gJ=function(){var b=He(this.xhr);b&&(b.r?U(b.msg):this.xi?(this.xi.innerHTML="已经重定向",this.xi.setAttribute("data-disabled",1)):this.dispatchEvent("change"))};
t.v=function(){this.g=L("div",{id:"zh-question-redirect-diag"},["将问题跳转至",L("div",{id:"zh-question-redirect-diag-content"},this.Jc=L("input",{type:"text","class":"zg-form-text-input"})),L("div","zm-command",this.NJ=L("a",{href:"javascript:;","class":"zm-command-cancel",name:"cancel"},"放弃操作"))]);this.S=new vi(k,m);this.S.Ya("问题重定向");ei(this.S,k);this.S.U().appendChild(this.g)};t.show=function(){this.z();this.S.D(j)};a.zx={},a.zx=function(){N.call(this)};y(zx,Qk);zx.$t=[["需要详细阐述","答案过于简短或表述不清晰，请完善答案。"],["答非所问","没有正面或直接回答问题，请修改答案。"],["应作为问题的评论","该内容是对问题本身的评论而不是回答，请改为发布到评论。"],["应作为答案的评论","该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"],["内容重复","与已有答案重复，请修改答案。"],["内容已过期","答案的时效性已过，请更新答案。"],["需要注明关联利益","有广告、推销嫌疑，请注明作者与利益方的关系。"]];zx.pj=k;zx.O=function(){zx.pj||(zx.pj=new zx,zx.pj.z());return zx.pj};t=zx.prototype;
t.z=function(){if(!this.g){this.v();this.gb();var b=new cm(this.g);Ph(b);b.ND=j;b.Io(j);b.D(m);b.Ey=0;b.P()&&b.fa();Mr(b,new Nf(13,0,0,-22));this.Dy=b}};t.gb=function(){this.h().e(this.g,"click",this.NP)};t.NP=function(b){"A"===b.target.tagName&&(b=b.target.getAttribute("data-index"),this.CK.xW(b),this.Dy.D(m))};
t.v=function(){var b=L("div",{id:"zh-answer-flag-popup","class":"zg-r5px zu-hovercard-wrap"},[L("div","zg-r5px zu-hovercard-inner",[L("div",{id:"zh-answer-flag-popup-header"},[L("a",{"class":"zg-right",href:"http://www.zhihu.com/question/19867017",target:"_blank"},"这是什么？"),"选择一个理由："]),this.SF=L("div",{id:"zh-answer-flog-options-wrap"})]),L("div","zu-hovercard-spin-top")]);z.forEach(zx.$t,function(b,d){var e=L("a",{href:"javascript:;","class":"zm-menu-item-link"},b[0]);e.setAttribute("data-index",
d);this.SF.appendChild(e)},this);document.body.appendChild(b);this.g=b};t.show=function(b,c){this.Dy.Xc(new am(b,1));var d=c.GW(),e=Ub("zm-menu-item-link",this.SF);z.forEach(e,function(b,c){R(b,!z.contains(d,c))},this);this.Dy.D(j);this.CK=c};a.Ax=function(){N.call(this)},a.Bx=void 0;y(Ax,Qk);
Ax.prototype.z=function(){this.v();this.h().e(this.$k,"change",function(){var b=this.$k.value;this.Ly.value="no"===b?"":zx.$t[+b][1]}).e(this.Gi,"click",function(b){"cancel"===b.target.name?this.S.D(m):this.Ly.value&&"no"!==this.$k.value&&(this.Rv=new V(j),this.h().e(this.Rv,"complete",function(){var b=He(this.Rv);b&&!b.r?(this.xi.innerHTML="已经标记",this.S.D(m)):U(b.msg)}),b=rk(this.Ly.value),this.Rv.ajax("/answer/flag","answer_id="+this.QI+"&flag="+this.$k.value+"&reason="+encodeURIComponent(b)))})};
Ax.prototype.v=function(){this.g=L("div",k,[L("div","zg-section",[L("div",k,"标记："),this.$k=L("select")]),L("div",k,[L("div",k,"原因"),this.Ly=L("textarea",{style:"width:96%;border:solid 1px #666;height:66px;padding:5px"})]),this.Gi=L("div","zm-command",[L("a",{"class":"zg-mr10",href:"javascript:void(0);",name:"cancel"},"取消"),L("a",{"class":"zg-btn-blue",href:"javascript:void(0);",name:"confirm"},"确定")])]);this.$k.appendChild(L("option",{value:"no"},"选择标记原因"));z.forEach(zx.$t,function(b,c){this.$k.appendChild(L("option",
{value:c},b[0]))},this);this.S=new vi(k,m);this.S.Ya("标记答案");ei(this.S,k);this.S.U().appendChild(this.g)};Ax.prototype.show=function(){this.S.D(j)};a.Cx=function(b){var c=b&&b.name;if(c)switch(c){case "adminflag":Bx||(Bx=new Ax,Bx.z());c=Bx;c.xi=b;c.QI=b.id.split("-")[1];c.show();break;case "redirect":case "cancel_redirect":if(!b.getAttribute("data-disabled")){var d;yx||(yx=new xx,yx.z());d=yx;d.xi=b;d.ka=b.id.split("-")[1];"redirect"===c?d.show():(Di("/question/unredirect",k,"POST","qid="+d.ka+"&rqid="+d.$s),d.xi.innerHTML="重定向已撤销",d.xi.setAttribute("data-disabled",1))}break;case "revert":var e=Ai("撤销",'<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
function(c){if(c){var c=g.value,d=b.getAttribute("id").split("-")[1],c=(new hj).add("revision",d).add("reason",c),n=new V(j);n.on("success",function(){var b=He(n);b.r?U(b.msg):(e.D(m),b.msg?window.location.href=b.msg:location.reload())});n.ajax("/revert",c.toString());return m}}),g=K("content",e.U());new Zk(g);new Tk(g,48);new wx(g,k,200)}},a.Dx=function(b){$(b).on("click",'a[name="revert"]',function(){Cx(this)})};a.Ex=function(){T.call(this)};y(Ex,T);t=Ex.prototype;t.z=function(){kr.H(this);this.o(document.body)};
t.B=function(){Ex.n.B.call(this);var b=K("zm-profile-header-operation");b&&(new ux).o(b);(b=K("zm-profile-header"))&&(new qx).o(b);(b=J("zh-profile-activity-wrap"))&&this.h().e(b,"click",function(b){if((b=b.target)&&"focus"===b.name){var c=b.getAttribute("data-type");ql(b,c,k,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}});(this.Xv=b=J("zh-profile-page-force-to-rename"))&&this.h().e(b,"click",this.KS);if(this.az=J("zh-profile-search-form")){(b=J("zh-profile-search-type"))&&this.h().e(b,
"click",this.MP);this.Tj=this.az.getAttribute("data_type");this.h().e(this.az,"submit",this.search);O(window,"popstate",function(b){var b=b.state,c;b&&b.Ls&&(c=J("zh-profile-search-query"),c.value=decodeURIComponent(b.Ls),Fx(this,b.type),this.search(i,m),c.focus())},m,this);var b=(new uf(location)).fd().get("pq"),c=(new uf(location)).fd().get("type");c||(c="all");if(b&&c){var d=J("zh-profile-search-info");d&&R(d,j);Fx(this,c);J("zh-profile-search-query").value=b;this.search(i,i,m)}}if(b=J("zh-profile-activity-page-list"))c=
new Ct({ma:["expandLimit"],Wg:j}),c.ma("locationSource",{url:"/people/"+gh[1]+"/activities",ds:10,param:function(b){return{start:z.Td(b).getAttribute("data-time")}}}),c.ma("childConstructor",{factory:iw}),this.H(c),c.o(b),this.h().e(c,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","profile").fill("label","profile_feed")});(b=K("zm-profile-fav-wrap"))&&this.h().e(b,"click",this.gL);(b=J("zm-profile-details-editform"))&&(new mx).o(b);if(b=K("zm-profile-answer-sort"))this.lh=new St,
this.lh.Fa(this.qJ=new Pt("按时间排序")),this.lh.Fa(this.rJ=new Pt("按投票排序")),this.lh.Fa(this.pJ=new Pt("问"+S[0]+"的问题")),this.lh.X(b),this.lh.D(m),this.h().e(b,"click",function(b){this.lh.D(j);b.stopPropagation();me(this.h(),document,"click",function(){this.lh.D(m)})}),this.h().e(this.lh,"action",this.QM);(b=J("zh-profile-edit-expert"))&&(new Gx).o(b);var e=K("profile-expert-tip");e&&this.h().e(e,"click",function(b){var c=b.target;("enable"===c.name||"close"===c.name)&&$.post("/node/ProfileExpertTopicsV2",
{method:c.name},function(b){if(!b||!b.r)"enable"===c.name?location.href="/people/edit/expert":Zi(e,j)})});$(".zm-profile-section-wrap.skilled-topics").each(function(){(new ox).o(this)});$(".zm-profile-module.skilled-topics").each(function(){(new ox).o(this)});$(".zm-profile-module.active-topics").each(function(){(new ox).o(this)});if(c=J("zh-profile-ask-list"))if(b=new Ct({ma:["autoload","locationSource"],Wg:m}),this.H(b),b.o(c),c=K("zm-profile-section-list"))d=new sx,d.ci("zm-profile-section-item"),
tx(d,b),d.z(c);if(c=$("#zh-profile-answer-list > .zh-general-list").get(0)||$("#zh-profile-answer-list").get(0))if(b=new Ct({Wg:m}),this.H(b),b.ma("childConstructor",{Ji:cw}).ma("expandLimit"),b.o(c),this.h().e(b,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","profile").fill("label","profile_answers_list")}),c=K("zm-profile-section-list"))d=new sx,tx(d,b),d.z(c);if(b=$("#zh-profile-log-list").get(0))c=new Ct,c.ma("locationSource",{Es:j}),this.H(c),c.o(b),Dx(b);if(c=J("zh-profile-topic-list"))if(b=
new Ct({ma:["autoload","locationSource"]}),this.H(b),this.h().e(b,"itemcreated",function(b){var b=b.item,c=b.getAttribute("data-tid").split("-")[1];if(S.De===gh[3]){var d=new Cq(j,"/topic/bio/update","bio");d.Lt=j;d.params=["tid="+c];d.Gb='<a href="javascript:;" name="edit">添加你在该话题的经验</a>';d.o(b)}}),b.o(c),c=K("zm-profile-section-list"))d=new sx,d.ci("zm-profile-section-item"),tx(d,b),d.z(c);if(b=$("#zh-profile-column-list > .zh-general-list").get(0))c=new Ct({ma:["autoload","nodeSource"]}),this.H(c),
c.o(b);if(b=$("#zh-profile-follows-list > .zh-general-list").get(0))c=new Ct({ma:["autoload","nodeSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-follows-list-old").get(0))c=new Ct({ma:["autoload","locationSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-fav-list > .zh-general-list").get(0))c=new Ct({ma:["autoload","nodeSource"],Wg:m}),this.H(c),c.o(b);this.Fn();-1<location.search.indexOf("clean-followers-noti=1")&&(new V(j)).ajax("/notification/clear","no_refresh_content=true&type=follow");$("#__signin").click(function(){nl("privacy_sign_in_button",
"singin")})};t.KS=function(){Ai("确定","确定要强制此用户改名吗？",function(b){b&&(J("realname_form").submit(),this.Xv.innerHTML="已发送",F.add(this.Xv,"zg-gray"),Ad(this.Xv))},this)};
t.Fn=function(){this.nj();var b=J("zm-profile-header-pm-btn");b&&O(b,"click",mt(function(b){b.preventDefault()},ol(function(){var c=new zn;c.show();Dn(c,gh[3],gh[0]);Cn(c,b.href);c.Wb.focus()},{ha:"people_message_button",ad:j})));var c=J("zh-profile-cancel-block");c&&this.h().e(c,"click",this.vF);(c=J("zh-report-people"))&&this.h().e(c,"click",this.xG);(c=J("zh-profile-search-query-mirro"))&&new Zk(c,c.getAttribute("placeholder"))};
t.vF=function(){Ai("确定取消屏蔽？","取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。",function(b){b&&Hx(this,m)},this)};t.Ak=function(){me(this.h(),document,"click",function(){this.bb.D(m)})};t.nj=function(){var b=J("profile-side-op");b&&this.h().e(b,"click",this.fj)};t.QM=function(b){var c="";b.target===this.qJ?c="time":b.target===this.rJ?c="vote":b.target===this.pJ&&(c="ask");location.href="/people/"+S[1]+"/answers?sort="+c};
t.fj=function(b){b=b.target.name;"block"===b?Ai("确定要屏蔽该用户？","屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。",function(b){b&&Hx(this,j)},this):"report"===b?this.xG():"cancel-block"===b&&this.vF()};t.xG=function(){Ft("member",gh[3])};a.Hx=function(b,c){var d=new V(j);me(b.h(),d,"complete",function(){window.location.reload()});d.ajax("/people/"+gh[1]+"/block","action="+(c?"add":"cancel"))};
t.gL=function(b){if(b&&b.target&&(b=Ck(this.g,b.target))){var c=K("zm-profile-fav-item-title",b),d=K("zm-profile-fav-item-des",b);c&&d&&"fav-edit"===b.name&&(c=c.innerHTML,d=d.innerHTML||"",b=[Number(b.getAttribute("data-id")),Number(b.getAttribute("data-public"))],sw(kw.O(),c,d,b))}};t.MP=function(b){if((b=b.target)&&b.name)Fx(this,b.name),this.search()};
a.Fx=function(b,c){var d=Ub("zm-profile-search-type-item");if(d)for(var e=0;e<d.length;e++)F.remove(d[e],"current"),d[e].name===c&&F.add(d[e],"current");b.Tj=c};
t.search=function(b,c,d){this.Fe=J("zh-profile-search-query").value;this.am="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search";if(this.Fe){c===i&&(c=j);d===i&&(d=j);if(window.history.pushState){if(this.cz)return;b&&b.preventDefault();this.bm=new V(j);this.cz=j;this.h().e(this.bm,"complete",this.XH);c&&window.history.pushState({Ls:encodeURIComponent(this.Fe),type:this.Tj},"","?pq="+encodeURIComponent(this.Fe)+"&type="+this.Tj);this.bm.ajax(this.am,"type="+this.Tj+"&pq="+encodeURIComponent(this.Fe),
"","POST")}else b||(d?(this.Fe=J("zh-profile-search-query").value,this.am="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search",window.location.href=this.am+"?type="+this.Tj+"&pq="+encodeURIComponent(this.Fe)):(this.bm=new V(j),this.cz=j,this.h().e(this.bm,"success",this.XH),this.Fe=J("zh-profile-search-query").value,this.am="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search",this.bm.ajax(this.am,"type="+this.Tj+"&pq="+encodeURIComponent(this.Fe),"","POST")));
(b=J("zh-profile-search-info"))&&R(b,j)}else b&&b.preventDefault()};
t.XH=function(){this.cz=m;wc(J("zh-profile-search-word"),this.Fe);var b=He(this.bm);if(b&&!b.r){var c=J("zh-profile-search-list");if(c)if(0===b.msg[0])J("zh-profile-list-container").innerHTML='<div id="'+c.id+'"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>';else{var d;d=""+('<div id="'+c.id+'">');d+=b.msg[1]+"</div>";J("zh-profile-list-container").innerHTML=d+'<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>';if((b=Ub("zm-item",
c))&&b.length)this.Xg=b[b.length-1].id.split("-")[1];this.Wa=k;this.Wa=new jw(J(c.id),k,j);this.Wa.z();this.Wa.Xg=this.Xg;this.Wa.url=this.am;this.Wa.params.pq=this.Fe;this.Wa.params.type=this.Tj;J("zh-profile-search-query").focus()}}};a.Gx=function(){T.call(this)};y(Gx,T);
Gx.prototype.$=function(b){this.g=b;this.Na=new Es;this.Na.o(this.g);this.form=J("zm-profile-expert-editform");this.h().e(this.form,"submit",this.my);this.h().e(this.Na,["add","remove","sort"],function(){this.Ve()});$(".enable").on("change","input",$.proxy(function(){this.Ve()},this));var c=J("zh-profile-expert-warning");c&&this.h().e(c,"click",function(b){"close"===b.target.name&&Zi(c)});$(".enable input[type='radio']").click(function(b){R(J("zh-profile-expert-reopen-tip"),!Number($(b.target).val()))})};
Gx.prototype.Ve=function(){$(window).on("beforeunload.profile",v(s("你的更改还未保存，确认离开该页面吗？"),this))};Gx.prototype.Df=function(){$(window).off("beforeunload.profile")};
Gx.prototype.my=function(b){b.preventDefault();z.map(this.Na.data,function(b){return b[3]});var b=$(this.form).serializeArray()[0].value,c=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get(),d=this;$.post("/node/ProfileEditExpertTopicsV2",{method:"save",params:{settings:{enable_expert:b,expert_topic:c}}},function(b){if(!b||!b.r)d.Df(),window.location.href="/people/"+S[1]})};a.Ix=function(){T.call(this)};y(Ix,T);a.Jx=function(b){var c=$.Deferred();Ai("取消屏蔽",b,function(b){b?c.resolve():c.reject()});return c.promise()};
Ix.prototype.B=function(){Ix.n.B.call(this);var b=J("zh-topic-block-editor");b&&(new Gs(ih)).o(b);var c=$(".blocked-users",this.m());if(c.length)$(".item",c).on("click",".js-unblock",function(b){var d=$(b.delegateTarget);Jx("取消屏蔽之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。").then(function(){return $.post("/settings/unblockuser",{uid:d.data("id")})}).then(function(){d.fadeOut(function(){d.remove()});c.children().length||window.location.reload()})});var d=$(".blocked-columns",this.m());if(d.length)$(".item",
d).on("click",".js-unblock",function(b){var c=$(b.delegateTarget);Jx("取消屏蔽之后，你将可以看到来自该专栏的文章。").then(function(){return $.post("/settings/unblockcolumn",{id:c.data("id")})}).then(function(){c.fadeOut(function(){c.remove()});d.children().length||window.location.reload()})})};a.Kx=function(){T.call(this);this.zW=[];this.AX="/profile/validate"};y(Kx,T);
Kx.prototype.z=function(){function b(b){$.post("/node/NotiEmailSettingsV2",{method:"save",params:{settings:b}},function(b){b.DX||(b=$(".settings-msg-success"),b.length?b.show():(b=$('<div class="settings-msg-success">已保存</div>'),b.appendTo($("body"))),b.delay(1E3).fadeOut())})}var c=this;$(".settings-selector").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}).on("click","a.option",function(){var c=$(this),d=c.parent(".settings-selector");if(d.children()[0]!==this){var e=
{type:c.closest(".settings-item").data("type"),receive:c.data("receive")};d.trigger("mouseleave");d.children().eq(0).remove().insertAfter(c);b(e)}});$("#settings-fast-answer").on("change",function(){var c={type:$(this).closest(".settings-item").data("type"),fast:this.checked};b(c)});$(".settings-item-right a").each($.proxy(function(c,d){var e=$(d),g=e.data("type"),h=e.data("checked"),l=new jo(h);l.o(d);var n={type:e.closest(".settings-item").data("type")};this.h().e(l,"change",function(){n[g]=l.ng;
b(n);"noti"===g&&(n[g]?e.next().css("visibility","visible").removeClass("transparent"):(e.next().addClass("transparent"),setTimeout(function(){e.next().css("visibility","hidden")},500)))})},this));$(".settings-msg-disappear").delay(3E3).fadeOut();var d=$(".js-ajax-form");d.submit(function(b){var c=$(b.target),b=c.attr("action")||location.href;$.post(b,c.serialize()).done(function(b){sr(G.Ma(b),5E3);c.hasClass("unsubscribe")&&(d.remove(),$(".settings-section").remove())});return m});$(".js-unsubscribe-other-reason").on("change",
function(b){$(b.target).parent().siblings().find(".zg-form-text-input").toggle()});var e=$(".feedback-form");e.submit(function(){var b=e.attr("action");$.post(b,e.serialize()).done(function(){e.before('<div style="font-size:13px;color:black;margin-bottom:20px">感谢您的反馈！</div><a href="/">&laquo; 返回知乎</a>');e.remove()});return m});$("#weibopageenable").on("change",function(b){$.post("/node/SettingsWeiboPageV2",{method:b.target.checked?"enable":"disable"}).done(function(b){b.r?U(b.msg):sr([m,"保存成功"])});
return m});var g=$("#js-settings-account-form");if(g.length){var h=ok(function(){new Zk(J("password"))}),l=$("#url_token"),n=$("#js-url-preview .token");l.on("input change keyup",function(){n.text($.trim(this.value))});var q=$("#email"),r=function(){$("#js-email-confirm").show();q.off("focus",r);h()};q.one("focus",r);$(function(){document.activeElement===q.get(0)&&r()});$(".resend-mail",g).click(function(){var b=$(this);Ji.dispatchEvent("/activation/resend-email");$.post("/settings/resend_reset_email",
function(c){c.r?U(c.msg):b.replaceWith("已发送")});return m});$(".zg-form-text-input",g).each(function(){function b(){this.value!==this.defaultValue&&(d.hide(),c.off("change input keyup",b))}var c=$(this),d=c.next(".validate-error");if(d.length)c.on("change input keyup",b)});var l=new Xq,w=$(".rename-tab",g);l.o(w.get(0));var E=function(){$("input[placeholder]:visible",w).placeholder()};l.on("select",E);var H=$(".rename-button",g),g=function(){H.remove();w.show();E()};H.one("click",g);"#rename-section"===
location.hash&&g()}g=$("#js-form-account-password");g.length&&($("input[placeholder]",g).each(function(){new Zk(this)}),g.validate({messages:{np:{required:'<i class="icon icon-validate-error"></i>新密码未填写'},op:{required:'<i class="icon icon-validate-error"></i>旧密码未填写'},rp:{required:'<i class="icon icon-validate-error"></i>确认密码未填写'}},errorClass:"validate-error"}));(g=J("zh-setting-page-black-list-wrap"))&&(new Ix).o(g);(g=J("zh-setting-page-bind-wrap"))&&(new fx).o(g);$(".zu-main-content-inner form").on("change",
"input, textarea, select",function(){c.en("SettingsPage")}).on("submit",function(){c.Pk("SettingsPage")})};Kx.prototype.en=function(){$(window).on("beforeunload.SettingsPage",v(s("你的修改还未保存，确认离开该页面吗？"),this))};Kx.prototype.Pk=function(){$(window).off("beforeunload.SettingsPage")};a.Lx=function(){N.call(this);this.S=k;this.qj=0;this.oI="/oauth/friends/sina";this.zI="/invitation/sina";this.wc=new Hd(200)};y(Lx,Qk);t=Lx.prototype;t.z=function(){this.wl||(this.wl=j,this.v(),this.gb(),Mx(this))};t.show=function(){this.z();this.S.D(j);var b=new Lb(this.S.m().offsetLeft,this.S.m().offsetTop);b.y=102;Zf(this.S.m(),b)};t.v=function(){var b=J("zh-invitation-sina-diag");b&&(this.g=b,this.S=new vi(k,m),this.S.Ya("邀请微博好友"),ei(this.S,k),this.S.U().appendChild(this.g))};
t.ra=function(b){if("cancel"===b.target.name)this.S.D(m);else if("invite"===b.target.name){var b=Ub("zm-item-checkbox-right",this.wj),c=[];z.forEach(b,function(b){b.checked&&(c.push(b.value),b.checked="")},this);c&&c.length&&(this.Fy=new V(j),this.h().e(this.Fy,"complete",this.aJ),this.Fy.ajax(this.zI,"sinaids="+c.join(",")))}};
a.Nx=function(b,c){b.qj=c?b.qj+1:b.qj-1;b.gE.innerHTML=b.qj+""},a.Mx=function(b,c){b.QE||(b.QE=j,b.xhr=new V(j),me(b.h(),b.xhr,"complete",b.hf),b.xhr.ajax(b.oI,c?"force=1":""))};t.hf=function(){this.QE=m;var b=He(this.xhr);b&&!b.r?this.setData(b):U(b.msg)};
t.setData=function(b){this.GK=j;this.hT.innerHTML=+b[0];this.qj=+b[1];this.gE.innerHTML=this.qj+"";this.data=b=b[3];var c=[];z.forEach(b,function(b){c.push(['<div class="zm-item zm-item-h50"><input type="checkbox" value="',b[0],'" class="zm-item-checkbox-right" /><img class="zm-list-avatar-medium" src="',b[2],'" /><div class="zm-list-content"><strong class="zg-gray-normal">',b[1],'</strong><div class="zg-gray-normal">',b[3],"</div></div></div>"].join(""))},this);this.wj.innerHTML=c.join("")};
t.gb=function(){this.et=K("zg-form-text-input",this.g);(new Em("搜索微博好友")).o(this.et);this.Gi=K("zm-command",this.g);this.wj=J("zh-invitation-sina-friends-list");this.TQ=J("zh-invitation-sina-force-refresh");this.h().e(this.TQ,"click",function(){this.wj.innerHTML="列表刷新中，请稍侯...";Mx(this,j)});this.h().e(this.wj,"click",this.WO);var b=Tb("strong",k,this.g);this.hT=b[0];this.gE=b[1];this.h().e(this.et,"focus",this.Zo).e(this.et,"blur",this.Yg).e(this.wc,Id,this.YP);this.h().e(this.Gi,"click",this.ra)};
t.WO=function(b){var c=Hc(b.target,k,"zm-item");if(c){var d=k,e=Tb("input",k,c)[0];if(F.has(c,"zm-item-active"))F.remove(c,"zm-item-active"),Nx(this,j),d=m;else{var g;0>=this.qj?(U("您的邀请码已经用完"),g=m):g=j;g?(F.add(c,"zm-item-active"),Nx(this,m),d=j):"INPUT"===b.target.tagName&&b.preventDefault()}"INPUT"!==b.target.tagName&&(e.checked=d);b.stopPropagation()}};t.Zo=function(){this.wc.start()};t.Yg=function(){this.wc.stop()};
t.YP=function(){if(this.GK){this.items||(this.items=Ub("zm-item",this.wj));var b=this.et.value;b==k||""===b?z.forEach(this.items,function(b){R(b,j)}):z.forEach(this.data,function(c,d){this.items[d]&&(b===c[0]||-1<c[1].indexOf(b)?R(this.items[d],j):R(this.items[d],m))},this)}};t.aJ=function(){var b=He(this.Fy);b&&!b.r?(U("邀请发送完毕"),this.S.D(m)):U(b.msg)};a.Ox=function(){N.call(this);this.iI="/oauth/unbind/sina"};y(Ox,Qk);Ox.prototype.z=function(){var b=J("zh-invite-send-invite-sina");b&&this.h().e(b,"click",this.bS);(b=J("zh-invitation-cancel-bind-sina"))&&this.h().e(b,"click",this.bQ)};Ox.prototype.bS=function(){this.$G||(this.$G=new Lx);this.$G.show()};
Ox.prototype.bQ=function(){Ai("解除绑定","你确定要解除与新浪微博的绑定吗？",function(b){if(b){var c=new V(j);me(this.h(),c,"success",function(){var b=He(c);b&&!b.r?window.location.reload():U(b.msg)});c.ajax(this.iI)}},this)};a.Px=function(b,c,d,e,g){Tt.call(this,b,c,g);this.Tv=d||"people";this.oL=e||["zg-follow","zg-unfollow"]};y(Px,Tt);Px.prototype.z=function(b){Px.n.z.call(this,b);this.gb(this.g)};Px.prototype.hA=ca("hA");Px.prototype.gb=function(b){if(this.hA){var c=new ux,d=this.oL;c.Wv=this.Tv;c.Vv=d||c.Vv;this.Rm&&c.PG(this.Rm);c.o(b)}};Px.prototype.PG=ca("Rm");a.Qx=function(b,c,d,e){N.call(this);this.g=b;this.Tv=c||"people";this.nL=d||["zg-btn-follow","zg-btn-unfollow"];this.text=e||["关注","取消关注"]};y(Qx,Qk);Qx.prototype.z=function(){this.h().e(this.g,"click",this.mo)};Qx.prototype.mo=function(b){b=Ck(this.g,b.target);"focus"===(b&&b.name)&&ql(b,this.Tv,k,this.nL,{follow_text:this.text[0],unfollow_text:this.text[1]})};a.Rx=function(b){N.call(this);this.url=b||"/topic"};y(Rx,Qk);t=Rx.prototype;t.o=function(b){this.element=b;var c=$("<ul>");this.vH=$("<li>");c.append(this.vH);$(b).append(c);this.wH||(this.wH=j,this.Xz=new V(j),me(this.h(),this.Xz,"success",this.oP),this.Xz.ajax(this.url,k,"POST"))};t.oP=function(){var b=He(this.Xz);b&&(b&&b.r?U(b.msg):(Tx(this,this.vH,b.msg),this.wH=m,this.B()))};t.B=function(){this.h().e(this.element,"click",this.mo)};
t.mo=function(b){var c=(b=b.target)?b.name:"";if(c)switch(c){case "load":case "loadmore":if(!this.Xn){var c=b.getAttribute("data-token"),d=b.getAttribute("data-parent");this.Xn=j;this.Aj=new V(j);me(this.h(),this.Aj,"success",this.Op);this.ez=b.parentNode;this.ez.innerHTML='<span class="zg-gray">加载中...</a>';this.Aj.ajax(this.url+"?child="+c+"&parent="+d,k,"POST")}break;case "topic":window.location.href=b.href}};
a.Tx=function(b,c,d){var e=d[0],g="";"topic"!==e[0]&&e[3]&&(g='data-parent="'+e[3]+'"');c.html('<a href="'+("topic"===e[0]?"/topic/"+e[2]+"/organize/entire":"javascript:;")+'" data-token="'+e[2]+'" '+g+' name="'+e[0]+'">'+e[1]+"</a><ul class='zm-topic-organize-list'></ul>");"topic"!==d[0][0]&&c.addClass("zm-topic-organize-loadmore");c=$("ul",$(c));if(1<d.length){d=d[1];for(e=0;e<d.length;e++){var g=d[e],h=$("<li>").addClass("zm-topic-organize-item");c.append(h);Tx(b,h,g)}}};
t.Op=function(){var b=He(this.Aj);if(b)if(b&&b.r)U(b.msg);else if(b=b.msg,b[1]){$(this.ez).hide();for(var c=$(this.ez.parentNode),d=0;d<b[1].length;d++){var e=b[1][d],g=$("<li>").addClass("zm-topic-organize-item");"topic"!==e[0][0]&&g.addClass("zm-topic-organize-loadmore");c.append(g);Tx(this,g,e)}this.Xn=m}};a.Ux=function(b){var c={kp:m,BX:m};return function(d){if(d===m)return m;d={};G.extend(d,c,b||{});if(d.kp&&!S.wr)return Bi("提示信息",'<a href="/question/23261456" target="_blank">如何参与知乎话题的公共编辑？</a>'),m;if(d.Sl&&!ch.YK)return Bi("提示信息",'<p>创建较久或已有较多讨论的问题限制公共编辑</p><p><a href="/question/24501563" target="_blank">如何参与问题公共编辑？</a></p>'),m}};a.Vx=function(b,c,d){Cq.call(this,b,c,d)};y(Vx,Cq);Vx.prototype.Ng=function(b){fh[0][0]===b?this.hi():Vx.n.Ng.apply(this,arguments)};Vx.prototype.UA=function(b){if(b=He(b.target))b.r?U(b.msg):b.msg&&(window.location.href=b.msg)};a.Wx=function(){T.call(this);var b=fh;this.rf=b[0][3];this.Vz=b[0];this.FX=b[1];this.WW=b[2];this.eX=b[3];this.cq=b[4];this.ox=b[5];this.Og="topic"};y(Wx,T);t=Wx.prototype;t.z=function(){kr.H(this);this.o(document.body)};
t.B=function(){function b(b){b&&b.msg&&U(b.msg)}Wx.n.B.call(this);var c=J("zh-topic-side-head");if(c){var d=K("zu-entry-focus-button",c);(this.mL=d)&&this.h().e(d,"click",function(){ql(d,"topic","",["zg-btn-green","zg-btn-white"])});(this.Tf=J("zh-topic-operation-menu"))&&this.h().e(this.Tf,"click",this.rz)}if(c=J("zh-current-topic-bio")){var e=new Cq(j,"/topic/bio/update","bio");e.params=["tid="+this.rf];e.Gb='<a href="javascript:;" name="edit">你在 '+this.Vz[0]+" 话题中的经验</a>";e.kC=j;e.o(c)}(c=J("zh-topic-top-answerer"))&&
(new Qx(c,"people",["zg-follow","zg-unfollow"])).z();if(c=J("zh-topic-direct-question-list"))c=new Px(c,k,"question",k,j),c.ci("question-item"),c.z();if(c=J("zh-topic-title"))this.Yc=new Vx(m,"/topic/update","title"),this.Yc.params=["tid="+this.rf],this.Yc.addEventListener("beforeedit",Ux({kp:j})),this.Yc.o(c),$(c).on("click",".js-pin",function(){var b=$(this),c=b.attr("data-action");$.post(c,{tid:fh[0][3]}).done(function(c){c.r?U(c.msg):(c=b.hasClass("pin")?'<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消固定</a>':
'<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>固定话题</a>',b.replaceWith(c))})});if(c=J("zh-topic-desc"))e=$(c).find(".zm-editable-content").data("editable-maxlength"),this.Ok=new Eq(j,"/topic/update","description",e),this.Ok.Gb='<a href="javascript:;" name="edit">添加话题描述</a></div>',this.Ok.params=["tid="+this.rf],this.Ok.kq=m,this.Ok.GH=m,this.Ok.addEventListener("beforeedit",Ux({kp:j})),this.Ok.o(c);if(c=J("zh-topic-faq"))this.Vq=
new Eq(j,"/topic/"+encodeURIComponent(fh[0][1])+"/faq","content",400),this.Vq.Gb='<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「'+fh[0][0]+"」添加常见问题</a></div>",this.Vq.VX=function(b){return!b?"":b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi,"")},this.Vq.kq=m,this.Vq.o(c);
if(lh)$("div.topic-avatar").addClass("disabled");else if(c=K("zm-entry-head-avatar-edit-button")){var g=new cx(2,fh[0][3]);g.o(c);var h=K("zm-avatar-editor-preview");O(g,"beforepost",function(){$("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(h.parentNode)});O(g,"success",function(){$.post("/topic/"+fh[0][1]+"/avatar",{avatar_path:g.getData().id}).then(function(){h&&(h.src=g.getData().url)}).always(function(){$(".avatar-edit-preview-loading").remove()})});this.h().e(g,
"beforeopen",of(Ux({kp:j}),ol(ha,j)))}if(c=J("zh-topic-feed-list"))e=new Ct,this.H(e),e.ma("locationSource",{ds:0,offset:function(b){return z.Td(b).getAttribute("data-score")}}),e.ma("childConstructor",{factory:iw}).ma("expandLimit"),e.o(c),this.h().e(e,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category",this.Og).fill("label","topic_activity")});if(c=J("zh-topic-top-page-list"))e=new Ct({Wg:m}),this.H(e),e.ma("childConstructor",{factory:iw}).ma("expandLimit"),e.o(c),this.h().e(e,"click!",
function(b){"comment"===b.namespace&&b.xc.fill("category",this.Og).fill("label","topic_activity")});var l=this;l.Wa&&l.h().e(l.Wa,"afterload",function(b){Y.ia({type:"ga_click_topic_more",data:b.data,target:l.Wa.Yb})});if(c=J("zh-topic-followers-list-wrap"))c=new Px(c,["/topic",encodeURI(this.Vz[1]),"followers"].join("/"),k,["zg-btn-follow","zg-btn-unfollow"],j),c.ci("zm-person-item"),c.z();if(J("zh-topic-organize-page-wrap")){if(c=J("zh-topic-organize-parent-editor"))S.wr?(e=new ms(k,this.rf,j),e.us=
j,e.o(c),e.addEventListener("remove_tag",function(b){(b=b.data&&b.data.id)&&$("#wedge-"+b).remove()})):Xx(c);if(c=J("zh-topic-organize-child-editor"))S.wr?(e=new ms(k,this.rf,m),e.us=j,e.o(c),$("a.entire-link").insertAfter(e.cn).show()):Xx(c);$("#zm-topic-manage-relation").on("change",'[type="checkbox"]',function(){var b=$(this).closest("li").attr("id").split("-")[1];$.post("/topic/update",{action:"set_topic_edge",parent_topic_id:b,topic_id:fh[0][3],edge:this.checked^0}).done(function(b){b&&b.msg&&
U(b.msg)})});this.ou=J("zh-topic-alias-input");new Zk(this.ou,"输入话题别名");this.pu=J("zh-topic-alias-list");this.h().e(J("zh-topic-alias-container"),"click",this.$P);if(c=J("zh-topic-merge"))this.Na=new Hs,this.Na.o(c);(c=J("zh-topic-merge-btn"))&&this.h().e(c,"click",this.CP)}(c=J("zh-topic-organize-page-children"))&&(new Rx("/topic/"+encodeURIComponent(fh[0][1])+"/organize/entire")).o(c);if(c=J("zh-topic-side-related-topics"))this.XQ=c,this.Py=new V(m),this.h().e(this.Py,"complete",this.LP),this.Py.ajax("/topic/related?tid="+
this.rf);J("zh-topic-admin-page-wrap")&&(c=J("zh-topic-del-btn"))&&this.h().e(c,"click",this.kP);if(c=J("zh-topic-log-list"))(new Px(c,k,k,k,j)).z(),$(c).on("click",'a[name="revert"]',of(function(b){b!==m&&Cx(this)},Ux({kp:j})));(c=K("zm-topic-search-input-new"))&&new Zk(c,"在话题中搜索");var n=$(c);ah.uc||n.focus(function(){n.addClass("stretch-to")}).blur(function(){n.removeClass("stretch-to")});(c=K("zm-topic-ask-in-topic"))&&this.h().e(c,"click",this.mt);(c=K("zm-topic-feed-container"))&&(new Qx(c,"question",
["zg-follow","zg-unfollow"])).z();(c=J("zh-topic-side-children-list"))&&(new Qx(c,"topic",["zg-follow","zg-unfollow"])).z();(this.Kr=J("zh-topic-info-add"))&&this.h().e(this.Kr,"submit",this.xP);(this.YD=K("zm-topic-info-content-main",this.g))&&this.h().e(this.YD,"click",this.vP);$("#zh-topic-manage-info-form").on("change",'input[type="radio"]',function(){$.post("/topic/"+fh[0][1]+"/information/manage",{info:$(this).val(),action:"change"}).done(b)});$("#zh-topic-manage-relation-form").on("change",
'input[type="radio"]',function(){$.post("/topic/update",{action:"set_topic_weaknode",topic_id:fh[0][3],weak:$(this).val()}).done(b)});$("#zh-topic-manage-lock-form").on("change",'[type="checkbox"]',function(){$.post("/topic/lock",{url_token:fh[0][1],lock_type:this.name,lock_value:$(this).is(":checked")?1:0}).done(b)});(c=J("zh-topic-info-add"))&&z.forEach(nc(c),function(b){var c;b&&(b.getAttribute&&(c=b.getAttribute("data-placeholder")))&&new Zk(b,c)});$(".js-may-disable").click(ol(ha,j))};
t.CP=function(){this.Cq=this.Na.$B;if(!this.$E&&this.Cq){this.$E=j;this.Px=new V(j);me(this.h(),this.Px,"success",this.bJ);this.Px.ajax("/topic/"+encodeURIComponent(fh[0][1])+"/demand","action=merge&target_topic_id="+this.Cq[3]);var b=J("zh-topic-merged-msg");R(J("zh-topic-merge"),m);R(b,j);b=Tb("a",k,b)[0];b.href="/topic/"+this.Cq[1];b.innerHTML=this.Cq[0];this.Na&&(this.Na.fb.value="")}};t.bJ=function(){var b=He(this.Px);b&&b.r?U(b.msg):this.$E=m};
t.kP=function(){this.hC||(this.hC=j,this.nv=new V(j),me(this.h(),this.nv,"success",this.ZI),this.nv.ajax("/topic/"+encodeURIComponent(fh[0][1])+"/demand","action=remove"))};t.ZI=function(){var b=He(this.nv);b&&b.r?U(b.msg):(b=J("zh-topic-del-msg"),R(J("zh-topic-del-btn"),m),R(b,j),this.Na&&(this.Na.fb.value=""),this.hC=m)};
t.$P=function(b){if((b=b.target)&&b.name)if("add"===b.name){if(b=this.ou.value)this.qu=new V(j),me(this.h(),this.qu,"complete",this.YI),this.qu.ajax(window.location.href,"action=add_alias&alias="+encodeURIComponent(b))}else"remove"===b.name?(this.Qy=new V(j),b=b.parentNode.getAttribute("data-token"),me(this.h(),this.Qy,"complete",this.dJ),this.Qy.ajax(window.location.href,"action=remove_alias&alias_token="+b)):"remove-merged"===b.name&&(this.Sy=new V(j),b=b.parentNode.getAttribute("data-token"),me(this.h(),
this.Sy,"complete",this.eJ),this.Sy.ajax("/topic/"+encodeURIComponent(fh[0][1]+"/demand"),"action=remove&target_topic_id="+b))};t.eJ=function(){var b=He(this.Sy);b&&b.r?U(b.msg):Yx(this,b.msg)};t.dJ=function(){var b=He(this.Qy);b&&b.r?U(b.msg):Yx(this,b.msg)};a.Yx=function(b,c){var d=Tb("li",k,b.pu);z.forEach(d,function(b){b.getAttribute("data-token")===c[1]&&R(b,m)})};
t.YI=function(){var b=He(this.qu);if(b&&b.r)U(b.msg);else{var b=b.msg,c=L("li");c.setAttribute("data-token",b[1]);c.innerHTML=b[0]+' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>';this.pu.appendChild(c);this.ou.value="";R(this.pu.parentNode,j)}};a.Xx=function(b){gc(b,ec('<a href="/question/23261456" class="zg-link-gray-normal"><i class="icon-info" style="vertical-align: -3px; margin-right: 6px"></i>如何参与知乎话题的公共编辑？</a>'))};
t.rz=function(b){this.ry?this.bb.P()?this.bb.D(m):(this.bb.D(j),b.stopPropagation(),b.preventDefault(),this.Ak()):(b.stopPropagation(),b.preventDefault(),this.nj(),this.Ak());this.ry=j};t.Ak=function(){me(this.h(),document,"click",function(){this.bb.D(m)})};
t.nj=function(){var b=J("zh-topic-side-head"),c=this.Tf.getAttribute("data-auth");this.bb=new St;this.Lw=j;"f-topic-manage"===c&&this.bb.Fa(this.fQ=new Pt("管理话题"));this.bb.Fa(this.gQ=new Pt("组织话题"));this.bb.Fa(this.eQ=new Pt("话题日志"));this.Lw&&(this.bb.X(b),this.h().e(this.bb,"action",this.fj))};t.fj=function(b){var c="";b.target===this.fQ?c="admin":b.target===this.gQ?c="organize":b.target===this.eQ&&(c="log");window.location.href=["/topic",this.Vz[1],c].join("/")};
t.LP=function(){var b=He(this.Py);if(b&&!b.r){var c=[];z.forEach(b,function(b){c.push(qk(b,k,j))});this.XQ.innerHTML=c.join("")+'<div class="zg-clear"></div>';b.length&&R(J("zh-topic-side-related-topics-wrap"),j)}};
t.vP=function(b){var c=b.target;c&&c.name&&"remove"===c.name&&(this.uN=c,this.ZD||(this.ZD=j,this.Ww=new V(j),this.h().e(this.Ww,"success",this.wP),b="token="+this.uN.parentNode.getAttribute("data-token")+"&action=remove&element="+encodeURIComponent($(b.target).prev("[data-element]").text()),this.Ww.ajax("/topic/"+fh[0][1]+"/information/manage",b,"POST")))};t.wP=function(){this.ZD=m;var b=He(this.Ww);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,K("zm-topic-info-content-main",this.g).innerHTML=$(b).html()))};
t.xP=function(b){b.preventDefault();this.$D||(this.$D=j,this.Xw=new V(j),this.h().e(this.Xw,"success",this.uP),b=nc(this.Kr),this.Xw.ajax("/topic/"+fh[0][1]+"/information/manage","title="+b[0].value+"&content="+b[1].value+"&url="+b[2].value+"&action=add","POST"))};t.uP=function(){this.$D=m;var b=He(this.Xw);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,K("zm-topic-info-content-main",this.g).innerHTML=$(b).html(),b=nc(this.Kr),z.forEach(b,function(b,d){3>d&&(b.value="")})))};
t.mt=ol(function(){if(!fr()){var b=Hq.O();b.show();var c=K("zm-topic-search-input-new");c.value&&Kq(b,c.value);b.Na.data.length||b.Na.Wj(fh[0])}},j);a.Zx=function(b){T.call(this,b)};y(Zx,T);Zx.prototype.v=function(){this.g=this.J().v("FORM",{method:"POST",style:"display:none"})};Zx.prototype.post=function(b,c,d){var e=this.m();e||(this.X(),e=this.m());e.action=c||"";e.target=d||"";var c=e,g,h=new Fr;for(g in b)d=b[g],na(d)?z.forEach(d,v(this.bB,this,h,g)):this.bB(h,g,d);c.innerHTML=h.toString();e.submit()};Zx.prototype.bB=function(b,c,d){b.append('<input type="hidden" name="',Va(c),'" value="',Va(d),'">')};a.$x=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"day"})})},a.ay=function(b){return $.get("/node/ExploreHotFavlistsInnerV2",{params:JSON.stringify({offset:b})})},a.by=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"month"})})};a.cy=function(){N.call(this)};y(cy,Qk);cy.prototype.z=function(){var b=Pr(new uf(window.location.href),"group_id");b&&(this.Dj=new V(m),me(this.h(),this.Dj,"success",this.yy),b&&this.Dj.ajax("/noti7/read","group_id="+b,"POST"))};cy.prototype.yy=function(){var b=He(this.Dj);if(b&&!b.r&&b.msg){var c=b.msg;if(c===j||"true"===c||"True"===c)return;this.RO=b.msg;this.dispatchEvent("change")}(b=Vl)&&Wl(b)};a.dy=function(){T.call(this);var b=hh||[0,0];this.cs=b[0];this.visible=!!b[1];this.Og="collection"};y(dy,T);t=dy.prototype;t.z=function(){kr.H(this);this.o(document.body)};
t.B=function(){dy.n.B.call(this);var b=J("zh-list-side-head");if(b){var c=K("zu-entry-focus-button",b);(this.mL=c)&&this.h().e(c,"click",function(){ql(c,"favlist","",["zg-btn-green","zg-btn-white"])});(this.Tf=J("zh-list-operation-menu"))&&this.h().e(this.Tf,"click",this.rz)}(b=J("zh-single-answer-author-info"))&&(new Qx(b)).z();(b=J("zh-list-create-new-list"))&&this.h().e(b,"click",this.VR);(b=J("zh-fav-list-side-bar-creator"))&&(new Qx(b)).z();(b=J("zh-fav-list-side-bar-report"))&&this.h().e(b,
"click",this.Il);(this.ik=J("zh-favlist-webshare-container"))&&this.h().e(this.ik,"click",this.uz);if(this.Tc=J("zh-list-meta-wrap"))this.h().e(this.Tc,"click",this.Il),this.aW=J("zh-list-comment-num"),Pr(new uf(location.href),"fc")&&ey(this);(b=J("zh-favlists-wrap"))&&(new Px(b,k,"favlist",k,j)).z();if(b=J("zh-list-answer-wrap")){$(b).on("click","a[name=unfavo]",$.proxy(this.aN,this));var d=new Ct({Wg:m});this.H(d);d.ma("childConstructor",{Ji:cw}).ma("expandLimit");d.o(b);this.h().e(d,"click!",function(b){"comment"===
b.namespace&&b.xc.fill("category",this.Og).fill("label","collection_answer")})}(b=J("zh-favlist-log-list-wrap"))&&(new Px(b,k,"favlist",k,j)).z();(b=J("zh-favlist-following-wrap"))&&(new Px(b,k,"favlist",k,j)).z();if(b=J("zh-favlist-followers-wrap"))b=new Px(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j),b.ci("zm-profile-section-item"),b.hA(j),b.z();this.h().e(window,"hashchange",this.xX);this.bx();this.fo=new cy;this.fo.z()};
t.aN=function(b){var b=b.target,c=b.id.split("-"),d=c[1],c=c[2];(new V(j)).ajax("/collection/remove","answer_id="+d+"&favlist_id="+c);if(c=Hc(b,"div","zm-item"))b=Ub("zm-item-answer",c),1===b.length?M(c):(b=z.find(b,function(b){return b.getAttribute("data-aid")===d}))&&M(b.parentNode)};t.uz=function(b){var b=Ck(this.ik,b.target),c=location.pathname.match(/^\/collection\/(\w+)/);b&&(b.name&&c)&&new ku(["分享收藏夹","collection",c[1],{fid:hh[0]}],"tb-webshare-"+b.name)};
t.VR=ol(function(){kw.O().show(j)},j);t.rz=function(b){this.ry?this.bb.P()?this.bb.D(m):(this.bb.D(j),b.stopPropagation(),b.preventDefault(),this.Ak()):(b.stopPropagation(),b.preventDefault(),this.nj(),this.Ak());this.ry=j};t.Ak=function(){me(this.h(),document,"click",function(){this.bb.D(m)})};
t.nj=function(){var b=J("zh-list-side-head");this.bb=new St;this.Lw=j;this.visible||this.bb.Fa(this.iQ=new Pt("设置为公开"));this.bb.Fa(this.dQ=new Pt("删除此收藏夹"));this.Lw&&(this.bb.X(b),this.h().e(this.bb,"action",this.fj))};t.Il=function(b){b=b.target;switch(b&&b.name){case "report-favlist":Ft("favlist",this.cs);break;case "edit":sw(kw.O());break;case "addcomment":ey(this);this.sa.uf();this.sa.tc()&&this.sa.ki("view_comments",parseInt(Ec(b),10)||0);break;case "remove":fy(this)}};
t.fj=function(b){b.target===this.iQ?Ai("确定设置收藏夹为公开？","收藏夹设置为公开后，将不能再设置为私密。",function(b){b&&(this.lX=!this.visible,this.EH=new V(j),this.h().e(this.EH,"complete",function(){window.location.reload()}),this.EH.ajax("/collection/update","favlist_id="+this.cs+"&is_public=1"))},this):b.target===this.dQ&&fy(this)};a.fy=function(b){Ai("删除收藏夹","你确定要删除这个收藏夹吗？",function(b){b&&(b=new Dk,b.add("favlist_id",this.cs),b.add("_xsrf",(new Jf(document)).get("_xsrf")),(new Zx).post(Nr(b),"/collection/delete"))},b)};
t.bx=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=ay(b).done(function(b){c.html(b)}))})};a.ey=function(b){b.sa||(b.sa=new Jv(b.cs,"favlist"),b.H(b.sa),b.h().e(b.sa,"click!",function(b){"comment"===b.namespace&&(b.xc.fill("category",this.Og).fill("label","collection"),b.xc.action=b.xc.action.replace("favlist","collection"))}),Nv(b.sa,b.Tc,$(".toggle-comment",b.Tc)[0]))};a.hy=function(b){gy&&(this.jn=b,this.si=$(this.jn.g),setTimeout(v(this.cf,this)))},a.gy=!!$("#is-topstory2").length,a.iy={q:"question",a:"answer",p:"article",c:"column",r:"roundtable"},a.jy={question:"question",answer:"question",article:"column",column:"column",roundtable:"roundtable"},a.ky={question:"question",answer:"question",article:"article",column:"column",roundtable:"roundtable"};
hy.prototype.cf=function(){this.data=ly(this);var b=this;At(this.si[0],function(){my(b,"display")},this.jn);this.jn.h().e(this.jn,"expand",function(c){c.target instanceof Xv&&my(b,"expand_"+b.data.object_type)}).e(this.jn,"collapse",function(c){c.target instanceof Xv&&my(b,"collapse_"+b.data.object_type)});this.si.on("click",'a[name="nohelp"]',function(){var c=!!$(this).data("revert");my(b,c?"unhelpful":"revert_unhelpful");$(this).data("revert",!c)});$.each({'a.zg-follow:not([data-follow="t:link"])':"follow_"+
jy[b.data.object_type],'a.zg-unfollow:not([data-follow="t:link"])':"unfollow_"+jy[b.data.object_type],'a.zg-follow[data-follow="t:link"]':"follow_topic","a.toggle-comment":"expand_comments",'a[name="addnew"]':"comment",".content h2":"open_"+ky[b.data.object_type],'a[name="dislike"]':"uninterest","a.revert":"revert_uninterest","a.ignore.close":"confirm_uninterest","button.up.pressed":"vote_up_"+b.data.object_type,"button.down.pressed":"vote_down_"+b.data.object_type,"button.up:not(.pressed)":"revert_vote_up_"+
b.data.object_type,"button.down:not(.pressed)":"revert_vote_down_"+b.data.object_type,'a[name="favo"]':"collect_answer",'a[name="thanks"]':"thanks",'a[name="share"]':"share",'a[name="report"], .js-report':"report","a.answer-date-link":"open_answer"},function(c,d){b.si.on("click",c,function(){my(b,d)})});this.zN()};
a.ny=function(b){$.ajax({type:"POST",url:"/zreactor/deliver",data:JSON.stringify(b),contentType:"application/json",processData:m})},a.my=function(b,c){var d=$.extend({},ly(b),{action_type:c});d.object_id&&("display"===c?b.EQ(d):ny(d))},a.oy=[],a.py=Ok(550,function(){oy.length&&(ny(oy),oy=[])});hy.prototype.EQ=function(b){oy.push(b);py()};
a.ly=function(b){var c=b.si.find('meta[itemprop="ZReactor"]'),d=$.extend({},c.data("meta"),{create:b.si.find(".source .time").data("timestamp"),offset:$(".feed-item").index(b.si)+1});return{mid:ph.ga_vars.user_hash,object_type:iy[b.si.data("type")],object_id:c.data("id"),object_meta:d,context:"topstory2",others:""}};
hy.prototype.zN=ok(function(){O(Y,"click_feed_fresh",function(b){ny({mid:ph.ga_vars.user_hash,object_type:"btn",object_id:2,object_meta:{load_items:b.data.count},action_type:"click",context:"topstory2",others:""})});O(Y,"topstory_feed_more",function(){ny({mid:ph.ga_vars.user_hash,object_type:"btn",object_id:1,object_meta:{next:$("#js-home-feed-list .feed-item").length+1},action_type:"click",context:"topstory2",others:""})})});a.qy=function(b,c,d){Tt.call(this,b,c,d)};y(qy,Tt);qy.prototype.hf=function(b){b&&!b.r&&(b=b.msg,b.length?(R(this.Yb,0<b.length),this.offset+=b.length,this.Wp(b),Wt(this,m),Zt(this)):this.pk.hide())};a.ry={ROUNDTABLE_ADD_RELATED:"roundtable",ARTICLE_VOTE_UP:"post_vote",ARTICLE_CREATE:"post_create",RECOMMENDED:"feed_recommended",QUESTION_FOLLOW:"feed_question_follow",QUESTION_CREATE:"feed_question",ANSWER_VOTE_UP:"feed_answer_vote",ANSWER_CREATE:"feed_answer_answer"};
qy.prototype.$M=function(b){var c=b.currentTarget.g.getAttribute("data-feedtype"),c=ry[c];"comment"===b.namespace&&c&&b.xc.fill("category","feed").fill("label",c)};qy.prototype.Fj=function(b){var c=iw(b);this.H(c);this.h().e(c,"click!",this.$M);c.o(b);new hy(c);return c};qy.prototype.gG=function(b){return{params:b,method:"next"}};a.sy=function(){this.interval=3E4};ia(sy);a.uy=function(b,c){if(!b.wc||c)c&&clearInterval(b.wc),b.wc=setInterval(v(function(){ty(this)},b),b.interval)},a.ty=function(b,c){$(".feed-item-hook .time").each(function(){$(this).text(Vs($(this).data("timestamp")))});c&&uy(b,c)};a.vy=function(){T.call(this);this.rx={};this.ts=[];this.VN="old"===$("#feed-ver").val();this.uE=!!$("#is-topstory").length;this.fO=!!$("#is-topstory2").length;this.HC=this.VN?"zm-item":"feed-item-hook";window._gaq=window._gaq||[];this.uE?window._gaq.push(["_setCustomVar",5,"is_topstory",j,3]):window._gaq.push(["_setCustomVar",5,"is_topstory",m,3])};y(vy,T);t=vy.prototype;
t.B=function(){vy.n.B.call(this);this.K=$(this.g);if(this.oe=J("zh-main-feed-fresh-button"))this.Bp=$(this.oe),this.fO?(this.h().e(this.oe,"click",this.VQ),this.h().e(Y,"topstory2",this.FD)):this.uE?(this.h().e(this.oe,"click",this.UQ),this.h().e(Y,"topstory",this.FD)):(this.h().e(this.oe,"click",this.$R),this.h().e(Y,"homefeed",this.FM));this.Wa=new qy(this.g,k,j);this.getParent()&&this.getParent().H(this.Wa);var b="/node/"+$(this.g).data("init").nodename;this.Wa.url=b;this.Wa.ci("feed-item-hook");
this.h().e(this.Wa,"itemcreated",function(b){wy(this,b.data.iO)}).e(this.Wa,"afterload",function(b){Y.ia({type:"ga_click_feed_more",data:b.data})}).e(this.Wa,"ignore",function(b){var c=b.key,g=b.value;G.forEach(this.rx,function(b){b.Rq[c]===g&&$(b.g).fadeOut(150)})});this.Wa.z();this.K.on("click",".js-more-similar",function(){$(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast")});var c=this;this.K.on("click",".js-change-some",function(){Gk("feed","intrests-change");var b=
$(this),e=$(this).parent().parent();$.post("/node/HomeExtraFeedList",{method:"next",params:{}}).done(function(g){!g.r&&g.msg&&(0<g.msg.length?(e.find(".feed-item-hook").remove(),e.append(g.msg).find(".feed-item-hook").each(function(){c.Wa.Fj(this)})):b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>'))})})};
t.UQ=function(){this.Bp.text("加载中…");this.ii=0;var b=this;this.Wa.offset=0;this.Wa.Xg=0;Yt(this.Wa,j,function(){Lh(b.Wa,function(b){$(b.m()).remove()})}).done(function(){b.Bp.hide();Vt(b.Wa)})};t.VQ=function(){this.Bp.text("加载中…");var b=this.ii;this.ii=0;var c=this;this.Wa.offset=b;this.Wa.Xg="live";Yt(this.Wa,j,k,function(b){b&&b.msg.length&&(c.Wa.Wp(b.msg,"prepend"),c.Bp.hide())});Y.ia({type:"click_feed_fresh",data:{count:b}})};
t.$R=function(){var b=K("zm-home-question-list-devider",this.g);b&&F.remove(b,"zm-home-question-list-devider");var b=this.ts.length,c=$("."+this.HC,this.g)[0];c&&5<=b&&($(".feed-separator-hook",this.g).next(".feed-item-hook").css("border-top","1px solid #eee").end().remove(),$(c).css("border-top","none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>'));z.forEach(this.ts,function(b){var c=$("."+this.HC,this.g)[0];c?ic(b,c):this.g.appendChild(b)},
this);this.ts=[];R(this.oe,m);c=sy.O();ty(c,j);Y.ia({type:"ga_click_feed_fresh",data:{count:b}})};
t.FM=function(b){var c=La(b.Hc),b=this.ts,d=b.length;if(c&&!(500<d)){var e=ec(c),c=this.rx;if(!G.Zq(c,function(b){return b.m().id===e.id})){var g=this.Wa.Fj(e);if(g.oa){if(G.Zq(c,function(b){return b.oa===g.oa}))return}else if(g.ka){if(G.Zq(c,function(b){return b.ka===g.ka}))return}else if(g.ub&&G.Zq(c,function(b){return b.ub===g.ub}))return;wy(this,g);b.push(e);d+=1;this.oe&&(this.oe.innerHTML=(99<d?"99+":d)+" 条新动态",R(this.oe,j))}}};
t.FD=function(b){this.ii=this.ii||0;this.ii+=+b.Hc;this.oe&&(this.oe.innerHTML=(99<this.ii?"99+":this.ii)+" 条新动态",R(this.oe,j))};a.wy=function(b,c){var d=Fh(Eh.O());b.rx[d]=c;$(c.g).attr("data-fid",d)};a.xy=function(){};y(xy,T);t=xy.prototype;t.B=function(){xy.n.B.call(this);var b=J("zh-invite-select");b&&this.h().e(b,"change",this.ky);(b=K("zm-invite-list"))&&this.h().e(b,"click",this.ra);(this.Qw=J("zh-invite-ignore-all-btn"))&&this.h().e(this.Qw,"click",this.qN)};
t.ra=function(b){if((b=b.target)&&b.name){if("ignore"===b.name){this.PW=b;this.QW=j;F.add(b,"zg-btn-disabled");this.rN=new V(m);var c="qid="+b.getAttribute("data-qid")+"&uid="+S.De+"&op=pass";this.rN.ajax("/question/askpeople",c,"POST");(c=b.parentNode)&&Zi(c,j)}"recover"===b.name&&!this.qG&&(this.oG=b,this.qG=j,F.add(b,"zg-btn-disabled"),b.innerHTML="...",this.pG=new V(m),this.h().e(this.pG,"success",this.cJ),b="qid="+b.getAttribute("data-qid")+"&uid="+S.De+"&op=recover",this.pG.ajax("/question/askpeople",
b,"POST"))}};t.ky=function(b){var c=Pr(new uf(location.href),"filter_by");if((b=b.target)&&b.value)b=b.value,b!==c&&(window.location.href="/question/invited?filter_by="+b)};t.cJ=function(){this.qG=m;this.Zb(this.oG,"ignore");this.oG.name="ignore"};
t.Zb=function(b,c){var d=b.parentNode,e=K("zm-invite-item-info-label",d);"ignore"===c?(F.remove(b,"zg-btn-disabled"),F.remove(b,"recover"),F.add(b,"ignore"),F.add(d,"invite"),F.remove(d,"ignore"),e.innerHTML="新邀请",b.name="ignore",b.innerHTML="忽略"):(F.remove(b,"zg-btn-disabled"),F.remove(b,"ignore"),F.add(b,"recover"),F.remove(d,"invite"),F.remove(d,"draft"),F.add(d,"ignore"),e.innerHTML="已忽略",b.name="recover",b.innerHTML="恢复")};
t.qN=function(){this.Rw||(this.Rw=j,this.UD=new V(m),this.h().e(this.UD,"success",this.$I),this.UD.ajax("/question/askpeople","uid="+S.De+"&op=ignore_all","POST"))};t.$I=function(){this.Rw=m;R(this.Qw);this.Rw=m;z.forEach(Ub("zm-invite-item-control"),v(function(b){this.Zb(b,"recover")},this))};a.yy=function(){T.call(this)};y(yy,T);yy.prototype.B=function(){yy.n.B.call(this);this.il();this.h().e(this.g,"click",this.ra)};yy.prototype.ra=function(b){b=b.target;if(b.name)switch(b.name){case "fold":$(b).parent().hide().prev().animate({height:"show"},200);break;case "fold-follow":$(b).parent().hide().prev().show();break;case "unfold-item":$(b).parent(".author-list").hide().siblings(".hidden").show()}};
yy.prototype.il=function(){this.Xn||(this.Xn=j,this.Aj=new V(m),this.h().e(this.Aj,"success",this.hy),this.Aj.ajax("/noti7/calendar","","GET"))};yy.prototype.hy=function(){this.Xn=m;var b=Ge(this.Aj);if(b){var c=J("zh-noti7-list-inner");/category/.test(b)?(c.innerHTML=b,c&&(b=new Tt(c,"/noti7/calendar",j),b.Wp=function(b){var c=L("div","zm-item-more-wrap");c.innerHTML=b;ic(c,this.Yb)},b.vr=function(b){this.Xg=this.Yb.getAttribute("data-next");return!b||b.msg[0]&&b.msg[1]},b.z())):c.innerHTML='<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>'}};a.zy=function(){N.call(this);this.Ow=[];this.eC=[]};y(zy,Qk);zy.prototype.z=function(){var b=J("home-suggest-block");b&&(this.g=b,b=J("home-suggest-close-button"),me(this.h(),b,"click",function(){(new V(j)).ajax("/option","key=no_show_lookup&value=1");R(this.g,m)}),b=J("home-suggest-refresh-button"),this.h().e(b,"click",this.KP),this.hs=J("home-suggest-list"),Ay(this))};zy.prototype.KP=function(){By(this);return j};
a.By=function(b){for(var c=[],d=0;3>d;d++){var e=b.eC.shift();e&&c.push(e)}3===c.length?(b.hs.innerHTML=c.join(""),c=Ub("suggest-item",b.hs),z.forEach(c,function(b){this.Ow.push(b.id.split("-")[1])},b)):Ay(b)},a.Ay=function(b){b.hs.innerHTML='<img class="bubble-loading" src="http://static.zhihu.com/static/img/noti-loading.gif">';$.post("/lookup/suggest_member",{ids:b.Ow.join(",")}).done(v(b.iP,b))};
zy.prototype.iP=function(b){b.r||((b=b.msg)&&ma(b)&&b.length?(this.Ow=[],this.eC=b,By(this)):this.hs.innerHTML="")};a.Cy=function(){T.call(this)};y(Cy,T);Cy.prototype.z=function(){kr.H(this);this.o(document.body)};
Cy.prototype.B=function(){Cy.n.B.call(this);var b=J("js-home-feed-list");if(b){var c=new vy;this.H(c);c.o(b)}(b=K("zm-invite-container"))&&(new xy).o(b);J("home-settings-page-wrap")&&(b=J("zh-topic-block-editor"))&&(new Gs(ih)).o(b);(b=J("zh-noti7"))&&(new yy).o(b);if(c=J("zm-home-sidebar-domain-entry-link"))b=!!c.getAttribute("data-expanded"),c=new no(c,J("zm-home-sidebar-domain-entry-nav"),b),b&&vd(c,"toggle",function(){Di("/notifeature?feature=4",k,"GET");return j});$(".zm-side-pinned-topics").on("click",
".unpin",function(){var b=$(this).parent();$.post("/pin-topic/remove",{tid:$(this).attr("data-tid")}).done(function(c){c.r||b.fadeOut()})});if(b=$("#zh-virgin-answer-list > .zh-general-list").get(0))c=new Ct,this.H(c),c.ma("nodeSource").ma("childConstructor",{Ji:cw}),c.o(b),this.h().e(c,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","debuts").fill("label","debuts")});(new zy).z();var b=S[1],d=J("zu-welcome-once");d&&("welcome"===location.hash.slice(1)?(R(d,j),Mf.set("reg_noti_",
b,86400)):b===Mf.get("reg_noti_")&&R(d,j),O(K("x-m",d),"click",function(){location.hash="";M(d);Mf.remove("reg_noti_")}));var e=$(".user-guiding-box");if(0!==e.length){var b=$(".view-avatar",e),c=$(".view-headline",e),g=$(".view-email",e),h=[];b.length&&h.push(b);c.length&&h.push(c);g.length&&h.push(g);var l=function(){var b=h.shift();if(0===h.length)xk()?yk(e,"fadeOut",function(){e.remove()}):e.remove();else{var c=h[0];xk()?yk(b,"fadeOutRight10",function(){b.remove();c.show();yk(c,"fadeInLeft10")}):
(b.remove(),c.show())}};$(".js-noavatar",e).on("click",function(){$.post("/node/HomeGuideV2",{method:"ignore",params:{ignored_entry:"avatar"}});l()});$(".js-noheadline",e).on("click",function(){$.post("/node/HomeGuideV2",{method:"ignore",params:{ignored_entry:"headline"}});l()});var n=new cx(bx);n.o($(".js-uploadavatar",e));n.on("success",function(b){b.src&&($.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:n.getData().id}}},function(b){b&&!b.r&&$(".avatar-edit-preview-loading").remove()}),
$(".zu-top-nav-userinfo img.avatar").attr({src:b.src.url}),l())},m,this);var q=$("form",c);q.validate({submitHandler:function(b){var c=this;$.post("/node/HomeGuideV2",{method:"add_headline",params:{headline:$("input",b).val()}},function(b){b&&b.r?263===b.errcode?c.showErrors({headline:"介绍过长"}):c.showErrors({headline:"保存失败"}):l()})},messages:{headline:{required:"不能为空",maxlength:"介绍过长"}},rules:{headline:{maxlength:40}},errorPlacement:function(b){b.appendTo(q)},focusCleanup:j,focusInvalid:m})}var r=
$("#js-global-notify");if(r.length){var w=new gq;w.o(r[0]);Jr(w);$(".zu-global-notify-close",r).click(function(){var b=$(this).data("id");$.post("/notice/read",{nid:b});w.G();r.remove()})}b=sy.O();uy(b);var E=$("#js-debuts-entry .tour");E.length&&$(".close-button",E).click(function(){var b=$(this).data("feature");$.get("/notifeature",{feature:b});E.fadeOut(100,function(){E.remove()})})};a.Dy=function(){Th.call(this,k,m);this.pB="zh-lightbox-showing";this.CS="zh-lightbox-thumb";this.cf()};y(Dy,Th);ia(Dy);t=Dy.prototype;t.cf=function(){this.h().e(document,"click",this.mr)};
t.mr=function(b){b=b.target;if("IMG"===b.tagName&&F.has(b,this.CS)){var c=b.getAttribute("data-original");if(c)if(sb)window.open(c);else if(!Hc(b,k,"editable")){this.Ha('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="'+c+'" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="'+c+'" target="_blank">查看原图</a></div></div></div>');this.D(j);F.add(this.m(),"zm-light-box-fullscreen-image");
var c=Xb(),d=J("zm-light-box-x1"),e=J("zm-light-box-x2"),g=b.getAttribute("data-rawheight"),h=b.getAttribute("data-rawwidth"),h=h?+h:0;(g?+g:0)>c.height-80?e.style.marginTop="40px":d.style.lineHeight=c.height+"px";e.style.width=h>c.width-80?c.width-80+"px":h+"px";Y.ia({type:"ga_click_enlarge_image",target:b})}}};t.fa=ha;t.focus=ha;t.rM=function(){this.D(m);F.remove(document.body,this.pB)};t.Uh=function(){Dy.n.Uh.call(this);F.add(document.body,this.pB);me(this.h(),document,"click",this.rM)};
t.v=function(){Dy.n.v.call(this);F.add(this.m(),"zm-light-box")};t.Kx=function(){this.Mc=this.J().v("div",this.Ac+"-bg zm-light-box-background");R(this.Mc,m)};Dy.O();a.Ey=function(b,c,d){Pt.call(this,b,c,d);this.fi(j)};y(Ey,Pt);Ey.prototype.Ud=function(){return this.dispatchEvent("action")};Rn("goog-option",function(){return new Ey(k)});a.Fy=function(){};y(Fy,qo);ia(Fy);Fy.prototype.v=function(b){return b.J().v("div",this.L()+" goog-inline-block"," ")};Fy.prototype.o=function(b,c){c=Fy.n.o.call(this,b,c);F.add(c,"goog-inline-block");return c};Fy.prototype.L=s("goog-toolbar-separator");a.Gy=function(){};y(Gy,so);ia(Gy);Gy.prototype.pc=function(){return Uc.HI};Gy.prototype.pn=function(b){return"HR"==b.tagName?new ro(Fy.O()):Gy.n.pn.call(this,b)};Gy.prototype.L=s("goog-toolbar");Gy.prototype.dw=function(){return uo};a.Hy=function(){};y(Hy,Pn);ia(Hy);t=Hy.prototype;t.v=function(b){var c={"class":"goog-inline-block "+this.Ze(b).join(" "),title:b.Mf()||""},c=b.J().v("div",c,this.Hi(b.ab(),b.J()));Mn(this,b,c);return c};t.pc=function(){return Uc.Fp};t.U=function(b){return b&&b.firstChild.firstChild};t.Hi=function(b,c){return c.v("div","goog-inline-block "+(this.L()+"-outer-box"),c.v("div","goog-inline-block "+(this.L()+"-inner-box"),b))};t.nc=function(b){return"DIV"==b.tagName};
t.o=function(b,c){Iy(c,j);Iy(c,m);var d;a:{d=b.J().bD(c);var e=this.L()+"-outer-box";if(d&&F.has(d,e)&&(d=b.J().bD(d),e=this.L()+"-inner-box",d&&F.has(d,e))){d=j;break a}d=m}d||c.appendChild(this.Hi(c.childNodes,b.J()));F.add(c,"goog-inline-block",this.L());return Hy.n.o.call(this,b,c)};t.L=s("goog-custom-button");
a.Iy=function(b,c){if(b)for(var d=c?b.firstChild:b.lastChild,e;d&&d.parentNode==b;){e=c?d.nextSibling:d.previousSibling;if(3==d.nodeType){var g=d.nodeValue;if(""==La(g))b.removeChild(d);else{d.nodeValue=c?g.replace(/^[\s\xa0]+/,""):Na(g);break}}else break;d=e}};a.Jy=function(){};y(Jy,Hy);ia(Jy);Jy.prototype.L=s("goog-toolbar-button");a.Ky=function(b,c,d){$n.call(this,b,c||Jy.O(),d)};y(Ky,$n);Rn("goog-toolbar-button",function(){return new Ky(k)});a.Ly=function(){};y(Ly,Hy);ia(Ly);B&&(Ly.prototype.Ha=function(b,c){var d=Ly.n.U.call(this,b&&b.firstChild);d&&lc(this.createCaption(c,Rb(b)),d)});t=Ly.prototype;t.U=function(b){b=Ly.n.U.call(this,b&&b.firstChild);B&&(b&&b.__goog_wrapper_div)&&(b=b.firstChild);return b};t.o=function(b,c){var d=Tb("*","goog-menu",c)[0];if(d){R(d,m);Qb(d).body.appendChild(d);var e=new St;e.o(d);b.Vg(e)}return Ly.n.o.call(this,b,c)};
t.Hi=function(b,c){return Ly.n.Hi.call(this,[this.createCaption(b,c),c.v("div","goog-inline-block "+(this.L()+"-dropdown")," ")],c)};t.createCaption=function(b,c){return My(b,this.L(),c)};a.My=function(b,c,d){return d.v("div","goog-inline-block "+(c+"-caption"),b)};t.L=s("goog-menu-button");a.Ny=function(){};y(Ny,Ly);ia(Ny);Ny.prototype.createCaption=function(b,c){return Ny.n.createCaption.call(this,Oy(b,c),c)};a.Oy=function(b,c){return c.v("div","goog-color-menu-button-indicator",b)};Ny.prototype.Aa=function(b,c){b&&Py(this.U(b),c)};a.Py=function(b,c){if(b&&b.firstChild){var d;d=c&&(Zr.test("#"==c.charAt(0)?c:"#"+c)||ws(c).length||ys&&ys[c.toLowerCase()])?ht(c).xr:k;b.firstChild.style.borderBottomColor=d||(A?"":"transparent")}};
Ny.prototype.ve=function(b){this.Aa(b.m(),b.W());F.add(b.m(),"goog-color-menu-button");Ny.n.ve.call(this,b)};a.Qy=function(){};y(Qy,Kn);ia(Qy);a.Ry=0;t=Qy.prototype;t.v=function(b){var c=this.Ze(b);return b.J().v("div",c?c.join(" "):k,Sy(this,b.ab(),b.ll(),b.J()))};a.Sy=function(b,c,d,e){for(var g=[],h=0,l=0;h<d.height;h++){for(var n=[],q=0;q<d.width;q++){var r=c&&c[l++];n.push(Ty(b,r,e))}g.push(e.v("tr",b.L()+"-row",n))}return b.bv(g,e)};t.bv=function(b,c){var d=c.v("table",this.L()+"-table",c.v("tbody",this.L()+"-body",b));d.cellSpacing=0;d.cellPadding=0;Lc(d,"grid");return d};
a.Ty=function(b,c,d){b=d.v("td",{"class":b.L()+"-cell",id:b.L()+"-cell-"+Ry++},c);Lc(b,"gridcell");return b};t.nc=s(m);t.o=s(k);
t.Ha=function(b,c){if(b){var d=Tb("tbody",this.L()+"-body",b)[0];if(d){var e=0;z.forEach(d.rows,function(b){z.forEach(b.cells,function(b){hc(b);if(c){var d=c[e++];d&&b.appendChild(d)}})});if(e<c.length){for(var g=[],h=Rb(b),l=d.rows[0].cells.length;e<c.length;){var n=c[e++];g.push(Ty(this,n,h));g.length==l&&(n=h.v("tr",this.L()+"-row",g),d.appendChild(n),g.length=0)}if(0<g.length){for(;g.length<l;)g.push(Ty(this,"",h));n=h.v("tr",this.L()+"-row",g);d.appendChild(n)}}}rg(b,j,B)}};
a.Uy=function(b,c,d){for(c=c.m();d&&1==d.nodeType&&d!=c;){if("TD"==d.tagName&&F.has(d,b.L()+"-cell"))return d.firstChild;d=d.parentNode}return k},a.Vy=function(b,c,d,e){d&&(d=d.parentNode,F.enable(d,b.L()+"-cell-hover",e),Mc(c.m().firstChild,"activedescendent",d.id))};t.L=s("goog-palette");a.Xy=function(b){N.call(this);this.xd=[];Wy(this,b)};y(Xy,Fd);t=Xy.prototype;t.Zf=k;t.lf=k;t.hl=function(){return this.xd.length};t.Eh=function(b){return this.xd[b]||k};a.Wy=function(b,c){c&&(z.forEach(c,function(b){this.cm(b,m)},b),z.extend(b.xd,c))};t.Fa=function(b){this.zi(b,this.hl())};t.zi=function(b,c){b&&(this.cm(b,m),z.In(this.xd,b,c))};t.removeItem=function(b){b&&z.remove(this.xd,b)&&b==this.Zf&&(this.Zf=k,this.dispatchEvent("select"))};t.zg=p("Zf");t.Hb=function(){return z.clone(this.xd)};
t.mf=function(b){b!=this.Zf&&(this.cm(this.Zf,m),this.Zf=b,this.cm(b,j));this.dispatchEvent("select")};t.kl=function(){return this.Zf?z.indexOf(this.xd,this.Zf):-1};t.Ro=function(b){this.mf(this.Eh(b))};t.clear=function(){z.clear(this.xd);this.Zf=k};t.w=function(){Xy.n.w.call(this);delete this.xd;this.Zf=k};t.cm=function(b,c){b&&("function"==typeof this.lf?this.lf(b,c):"function"==typeof b.gm&&b.gm(c))};a.Yy=function(b,c,d){Tn.call(this,b,c||Qy.O(),d);this.Ci&=-89};y(Yy,Tn);t=Yy.prototype;t.ic=k;t.Db=-1;t.la=k;t.w=function(){Yy.n.w.call(this);this.la&&(this.la.G(),this.la=k);this.ic=k};t.em=function(b){Yy.n.em.call(this,b);Zy(this);this.la?(this.la.clear(),Wy(this.la,b)):(this.la=new Xy(b),b=v(this.cm,this),this.la.lf=b,this.h().e(this.la,"select",this.gj));this.Db=-1};t.xg=s("");t.dm=ba();
t.hd=function(b){Yy.n.hd.call(this,b);var c=Uy(this.M,this,b.target);(!c||!b.relatedTarget||!rc(c,b.relatedTarget))&&c!=$y(this)&&az(this,c)};t.Hh=function(b){Yy.n.Hh.call(this,b);var c=Uy(this.M,this,b.target);(!c||!b.relatedTarget||!rc(c,b.relatedTarget))&&c==$y(this)&&Vy(this.M,this,c,m)};t.se=function(b){Yy.n.se.call(this,b);this.Xb()&&(b=Uy(this.M,this,b.target),b!=$y(this)&&az(this,b))};t.Ud=function(b){var c=$y(this);return c?(this.mf(c),Yy.n.Ud.call(this,b)):m};
t.Vb=function(b){var c=this.ab(),c=c?c.length:0,d=this.ic.width;if(0==c||!this.isEnabled())return m;if(13==b.keyCode||32==b.keyCode)return this.Ud(b);if(36==b.keyCode)return this.Mb(0),j;if(35==b.keyCode)return this.Mb(c-1),j;var e=0>this.Db?this.kl():this.Db;switch(b.keyCode){case 37:-1==e&&(e=c);if(0<e)return this.Mb(e-1),b.preventDefault(),j;break;case 39:if(e<c-1)return this.Mb(e+1),b.preventDefault(),j;break;case 38:-1==e&&(e=c+d-1);if(e>=d)return this.Mb(e-d),b.preventDefault(),j;break;case 40:if(-1==
e&&(e=-d),e<c-d)return this.Mb(e+d),b.preventDefault(),j}return m};t.gj=ba();t.ll=p("ic");a.bz=function(b,c){b.m()&&f(Error("Component already rendered"));b.ic=pa(c)?new Nb(c,i):c;Zy(b)},a.$y=function(b){var c=b.ab();return c&&c[b.Db]};t.Mb=function(b){b!=this.Db&&(cz(this,this.Db,m),this.Db=b,cz(this,b,j))};a.az=function(b,c){var d=b.ab();b.Mb(d?z.indexOf(d,c):-1)};t.kl=function(){return this.la?this.la.kl():-1};t.zg=function(){return this.la?this.la.zg():k};t.Ro=function(b){this.la&&this.la.Ro(b)};
t.mf=function(b){this.la&&this.la.mf(b)};a.cz=function(b,c,d){if(b.m()){var e=b.ab();e&&(0<=c&&c<e.length)&&Vy(b.M,b,e[c],d)}};t.cm=function(b,c){this.m()&&b&&F.enable(b.parentNode,this.M.L()+"-cell-selected",c)};a.Zy=function(b){var c=b.ab();if(c)if(b.ic&&b.ic.width){if(c=Math.ceil(c.length/b.ic.width),!pa(b.ic.height)||b.ic.height<c)b.ic.height=c}else c=Math.ceil(Math.sqrt(c.length)),b.ic=new Nb(c,c);else b.ic=new Nb(0,0)};a.dz=function(b,c,d){this.uq=b||[];Yy.call(this,k,c||Qy.O(),d);this.uq=this.uq;this.vs=k;this.Ha(z.map(this.uq,function(b){var c=this.J().v("div",{"class":this.M.L()+"-colorswatch",style:"background-color:"+b});"#"==b.charAt(0)&&(b=xs(b),b="RGB ("+[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)].join(", ")+")");c.title=b;return c},this))};y(dz,Yy);dz.prototype.vs=k;dz.prototype.mw=function(){var b=this.zg();return b?(b=lt(b,"background-color"),ez(b)):k};
dz.prototype.Qo=function(b){b=ez(b);this.vs||(this.vs=z.map(this.uq,function(b){return ez(b)}));this.Ro(b?z.indexOf(this.vs,b):-1)};a.ez=function(b){if(b)try{return ht(b).xr}catch(c){}return k};a.fz=function(b,c,d,e){Rs.call(this,b,c,d||e);if(d||e)this.fm(65|(e?32:132))};y(fz,Rs);a.gz=function(b,c,d,e){$n.call(this,b,d||Ly.O(),e);Wn(this,64,j);this.Dl=new fz(k,5);c&&this.Vg(c);this.ZE=k;this.na=new Hd(500);if((Kg||Lg)&&!D("533.17.9"))this.Vr=j};y(gz,$n);t=gz.prototype;t.Vr=m;t.Vl=m;t.B=function(){gz.n.B.call(this);this.qa&&hz(this,this.qa,j);Mc(this.m(),Tc.sk,"true")};t.ib=function(){gz.n.ib.call(this);if(this.qa){this.qb(m);this.qa.ib();hz(this,this.qa,m);var b=this.qa.m();b&&M(b)}};t.w=function(){gz.n.w.call(this);this.qa&&(this.qa.G(),delete this.qa);delete this.DQ;this.na.G()};
t.se=function(b){gz.n.se.call(this,b);this.Xb()&&(this.qb(!this.ob(),b),this.qa&&(b=this.ob(),this.qa.Rf=b))};t.Nf=function(b){gz.n.Nf.call(this,b);this.qa&&!this.Xb()&&(this.qa.Rf=m)};t.Ud=function(){this.setActive(m);return j};t.$L=function(b){this.qa&&(this.qa.P()&&!this.Af(b.target))&&this.qb(m)};t.Af=function(b){return b&&rc(this.m(),b)||this.qa&&this.qa.Af(b)||m};
t.bf=function(b){if(32==b.keyCode){if(b.preventDefault(),"keyup"!=b.type)return j}else if("key"!=b.type)return m;if(this.qa&&this.qa.P()){var c=this.qa.Vb(b);return 27==b.keyCode?(this.qb(m),j):c}return 40==b.keyCode||38==b.keyCode||32==b.keyCode||13==b.keyCode?(this.qb(j),j):m};t.wn=function(){this.qb(m)};t.BM=function(){this.Xb()||this.qb(m)};t.Qc=function(b){this.Vr||this.qb(m);gz.n.Qc.call(this,b)};t.Va=function(){this.qa||this.Vg(new St(this.J()));return this.qa||k};
t.Vg=function(b){var c=this.qa;if(b!=c&&(c&&(this.qb(m),this.za&&hz(this,c,m),delete this.qa),b)){this.qa=b;Kh(b,this);b.D(m);var d=this.Vr;(b.zm=d)&&b.Ie(j);this.za&&hz(this,b,j)}return c};a.iz=function(b){b.ZE=new Nf(7,0,7,0)};t.Fa=function(b){this.Va().H(b,j)};t.zi=function(b,c){this.Va().vk(b,c,j)};t.removeItem=function(b){(b=this.Va().removeChild(b,j))&&b.G()};t.Eh=function(b){return this.qa?Nh(this.qa,b):k};t.hl=function(){return this.qa?Mh(this.qa):0};
t.D=function(b,c){var d=gz.n.D.call(this,b,c);d&&!this.P()&&this.qb(m);return d};t.Xa=function(b){gz.n.Xa.call(this,b);this.isEnabled()||this.qb(m)};a.jz=function(b){b.Dl.fm&&b.Dl.fm(33)};t.XG=function(){this.qb(j)};
t.qb=function(b,c){gz.n.qb.call(this,b);if(this.qa&&!!(this.Z&64)==b){if(b)this.qa.za||(this.Vl?this.qa.X(this.m().parentNode):this.qa.X()),this.fk=eg(this.m()),this.Ei=ng(this.m()),kz(this),this.qa.Mb(-1);else if(this.setActive(m),this.qa.Rf=m,this.m()&&Mc(this.m(),Tc.um,""),this.Ds!=k){this.Ds=i;var d=this.qa.m();d&&kg(d,"","")}this.qa.D(b,m,c);if(!this.ug){var d=this.h(),e=b?d.e:d.Ea;e.call(d,this.J().Ca(),"mousedown",this.$L,j);this.Vr&&e.call(d,this.qa,"blur",this.BM);e.call(d,this.na,Id,this.Jl);
b?this.na.start():this.na.stop()}}};a.kz=function(b){if(b.qa.za){var c=b.Dl;b.Dl.element=b.DQ||b.m();var d=b.qa.m();b.qa.P()||(d.style.visibility="hidden",R(d,j));!b.Ds&&(b.Dl.qn&&b.Dl.qn()&32)&&(b.Ds=mg(d));c.fa(d,c.Bf^1,b.ZE,b.Ds);b.qa.P()||(R(d,m),d.style.visibility="visible")}};
t.Jl=function(){var b=ng(this.m()),c=eg(this.m());if(!(this.Ei==b||(!this.Ei||!b?0:this.Ei.left==b.left&&this.Ei.width==b.width&&this.Ei.top==b.top&&this.Ei.height==b.height))||!(this.fk==c||(!this.fk||!c?0:this.fk.top==c.top&&this.fk.right==c.right&&this.fk.bottom==c.bottom&&this.fk.left==c.left)))this.Ei=b,this.fk=c,kz(this)};a.hz=function(b,c,d){var e=b.h(),d=d?e.e:e.Ea;d.call(e,c,"action",b.wn);d.call(e,c,"highlight",b.Cw);d.call(e,c,"unhighlight",b.Kw)};t.Cw=function(b){Mc(this.m(),Tc.um,b.target.m().id)};
t.Kw=function(){Ls(this.qa)||Mc(this.m(),Tc.um,"")};Rn("goog-menu-button",function(){return new gz(k)});a.lz=function(b,c,d,e){gz.call(this,b,c,d||Ny.O(),e)};y(lz,gz);
a.mz={dU:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),mV:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),RU:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")},a.nz=
function(b){var c=new St(b);G.forEach(mz,function(d){d=new dz(d,k,b);bz(d,8);c.H(d,j)});return c};t=lz.prototype;t.mw=function(){return this.W()};t.Qo=function(b){this.Aa(b)};t.Aa=function(b){for(var c=0,d;d=this.Eh(c);c++)"function"==typeof d.Qo&&d.Qo(b);lz.n.Aa.call(this,b)};t.wn=function(b){"function"==typeof b.target.mw?this.Aa(b.target.mw()):"none"==b.target.W()&&this.Aa(k);lz.n.wn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.qb=function(b,c){b&&0==this.hl()&&(this.Vg(nz(this.J())),this.Aa(this.W()));lz.n.qb.call(this,b,c)};Rn("goog-color-menu-button",function(){return new lz(k)});a.oz=function(){};y(oz,Ly);ia(oz);oz.prototype.L=s("goog-toolbar-menu-button");a.pz=function(){};y(pz,oz);ia(pz);pz.prototype.createCaption=function(b,c){return My(Oy(b,c),this.L(),c)};pz.prototype.Aa=function(b,c){b&&Py(this.U(b),c)};pz.prototype.ve=function(b){this.Aa(b.m(),b.W());F.add(b.m(),"goog-toolbar-color-menu-button");pz.n.ve.call(this,b)};a.qz=function(b,c,d,e){lz.call(this,b,c,d||pz.O(),e)};y(qz,lz);Rn("goog-toolbar-color-menu-button",function(){return new qz(k)});a.rz=function(b,c,d,e){gz.call(this,b,c,d||oz.O(),e)};y(rz,gz);Rn("goog-toolbar-menu-button",function(){return new rz(k)});a.tz=function(b,c,d,e){gz.call(this,b,c,d,e);sz(this,b);this.Oo(Uc.AA)};y(tz,gz);t=tz.prototype;t.la=k;t.mv=k;t.B=function(){tz.n.B.call(this);uz(this);vz(this);Mc(this.m(),Tc.sk,"false")};t.$=function(b){tz.n.$.call(this,b);(b=this.xg())?sz(this,b):this.Ro(0)};t.w=function(){tz.n.w.call(this);this.la&&(this.la.G(),this.la=k);this.mv=k};t.wn=function(b){this.mf(b.target);tz.n.wn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.gj=function(){var b=this.zg();tz.n.Aa.call(this,b&&b.W());uz(this)};t.Vg=function(b){var c=tz.n.Vg.call(this,b);b!=c&&(this.la&&this.la.clear(),b&&(this.la?Lh(b,function(b){wz(b);this.la.Fa(b)},this):xz(this,b)));return c};a.sz=function(b,c){b.mv=c;uz(b)};t.Fa=function(b){wz(b);tz.n.Fa.call(this,b);this.la?this.la.Fa(b):xz(this,this.Va())};t.zi=function(b,c){wz(b);tz.n.zi.call(this,b,c);this.la?this.la.zi(b,c):xz(this,this.Va())};t.removeItem=function(b){tz.n.removeItem.call(this,b);this.la&&this.la.removeItem(b)};
t.mf=function(b){if(this.la){var c=this.zg();this.la.mf(b);b!=c&&this.dispatchEvent("change")}};t.Ro=function(b){this.la&&this.mf(this.la.Eh(b))};t.Aa=function(b){if(b!=k&&this.la)for(var c=0,d;d=this.la.Eh(c);c++)if(d&&"function"==typeof d.W&&d.W()==b){this.mf(d);return}this.mf(k)};t.zg=function(){return this.la?this.la.zg():k};t.kl=function(){return this.la?this.la.kl():-1};
a.xz=function(b,c){b.la=new Xy;c&&Lh(c,function(b){wz(b);this.la.Fa(b)},b);vz(b)},a.vz=function(b){b.la&&b.h().e(b.la,"select",b.gj)},a.uz=function(b){var c=b.zg();b.Ha(c?c.xg():b.mv)},a.wz=function(b){b.Oo(b instanceof Pt?Uc.DA:Uc.AI)};t.qb=function(b,c){tz.n.qb.call(this,b,c);this.ob()&&this.Va().Mb(this.kl())};Rn("goog-select",function(){return new tz(k)});a.yz=function(b,c,d,e){tz.call(this,b,c,d||oz.O(),e)};y(yz,tz);Rn("goog-toolbar-select",function(){return new yz(k)});a.zz=function(b){var c=b.indexOf(",");a:{b=(-1!=c?b.substring(0,c):b).toLowerCase();for(c=0;2>c;c++){var d="\"'".charAt(c);if(b.charAt(0)==d&&b.charAt(b.length-1)==d){b=b.substring(1,b.length-1);break a}}}return b},a.Az=function(b,c){z.forEach(c,function(c){var e=c.caption,c=c.value,g=zz(c),e=new Ey(e,c,b.J());Ih(e,g);b.Fa(e);e.U().style.fontFamily=c})},a.Bz=[10,10,13,16,18,24,32,48],a.Dz=function(b,c,d,e,g,h){d=new Ky(Cz(d,e,h),g,h);Ih(d,b);d.Kc(c);return d},a.Ez=function(b,c,d,e,g,h){b=Dz(b,c,d,
e,g,h);Wn(b,16,j);return b},a.Fz=function(b,c,d,e,g,h){g=new yz(k,k,g,h);e&&z.forEach(e.split(/\s+/),g.kh,g);g.kh("goog-toolbar-select");sz(g,d);Ih(g,b);g.Kc(c);return g},a.Gz=function(b,c,d,e,g,h){d=new qz(Cz(d,e,h),k,g,h);Ih(d,b);d.Kc(c);return d},a.Cz=function(b,c,d){if((!b||""==b)&&B&&!D("1.9a"))b=" ";return(d||Rb()).v("DIV",c?{"class":c}:k,b)};a.Hz=x("Link");x("Edit Link");x("Text to display:");a.Iz=x("Link to:");x("Web address");x("Link to a page or file somewhere else on the web");x("Test this link");
x("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});x("To what URL should this link go?");x("Email address");x("Link to an email address");x("Invalid email address");
x("To what email address should this link?");x("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});x("Open this link in a new window");x("Image");a.Jz={},a.Kz=x("Normal"),a.Lz=x("Normal / serif"),a.Mz=[{caption:Kz,value:"arial,sans-serif"},{caption:Lz,value:"times new roman,serif"},{caption:"Courier New",value:"courier new,monospace"},{caption:"Georgia",value:"georgia,serif"},{caption:"Trebuchet",value:"trebuchet ms,sans-serif"},{caption:"Verdana",value:"verdana,sans-serif"}],a.Nz={ja:[{caption:"ＭＳ Ｐゴシック",value:"ms pgothic,sans-serif"},{caption:"ＭＳ Ｐ明朝",value:"ms pmincho,serif"},{caption:"ＭＳ ゴシック",value:"ms gothic,monospace"}],ko:[{caption:"굴림",
value:"gulim,sans-serif"},{caption:"바탕",value:"batang,serif"},{caption:"굴림체",value:"gulimche,monospace"}],"zh-tw":[{caption:"新細明體",value:"pmingliu,serif"},{caption:"細明體",value:"mingliu,serif"}],"zh-cn":[{caption:"宋体",value:"simsun,serif"},{caption:"黑体",value:"simhei,sans-serif"},{caption:"MS Song",value:"ms song,monospace"}]},a.Oz=x("Small"),a.Pz=x("Normal"),a.Qz=x("Large"),a.Rz=x("Huge"),a.Sz=[{caption:Oz,value:1},{caption:Pz,value:2},{caption:Qz,value:4},{caption:Rz,value:6}],a.Tz=x("Heading"),
a.Uz=x("Subheading"),a.Vz=x("Minor heading"),a.Wz=x("Normal"),a.Xz=[{caption:Tz,wa:"H2"},{caption:Uz,wa:"H3"},{caption:Vz,wa:"H4"},{caption:Wz,wa:"P"}],a.Yz=function(b,c,d,e,g,h){var l=Dz(b,c,d,e,g,h);l.ni=function(b){l.Xa(b)};return l},a.Zz=function(b,c){var d=c;try{if(A)var e="000000"+d.toString(16),g=e.substr(e.length-6,6),d="#"+g.substring(4,6)+g.substring(2,4)+g.substring(0,2);d!=b.W()&&b.Aa(d)}catch(h){}},a.$z=x("Format"),a.aA=x("Format"),a.bA=x("Undo"),a.cA=x("Redo"),a.dA=x("Font"),a.eA=x("Font size"),
a.fA=x("Text color"),a.gA=x("Bold"),a.hA=x("Italic"),a.iA=x("Underline"),a.jA=x("Text background color"),a.kA=x("Add or remove link"),a.lA=x("Numbered list"),a.mA=x("Bullet list"),a.nA=x("Decrease indent"),a.oA=x("Increase indent"),a.pA=x("Align left"),a.qA=x("Align center"),a.rA=x("Align right"),a.sA=x("Justify"),a.tA=x("Remove formatting"),a.uA=x("Insert image"),a.vA=x("Strikethrough"),a.wA=x("Left-to-right"),a.xA=x("Right-to-left"),a.yA=x("Quote"),a.zA=x("Edit HTML source"),a.AA=x("Subscript"),
a.BA=x("Superscript"),a.CA=x("Edit HTML"),a.DA={};
Jz.yA=[{wa:"+undo",R:bA,La:"tr-icon tr-undo",factory:Yz,cb:j},{wa:"+redo",R:cA,La:"tr-icon tr-redo",factory:Yz,cb:j},{wa:"+fontName",R:dA,La:"tr-fontName",factory:function(b,c,d,e,g,h){var l=Fz(b,c,d,e,g,h),b="en-us".replace(/_/,"-").toLowerCase(),c=[];b in Nz&&(c=Nz[b]);c.length&&Az(l,c);Az(l,Mz);sz(l,Kz);F.add(l.Va().U(),"goog-menu-noaccel");l.ni=function(b){var c=k;b&&0<b.length&&(c=Jh(l.Va(),zz(b)));c!=l.zg()&&l.mf(c)};return l},cb:j},{wa:"+fontSize",R:eA,La:"tr-fontSize",factory:function(b,c,
d,e,g,h){var l=Fz(b,c,d,e,g,h);z.forEach(Sz,function(b){var c=b.value,b=new Ey(b.caption,c,l.J());l.Fa(b);b=b.U();b.style.fontSize=(Bz[c]||10)+"px";b.firstChild.style.height="1.1em"});sz(l,Pz);F.add(l.Va().U(),"goog-menu-noaccel");l.ni=function(b){var c;if(c=oa(b))c=b.match(zs),c="px"==(c&&c[0]||k);c&&(b=z.lastIndexOf(Bz,parseInt(b,10)));b=0<b?b:k;b!=l.W()&&l.Aa(b)};return l},cb:j},{wa:"+bold",R:gA,La:"tr-icon tr-bold",cb:j},{wa:"+italic",R:hA,La:"tr-icon tr-italic",cb:j},{wa:"+underline",R:iA,La:"tr-icon tr-underline",
cb:j},{wa:"+foreColor",R:fA,La:"tr-icon tr-foreColor",factory:function(b,c,d,e,g,h){b=Gz(b,c,d,e,g,h);b.Qo("#000");b.ni=xa(Zz,b);return b},cb:j},{wa:"+backColor",R:jA,La:"tr-icon tr-backColor",factory:function(b,c,d,e,g,h){b=Gz(b,c,d,e,g,h);b.Qo("#FFF");b.ni=xa(Zz,b);return b},cb:j},{wa:"+link",R:kA,caption:Hz,La:"tr-link",cb:j},{wa:"+insertOrderedList",R:lA,La:"tr-icon tr-insertOrderedList",cb:j},{wa:"+insertUnorderedList",R:mA,La:"tr-icon tr-insertUnorderedList",cb:j},{wa:"+outdent",R:nA,La:"tr-icon tr-outdent",
factory:Dz},{wa:"+indent",R:oA,La:"tr-icon tr-indent",factory:Dz},{wa:"+justifyLeft",R:pA,La:"tr-icon tr-justifyLeft",cb:j},{wa:"+justifyCenter",R:qA,La:"tr-icon tr-justifyCenter",cb:j},{wa:"+justifyRight",R:rA,La:"tr-icon tr-justifyRight",cb:j},{wa:"+justifyFull",R:sA,La:"tr-icon tr-justifyFull",cb:j},{wa:"+removeFormat",R:tA,La:"tr-icon tr-removeFormat",factory:Dz},{wa:"image",R:uA,La:"tr-icon tr-image",factory:Dz},{wa:"+strikeThrough",R:vA,La:"tr-icon tr-strikeThrough",cb:j},{wa:"+subscript",R:AA,
La:"tr-icon tr-subscript",cb:j},{wa:"+superscript",R:BA,La:"tr-icon tr-superscript",cb:j},{wa:"ltr",R:wA,La:"tr-icon tr-ltr",cb:j},{wa:"rtl",R:xA,La:"tr-icon tr-rtl",factory:function(b,c,d,e,g,h){var l=Ez(b,c,d,e,g,h);l.ni=function(b){b=!!b;F.enable(l.getParent().m(),"tr-rtl-mode",b);l.Wc(b)};return l},cb:j},{wa:"+BLOCKQUOTE",R:yA,La:"tr-icon tr-BLOCKQUOTE",cb:j},{wa:"+formatBlock",R:$z,caption:aA,La:"tr-formatBlock",factory:function(b,c,d,e,g,h){var l=Fz(b,c,d,e,g,h);z.forEach(Xz,function(b){var c=
b.caption,b=b.wa,d=l.J(),c=new Ey(d.v("DIV",k,c),b,d);Ih(c,b);l.Fa(c)});sz(l,Wz);F.add(l.Va().U(),"goog-menu-noaccel");l.ni=function(b){b=b&&0<b.length?b:k;b!=l.W()&&l.Aa(b)};return l},cb:j},{wa:"editHtml",R:zA,caption:CA,La:"tr-editHtml",factory:Dz}];for(var EA=0,FA;FA=Jz.yA[EA];EA++)DA[FA.wa]=FA;delete Jz.yA;a.GA={};GA.PS=Gk;a.HA=function(b){Hu.call(this);this.ca=new ke(this);this.PD=L("div",{style:"display:none"});this.g=this.oc=k;this.F={};G.extend(this.F,this.defaults,b||{})};y(HA,Hu);ya(HA.prototype,GA);HA.prototype.defaults={ek:k,title:"Distraction Free Mode",CJ:"back",wR:"publish",Zv:"zu-editing-distraction-free",mS:"sticky-goog-scrollfloater",MS:"zm-editable-toolbar-container"};HA.prototype.gd=kf("FullScreenPlugin");DA.toggleFullScreen={wa:"toggleFullScreen",R:"写作模式",La:"tr-icon tr-max",factory:Dz};t=HA.prototype;
t.ye=xa(G.qg,{xV:"toggleFullScreen",UT:"enterFullScreen",VT:"exitFullScreen"});t.w=function(){this.ca.G();M(this.g);this.F=this.hp=this.oc=this.rb=this.g=k;HA.n.w.call(this)};
t.Ju=function(){var b=this.F,c=document.createElement("div");c.id="zu-distraction-free-editor";c.innerHTML='<div class="header"><div class="wrapper"><h1 class="title">'+b.title+'</h1><a href="#" class="'+b.CJ+'" name="return">返回</a><a href="#" class="'+b.wR+'" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>';document.body.appendChild(c);this.ca.e(K("back",c),"click",function(b){b.preventDefault();IA(this)},m,this);this.ca.e(K("publish",
c),"click",function(b){b.preventDefault();this.dispatchEvent("save")&&IA(this)},m,this);this.g=c;this.oc=K("content",c);this.hp=L("div",{className:"toolbar-info"});this.F.ek||(this.F.ek=this.C.field)};a.JA=function(b){if(b.hp){var c=$(b.hp);c.stop().text("草稿已经保存").fadeTo(600,0.5).delay(3E3).fadeOut(600,function(){c.text("")})}};t.We=function(b){this.g||this.Ju();switch(b){case "enterFullScreen":KA(this);break;case "exitFullScreen":IA(this);break;case "toggleFullScreen":this.lx()?IA(this):KA(this)}};
t.lx=function(){return F.has(document.body,this.F.Zv)};
a.KA=function(b){if(b.dispatchEvent("willEnterFullScreen")){b.AC||(b.lN=history.length);b.AC=j;LA(b,"writing");b.TH=Kc(Rb((fa||window).document));lc(b.PD,b.F.ek);b.oc.appendChild(b.F.ek);F.add(document.body,b.F.Zv);b.rb=K(b.F.MS,b.g);b.rb.appendChild(b.hp);var c=b.g;c.scrollTop=0;var d=b.rb.getBoundingClientRect().top;c.onscroll=of(v(b.TG,b),function(){return c.scrollTop>d});b.ca.e(document,"keydown",b.po,m,b);La(Ec(b.C.field))||b.C.Lf();b.dispatchEvent("enterFullScreen")}},a.IA=function(b){!Lg&&
b.AC&&b.lN!==history.length?history.back():LA(b,"");b.rb.removeChild(b.hp);b.TG(m);b.g.onscroll=k;b.ca.Ea(document,"keydown",b.po,m,b);lc(b.F.ek,b.PD);F.remove(document.body,b.F.Zv);window.scrollTo(b.TH.x,b.TH.y);b.dispatchEvent("exitFullScreen")},a.LA=function(b,c){wd(window,"hashchange",b.AF,m,b);location.hash=c||"";setTimeout(v(function(){this.ca.e(window,"hashchange",this.AF,m,this)},b))};t.AF=function(){this.lx()?IA(this):"writing"===location.hash.slice(1)&&KA(this)};
t.po=function(b){27===b.keyCode&&this.dispatchEvent("shouldExitFullScreenOnEscape")&&IA(this)};t.TG=function(b){F[b?"add":"remove"](this.rb,this.F.mS)};a.NA=function(b,c){N.call(this);this.Sf=b;this.oz=c||MA;b.mb||(this.show=ha)};y(NA,Qk);a.MA="加载中...";t=NA.prototype;
t.show=function(){jc(this.g=L("div","zg-mt10",[L("h3",{style:"margin:0 0 5px;"},"分享到微博"),L("div","zm-tab-content",[this.SV=L("div",{className:"zg-section zg-clear",innerHTML:'<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> '}),L("div","zg-section",L("div","zg-form-text-input",this.So=L("textarea",{style:"width:100%;height: 66px;"},"加载中..."))),L("div","zm-command",[L("div",["zm-item-meta","zg-left"],this.OR=
L("span")),this.oS=L("a",{"class":"zg-btn-blue weibo-share-button",href:"javascript:;"},"分享到微博")])])]),J("zh-question-answer-form-wrap"));this.h().e(Y,"sina_callback",function(b){this.kz(b.Hc.id,b.Hc.name)});this.yu();this.Hj();po.O().refresh();var b=this;this.oz===MA?Di("/answer/"+b.Sf.mb+"/sharetext",function(c){if((c=He(c.target))&&c.sina)b.oz=c.sina,b.gb()},"GET"):this.gb()};t.kz=function(b,c){oh.name=c;this.dS=oh.id=b;this.vc.checked=j;this.Hj()};
t.Hj=function(){var b=K("weibo-share-button",this.g),c=this.vc.checked;F.enable(b,"zg-btn-blue",c);F.enable(b,"zg-btn-disabled",!c)};t.gb=function(){this.So.value=this.oz;this.yz=new Tk(this.So);this.ZG=new ju(this.So,this.OR,140,hu);this.h().e(this.oS,"click",this.ra)};t.yu=function(){this.vc=K("sina-checkbox",this.g);this.h().e(this.vc,"change",this.oy)};t.oy=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.vc&&!this.dS?(window.open(c),b.checked=m):this.Hj()};
t.ra=function(b){if((b=b.target)&&F.has(b,"zg-btn-blue")&&this.So.value){b=new Dk(j);b.add("content",this.So.value);var c=[];this.vc.checked&&c.push("sina");b.add("via",c.join(","));this.Kj(b);Gk("share",this.SW?"answer_weibo":"question_weibo")}else U("请您选择或绑定微博后再进行分享！")};t.Kj=function(b){b.add("aid",this.Sf.oa);this.xhr=new V(j);me(this.h(),this.xhr,"complete",this.nu);this.xhr.ajax("/answer/share",b.fd())};t.nu=function(){var b=He(this.xhr);b&&b.r?U(b.msg):(U("分享发送完毕"),R(this.g,m))};a.OA=function(b,c,d){Pt.call(this,b,c,d);this.Jo(j)};y(OA,Pt);Rn("goog-checkbox-menuitem",function(){return new OA(k)});a.PA=function(b,c){N.call(this);this.ka=b;this.Rb=c;this.data=ch};y(PA,Qk);t=PA.prototype;
t.z=function(){this.Ul=J("zh-question-redirect-info");this.Ul.innerHTML&&(this.Qn=j);this.h().e(this.Ul,"click",function(b){"cancel"===b.target.name&&QA(this)});var b=J("zh-question-side-header-wrap");if(ah.uc&&!ah.vE&&b){var c=J("zh-question-filter-wrap");c?ic(b,c):b.style[A?"styleFloat":"cssFloat"]="none"}(this.Tf=J("zh-question-operation-menu"))&&this.nj();this.h().e(Ji,"anon_change",function(b){var c=J("zh-question-side-invitation-anon");c&&R(c,b.jb);(c=J("zh-question-side-invitation-notanon"))&&
R(c,!b.jb);this.Kl&&this.Kl.Xa($s(this.data.Rg)||!b.jb)});(this.ik=J("zh-question-webshare-container"))&&this.h().e(this.ik,"click",this.uz)};
t.nj=function(){this.bb=new St;var b=this.data.Am,c=this.Tf.getAttribute("data-auth"),c=c?c.split(","):[];if(b==k||0===b){this.bb.Fa(this.As=RA("使用匿名身份",j));this.As.Wc(this.data.jb);if((!jh||!z.contains(jh,"question_op_redirect"))&&"close"!==ch.status)this.bb.Fa(this.Kl=RA(this.Qn?"撤消重定向":"问题重定向")),this.Kl.Xa($s(this.data.Rg)||!this.data.jb);z.contains(c,"auth-f-manage")&&this.bb.Fa(this.hQ=RA("更新话题页显示",m));this.h().e(this.bb,"action",this.fj);this.As&&this.h().e(Ji,"anon_change",function(b){this.As.Wc(!!b.jb)});
this.Rb&&z.contains(c,"auth-pu-mark")&&(this.bb.Fa(this.qy=RA("优质回答",j)),this.qy.Wc(this.Rb.XN));b=new gz("Settings",this.bb);b.Vl=j;jz(b);b.o(this.Tf)}};a.RA=function(b,c){return!b?new Rt:c?new OA(b):new Pt(b)};
t.fj=function(b){var c=this.As;if(b.target===c)Qr(c.xe()?1:0,function(b){b||c.Wc(!c.xe())});else if(b.target===this.Kl){if(Ux({Sl:j})()===m)return m;this.wo||(this.wo=new xx(this.ka),this.h().e(this.wo,"change",this.yO));this.bb.D(m);this.Qn?QA(this):this.wo.show()}else b.target===this.cQ?Di("/question/"+this.data.mb+(this.cQ.xe()?"/unlock_summary":"/lock_summary"),function(){top!==window?top.location.href="/question/"+ch.mb:window.location.reload()},"POST"):b.target===this.hQ?$.post("/refresh_topic_feeds",
{q:ch.mb}).done(function(b){b.r||U("操作成功！")}):b.target===this.qy&&$.post("/answer/"+this.Rb.mb+(this.qy.xe()?"/good_mark":"/good_unmark")).done(function(b){b.r||U("操作成功！")})};t.yO=function(){this.Ul.innerHTML='<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/'+this.wo.$s+'">'+this.wo.iG+'</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>';R(this.Ul,j);this.Qn=j;this.Kl.dm("撤消重定向")};
a.QA=function(b){b.Ul.innerHTML="";R(b.Ul,m);b.Qn=m;b.Kl.dm("问题重定向");Di("/question/unredirect",k,"POST","qid="+b.ka+"&rqid="+b.$s)};t.uz=function(b){var c=Ck(this.ik,b.target);c&&c.name&&ol(function(){var b=$("#zh-question-webshare-container").data();new ku([b.title,b.type,b.urlToken,{answer:{aid:b.id},question:{qid:b.id}}[b.type]],"tb-webshare-"+c.name);Y.ia({type:"ga_click_share_question_box",target:c,data:{type:c.name}})},function(){return{ad:"letter"===c.name}})()};a.SA=function(b){Cq.call(this,j,"/topic/bio/update","bio");this.jp=b[0];this.params=["tid="+this.jp[3]];this.content=b[1];this.Gb='<a href="javascript:;" name="edit">描述你关于 '+this.jp[0]+" 的经验</a>";this.Lt=j};y(SA,Cq);SA.prototype.sh=function(){SA.n.sh.call(this);this.Hk.innerHTML="更新"};SA.prototype.$=function(b){SA.n.$.call(this,b);var b=this.J(),c=b.v("strong",k,L("a",{href:"/topic/"+this.jp[1],title:this.jp[0],"class":""},this.jp[0]));b.Jn(c,this.Pb)};a.TA=function(b,c){N.call(this);this.DN=c;this.Nk=b;this.items=[];this.UX="/url_to_fetch_question_related_topic_bio_items";this.Cx=m};y(TA,Qk);
a.UA=k,a.VA=function(){UA||(UA=new TA(eh,m));return UA},a.WA=function(b){if(!b.locked)if(!b.GO&&b.Cx){b.locked=j;var c=new V(j);b.h().e(c,"success",function(b){this.GO=j;this.locked=m;b=He(b.target);b.r||(this.Nk=b.msg,WA(this))});c.ajax("/question/"+b.sG+"/bios",k,"GET")}else b.S||(b.S=new vi,b.S.Ya("修改话题经验"),ei(b.S,k),Zh(b.S,m),c=b.S.U(),c.innerHTML='<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>',b.X(c)),b.S.D(j)};
TA.prototype.X=function(b){this.g=L("div","zu-bio-editor-wrap",[this.GN=L("div","zu-bio-editor-inner-wrap"),this.Bc=L("div","zm-command",[this.Hk=L("a",{name:"save",href:"javascript:;",className:"zg-r3px zg-btn-blue"},"完成")])]);z.forEach(this.Nk,function(b){b=new SA(b);b.X(this.GN);this.items.push(b)},this);this.DN&&R(this.Bc,m);b.appendChild(this.g);this.h().e(this.Bc,"click",this.ra)};
TA.prototype.aw=function(){var b=this.items.length,c;if(!b&&this.Nk.length)for(c=0;c<this.Nk.length;c++)if(this.Nk[c][1])return this.Nk[c][1];var d=k;for(c=0;c<b;c++)if(d=this.items[c].ab())return d};TA.prototype.ra=function(b){if((b=this.Ye(b.target))&&"save"===b.name)this.S&&this.S.D(m),this.dispatchEvent("change")};a.XA=function(b,c){T.call(this);this.wb=b;this.tW=this.wb.dr();this.Xq=Ir(this.wb);this.isContentEditable=this.wb.isContentEditable();this.ES=30;this.wc=new Hd(1E3*this.ES);this.ka=ch?ch.ka:0;this.mE=c||m};y(XA,T);t=XA.prototype;t.w=function(){YA(this);this.wc.G();XA.n.w.call(this)};
t.o=function(b){this.g=b;this.Jr=K("draft-saved-info",b);R(this.Jr,m);this.wN=K("draft-saved-time",b);this.dK=K("draft-clear-button",b);this.fW=this.isContentEditable?Qu:["change","input"];b=this.h().e(this.wc,Id,this.at).e(this.dK,"click",this.eK).e(this.Xq,"keydown",this.jO);"oninput"in this.Xq&&!A?b.e(this.Xq,"input",this.IN):b.e(this.Xq,"keydown",this.JN);var c=$g.Dd&&1E3*$g.Dd[1];c&&(ZA(this,c),this.Rz=setInterval(v(function(){ZA(this,c)},this),22E3))};
t.jO=function(b){if((b.metaKey||b.ctrlKey)&&"s"===$j[b.keyCode])this.vO(),this.isContentEditable||b.preventDefault()};a.aB=function(b){$A(b,"保存中…");b.en();b.HN()};t.en=function(){$(window).on("beforeunload.DraftSaver",v(s("你的修改还未成功保存，确认离开该页面吗？"),this))};t.Pk=function(){$(window).off("beforeunload.DraftSaver")};t.IN=function(){this.Yg();aB(this)};t.JN=function(b){qh(b.keyCode)&&(this.Yg(),aB(this))};t.Zo=function(){this.wc.start()};t.Yg=function(){this.wc.stop()};t.Ha=function(b){this.wb.Ha(b);this.wb.Lo()};
t.ab=function(){return this.wb.$e()};t.FG=function(){if(!this.ug){var b=this.ab();if(b){$A(this,"保存中…");var b=(new hj).add("qid",this.ka).add("content",b),c=new V;c.ajax("/answer/draft/save",b.toString(),"POST");this.h().e(c,"success",v(this.Ng,this));this.DE=c}}};t.gT=150;t.at=Ok(XA.prototype.gT,XA.prototype.FG);t.wO=350;t.vO=Ok(XA.prototype.wO,XA.prototype.FG);t.KN=3E3;t.HN=Ok(XA.prototype.KN,function(){this.ug||(this.ab()?this.at():bB(this))});a.YA=function(b){b.Rz&&(clearInterval(b.Rz),b.Rz=k)};
t.Ng=function(b){var b=He(b.target),c="",c=0===b.r?"已保存":b.msg||"保存失败！请稍后再试。";YA(this);R(this.Jr,j);$A(this,c);this.Pk();"changed"===b.msg&&this.dispatchEvent("saveContent");this.Zo()};a.ZA=function(b,c){var d=Vs(c||za());/^\d/.test(d)&&(d=" "+d);$A(b,"已存于"+d)},a.$A=function(b,c){R(b.Jr,j);wc(b.wN,c)};
t.eK=function(b){b.preventDefault();Ai("清除草稿",this.mE?"你确定要清除保存的草稿并取消编辑吗？":"你确定要清除保存的草稿吗？",function(b){b&&(this.mE?(bB(this),this.wb.dispatchEvent("cancel_edit"),this.wb.hi()):(this.Ha(""),bB(this),this.wb.ready(function(){var b=this.Ja;this.Md?Lr(b,b.value.length):b.field.lastChild?Kr(b.field.lastChild):b.Lf();this.Vk&&(this.Vk.scrollTop=this.Vk.scrollHeight)})))},this)};a.bB=function(b){Di("/draft/delete",k,"POST","qid="+b.ka);b.DE&&(b.DE.abort(),b.Pk());YA(b);R(b.Jr,m);b.dispatchEvent("clearContent")};a.cB=function(b,c,d){Eq.call(this,m);this.jb=!!b;this.JH=c;this.Gb="&nbsp;";this.cq=d;this.Kt=this.xv=this.QC=this.enabled=j;if(S.yi||!S.ha())this.Ix='<span style="font-style: normal;color: #999;">写回答…</span>'};y(cB,Eq);t=cB.prototype;t.cD=function(){var b=Tb("h2","zm-editable-content",J("zh-question-title"))[0];return{title:b&&(/answer\/\d+$/.test(location.pathname)?Ec(b):b.firstChild.nodeValue)||"",ek:this.Ti}};t.aw=p("cq");t.gt=ca("jb");
a.dB=function(b,c){b.cq=c?c:S[4];if(b.wl&&$.trim(c)){var d=c;20<d.length&&(d=d.substring(0,17)+"...");b.KJ.innerHTML="，"+Va(d)+'<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>'}};t.Xa=function(b,c){this.enabled=b;this.wl?(this.hi(),this.Gb=c,this.Pb.innerHTML=this.Gb):c&&(this.Gb=c)};t.$=function(b){cB.n.$.call(this,b);this.wl=j;F.add(this.Pb,"zu-answer-form-disabled-wrap")};t.w=function(){this.Mr&&(M(this.Mr),this.KH=this.Mr=k);cB.n.w.call(this)};
t.cj=function(b){this.gt(b.jb);this.Rp&&(this.Rp.checked=b.jb)};t.B=function(){cB.n.B.call(this);this.h().e(Ji,"anon_change",this.cj)};
t.sg=function(){cB.n.sg.call(this);var b=this.J(),c=S.ha();this.Mr=b.v("div","zh-answer-form clearfix",[c?Zs(this.JH):"",this.KH=b.v("div",k,[b.v("div","zu-answer-form-title",[c?Ys(this.JH):"我来回答这个问题",this.KJ=b.v("span")])])]);dB(this,this.cq);b.Jn(this.Mr,this.Ti);this.h().e(this.KH,"click",this.ra);S.ha()?S.yi||eB(this,'<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,
c){b.attr("data-activate-dialog","");c.attr("data-activate-dialog","")}):eB(this,'<div class="signin-mask-tip-answer"></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>',function(b,c){function g(){nl("question_answer_add_start")}b.on("click",g);c.on("click",g)})};a.eB=function(b,c,d,e){c=$(c).css("top",0).css("z-index",9);$(b.Bc).hide();d=$(d);$(b.Ti).append(c).after(d);e&&e.call(b,c,d)};
t.kr=function(b){switch(b){case "edit_bio":b=VA();if(!this.Au){var c=ch.mb;b.Cx=j;b.sG=c;this.h().e(b,"change",this.cy)}this.Au=j;WA(b);break;case "cancel_delete":this.dispatchEvent("cancel_delete_answer");break;case "answer_my_question":var d=this;this.mk?this.mk.show():(d.mk=$('<div class="question-tip-box-bottom">确定想要回答你自己提出的问题吗？<br>如果需要对问题做出更多的解释和说明，请编辑问题描述。 如果需要对其他回答做出回应，请在相应回答下通过评论发布。<br><div class="zg-clear"><a href="javascript:;" class="zg-right zg-btn zg-btn-blue" name="confirm">确定</a><a href="javascript:;" class="zg-right zg-link-gray " name="cancel">取消</a></div></div>'),
d.mk.on("click",'[name="cancel"]',function(){d.mk.hide()}).on("click",'[name="confirm"]',function(){d.mk.hide();$(d.Pb).hide();d.Xa(j);d.of()}),$(d.Pb).after(d.mk))}return j};t.je=function(){"editing"===this.status?this.Ab&&R(this.Ab,j):this.Ab&&R(this.Ab,m);R(this.bd,m);this.Pb&&R(this.Pb,!this.enabled)};t.mK='<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
t.sh=function(){var b=Ik(this.mK);this.Bc=ec(b({questionStatus:ch.status,statusText:{suggest:"建议修改",evaluate:"建议修改",close:"关闭"}[ch.status]}));this.Hk=$(".submit-button",this.Bc)[0];var b=$("input[name=anno-checkbox]",this.Bc)[0],c=$("label",this.Bc)[0];this.Rp=b;ch.jb&&(this.Rp.checked=j);rg(c,j);this.Ab.appendChild(this.Bc);this.ready(function(){if(this.Ja&&this.Ja.on)this.Ja.on("load",this.ax,m,this)})};
t.ax=function(){var b=new XA(this);Qc(this,b);this.h().e(b,"saveContent",function(){var b=!this.Md&&this.Ja.Fh("FullScreenPlugin");b&&JA(b)},m,this);var c=Ir(this);this.h().e(c,"focus",function(){b.Zo()}).e(c,"blur",function(){b.Yg();b.at()}).e(this,"saveSuccess",function(){b.Yg();bB(b)});b.o(this.Bc)};t.cy=function(){var b=VA().aw();b&&dB(this,b)};a.fB=function(b,c,d,e,g,h){Eq.call(this,e,c,d,h);this.ka=b;this.Pn=this.Ao=m;this.oQ=g};y(fB,Eq);a.gB=[{value:"精简文字描述",label:"精简文字描述"},{value:"补充必要的信息",label:"补充必要的信息"},{value:"改进标点或格式",label:"改进标点或格式"},{value:"other",label:"其他"}];t=fB.prototype;t.o=function(b){fB.n.o.call(this,b);this.h().e(Ji,"anon_change",this.cj)};t.cj=function(b){this.Pn||F.enable(this.g,"zm-editable-disabled",b.jb)};
t.sh=function(){fB.n.sh.call(this);var b=L("a",{"class":"zg-right zg-link-litblue",href:"http://www.zhihu.com/question/19550238/answer/12202028",target:"_blank"},"为什么问题可以被公共编辑？"),c=L("select",{style:"1px solid #999 "}),d=L("option",{value:"none"},"请选择一个修改理由...");c.appendChild(d);z.forEach(gB,function(b,d){var e=L("option",{value:b.value},d+1+". "+b.label);c.appendChild(e)});this.My=L("div",{"class":"zm-editable-require-reason-wrap",style:"padding:10px 0 0 0"},[b,this.EX=c,this.aF=L("span"),this.QQ=
L("div",{"class":"zg-form-text-input",style:"height:22px;margin:10px 0 0 0;display:none"},this.PQ=L("textarea",{style:"width:100%;height:22px !important;min-height:22px !important;"}))]);ic(this.My,this.Bc);this.Ao&&this.di(" * 必选","zg-gray-normal");var e=Tb("select",k,this.My)[0];this.h().e(e,"change",function(){R(this.QQ,"other"===e.value);this.di(" * 必选","zg-gray-normal")})};
t.Ng=function(b){var c=Tb("select",k,this.My)[0],d=c.value;if(this.Ao){if("none"===d){this.di("请选择一个修改理由");return}if("other"===c.value&&(d=rk(this.PQ.value),!d)){this.di("请填写修改理由");return}}"title"===this.Eq&&-1===b.indexOf("?")&&-1===b.indexOf("？")?this.di("还没有输入问号"):("none"===d&&(d=""),this.params=["id="+this.ka+"&reason="+encodeURIComponent(d)+"&question_id="+this.ka],this.dispatchEvent("change"),fB.n.Ng.call(this,b),this.di("* 必选","zg-gray-normal"),this.Ao=j)};
t.di=function(b,c){this.aF.innerHTML=b;F.set(this.aF,c||"zg-error-text")};t.$e=function(){return this.Md&&this.oQ?sk(Ia(this.Ja.value)):fB.n.$e.call(this)};t.Ve=function(){$(window).on("beforeunload.EditorWithReason",v(s("你对问题的修改还未保存，确认离开该页面吗？"),this))};t.Df=function(){$(window).off("beforeunload.EditorWithReason")};t.hi=function(){fB.n.hi.call(this);this.Df()};t.of=function(){fB.n.of.call(this);this.Ve()};a.hB=function(b,c){St.call(this,b,c);this.zm=j;this.Ie(j);this.D(m,j);this.qf=new Md};y(hB,St);t=hB.prototype;t.IS=m;t.zE=0;t.Re=k;t.$=function(b){hB.n.$.call(this,b);(b=b.getAttribute("for")||b.htmlFor)&&this.attach(this.J().m(b),1)};t.B=function(){hB.n.B.call(this);Kd.forEach(this.qf,this.fB,this);var b=this.h();b.e(this,"action",this.VO);b.e(this.J().Ca(),"mousedown",this.wF,j);C&&b.e(this.J().Ca(),"contextmenu",this.wF,j)};
t.attach=function(b,c,d,e,g){if(!b||!this.qf.Fd(ua(b)))b?(c={g:b,iH:c,EO:d,DC:e?"contextmenu":"mousedown",Lx:g},this.qf.set(ua(b),c),b=c):b=k,this.za&&this.fB(b)};t.fB=function(b){this.h().e(b.g,b.DC,this.NF)};t.detach=function(b){(!b||!this.qf.Fd(ua(b)))&&f(Error("Menu not attached to provided element, unable to detach."));b=ua(b);if(this.za){var c=this.qf.get(b);this.h().Ea(c.g,c.DC,this.NF)}this.qf.remove(b)};
a.iB=function(b,c,d,e,g){var h=b.P();b.px()&&b.IS?b.hide():(b.Re=g||k,b.dispatchEvent("beforeshow")&&(d="undefined"!=typeof d?d:4,h||(b.m().style.visibility="hidden"),R(b.m(),j),c.fa(b.m(),d,e),h||(b.m().style.visibility="visible"),b.Mb(-1),b.D(j)))};t.XG=function(b,c,d){c=ka(b.iH)?new Rs(b.g,b.iH,j):new Qs(c,d);c.fm&&c.fm(5);iB(this,c,b.EO,b.Lx,b.g)};t.hide=function(){this.P()&&(this.D(m),this.P()||(this.zE=za(),this.Re=k))};t.px=function(){return this.P()||150>za()-this.zE};t.VO=function(){this.hide()};
t.NF=function(b){for(var c=this.qf.Cb(),d=0;d<c.length;d++){var e=this.qf.get(c[d]);if(e.g==b.currentTarget){this.XG(e,b.clientX,b.clientY);b.preventDefault();b.stopPropagation();break}}};t.wF=function(b){this.P()&&!this.Af(b.target)&&this.hide()};t.Qc=function(b){hB.n.Qc.call(this,b);this.hide()};t.w=function(){hB.n.w.call(this);this.qf&&(this.qf.clear(),delete this.qf)};a.jB=function(){T.call(this)};y(jB,T);jB.prototype.H=function(b,c){jB.n.H.call(this,b,c);this.h().e(b,"beforeexpand",this.YM)};jB.prototype.YM=function(b){var c=b.target;Lh(this,function(b){c!==b&&b.tc()&&b.Ka(m)})};jB.prototype.G=function(){this.h().G();jB.n.G.call(this)};a.kB=function(){Th.call(this,i,i,i);this.Qk=j;this.D(j)};y(kB,vi);kB.prototype.B=function(){kB.n.B.call(this);xi(this,490);$(this.m()).addClass("user-guiding-dialog")};kB.prototype.Ad=function(b){$('[class^="view"]',this.g).hide();$(".view-"+b,this.g).show()};a.lB=function(b,c){T.call(this);this.NQ=b;this.Ms=c;this.PN=this.Y=k;this.dd=m;this.Kn=k;this.xl=[];this.fH=[];this.Pg=j;this.tO="loading";this.iE="zg-btn-white";this.QN="invite-button"};y(lB,T);t=lB.prototype;t.v=function(){this.g=L("div",{style:"display:none",className:"question-invite-panel"})};
t.B=function(){lB.n.B.call(this);var b=this.g,c=this.h();if(!this.Pg){c.e(Ji,"anon_change",this.reload);var d=K("cancel-anon",b);d&&c.e(d,"click",this.QL);if(!K("error-message")){var d=K("search-input",b),e=K("invite-title",b);this.hx=K("invite-status",b);c.e(this.hx,"click",this.RL);var g=K("suggest-persons",b);g&&(c.e(g,"click",this.Dw),this.eH=g);$(".invite-status",b).on("mouseenter mouseleave",".invited-shortlist",function(b){$(".invited-hovercard",this).toggleClass("in","mouseenter"===b.type)});
this.Yw(d,e);this.fH=$(this.eH).children().map(this.ZF).get();this.xl=$(".invited-fulllist",this.hx).children().map(this.ZF).get();var h=function(b){0>b||b>n-1||(w.find("li").hide().slice(4*b,4*(b+1)).show(),0===b?q.addClass("link-disabled"):q.removeClass("link-disabled"),b===n-1?r.addClass("link-disabled"):r.removeClass("link-disabled"),l=b)},b=this.g,l=0,n,q,r,w;w=$(".suggest-persons",b);n=w.find("li").length/4;q=$(".js-prev",b).on("click",function(){h(l-1)});r=$(".js-next",b).on("click",function(){h(l+
1)});h(0);R(this.g,this.dd)}}};t.ib=function(){lB.n.ib.call(this);this.h().G()};t.Ii=s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>');t.reload=function(){this.tc()?this.Xh():this.Pg=j};t.Xh=function(){var b=this,c=this.tO;this.ib();F.add(this.g,c);this.g.innerHTML=this.Ii();return $.get("/node/QuestionInvitePanelV2",{params:{question_id:this.NQ}}).done(function(d){b.Pg=m;F.remove(b.g,c);d=ec(La(d));R(d,b.tc());lc(d,b.g);b.g=d;b.B()})};
t.w=function(){lB.n.w.call(this);this.PN=k;this.Y.G()};t.tc=p("dd");t.expand=function(){this.Ka(j)};t.collapse=function(){this.Ka(m)};t.Ka=function(b){if(b!==this.dd){this.dispatchEvent(b?"beforeexpand":"beforecollapse");var c=v(function(){this.dispatchEvent(b?"expand":"collapse")},this);b&&this.Pg?this.Xh().done(c):c();this.dd=b;R(this.g,b)}};t.uf=function(){this.Ka(!this.dd)};
t.Yw=function(b){var c=this,d=Ik('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>');this.Y=new xo(b,{Ce:8,source:"/people/autocomplete?type=invite",Qj:b.offsetParent,placeholder:"搜索你想邀请的人",Vc:function(b,c,h){h.innerHTML=d(b.data)},filter:function(b){return z.filter(b,function(b){var d=b.id;return!z.find(c.xl,function(b){return b.id===
d})})},select:function(b){mB(c,"ask_to_answer_search");bt(c.Ms,b.id,"search").done(function(d){if(d.r)return U(d.msg);nB(c,b);oB(c,b.id,j)});return""}})};a.pB=function(b,c,d){b=b.iE;d?(F.add(c,b),wc(c,"收回邀请")):(F.remove(c,b),wc(c,"邀请回答"))};t.QL=function(){Qr(0)};a.mB=function(b,c){var d=ch;b.dispatchEvent(new wv("click!invitation",{category:"invitation",action:"ask_to_answer",label:c,value:d.rE?k:d.he}))};
t.Dw=function(b){var c=b.target;if("BUTTON"===c.tagName||F.has(c,this.QN)){this.Kn&&"pending"===this.Kn.state()&&this.Kn.abort();b="related"===c.getAttribute("data-type")?"recommended_relative_questions":"recommended_top_answerers";mB(this,b);var d=c.getAttribute("data-uid"),e=this.iE,g=v(function(b){b?(pB(this,c,j),b=z.find(this.fH,function(b){return b.id===d}),nB(this,b),this.YJ()):(pB(this,c,m),qB(this,d))},this);F.has(c,e)?(this.Kn=at(this.Ms,d),g(m)):(this.Kn=bt(this.Ms,d,b).done(function(b){b.r&&
(U(b.msg),g(m))}),g(j))}};t.RL=function(b){b=b.target;"BUTTON"===b.tagName&&(b=b.getAttribute("data-uid"),at(this.Ms,b),oB(this,b,m),qB(this,b))};a.oB=function(b,c,d){var e=$(".invite-button",b.eH).filter(function(){return this.getAttribute("data-uid")===c}).get(0);e&&pB(b,e,d)};t.ZF=function(){var b=$(this),c=$(".zm-item-link-avatar",b);return{id:String($("button",b).data("uid")),avatar:$("img",c).attr("src"),fullname:c.attr("title"),url_token:c.attr("href").split("/").slice(-1)[0]}};
a.nB=function(b,c){b.xl.unshift(c);rB(b);$(".ignore-invite-hint").css("display","none")},a.qB=function(b,c){b.xl&&z.aR(b.xl,function(b){return b.id===c})&&(rB(b),$(".ignore-invite-hint").css("display","none"))};t.PR='您已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
t.xL='<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
a.rB=function(b){var c=b.xl,d={each:z.forEach,fullList:function(){return Ik(b.xL,{persons:c,helper:d})}};b.hx.innerHTML=c.length?Ik(b.PR,{persons:c,helper:d}):""};t.YJ=ok(function(){S.Rg&&$.post("/question/popup",{action:"invite",question_token:ch.mb},function(b){if(b){var c=new kB;c.Ya("邀请回答小窍门");c.Ha(b);c.fa();$(".js-close",c.g).on("click",function(){c.D(m)})}})});a.sB=function(b){this.data=b;this.sa=k};y(sB,T);t=sB.prototype;
t.B=function(){sB.n.B.call(this);this.h().e(this.g,"click",this.Il);var b=K("panel-container",this.g);b&&(this.El=new jB,this.H(this.El),this.El.o(b),this.sa=new Jv(this.data.ka,"question"),this.El.H(this.sa),Nv(this.sa,this.El.m(),$(".toggle-comment",this.g)[0]),"normal"===ch.status&&(b=new lB(this.data.ka,this.data.mb),b.X(this.El.m()),this.El.H(b),ch.YR&&(b.expand(),this.dispatchEvent(new wv("show!invitation",{category:"invitation",action:"ask_to_answer_card",label:""}))),this.hE=b));this.h().e(this,
"click!",function(b){"comment"===b.namespace&&b.xc.fill("label","question")})};
t.Il=function(b){var c=(b=Ck(this.g,b.target))&&b.name;if(c)switch(c){case "report-question":Ft("question",this.data.ka,'<a href="http://www.zhihu.com/question/19806261" class="zg-link-gray">知乎提问规范</a>');break;case "addcomment":"添加评论"===$.trim($(b).text())?ol(this.hr,{ha:"question_add_comment_start"}).call(this,b):this.hr(b);break;case "remove":Ai("删除问题","你确定要删除这个问题吗？相关的评论也将被删除。",function(b){if(b){var c=new V(j);O(c,"complete",function(){var b=He(c);b&&!b.r?window.location.href="/":U(b.msg)});c.ajax("/question/delete/"+
this.data.ka)}},this);break;case "admin":c=this.VI;c||(c=new hB,c.o(J("zh-question-admin-menu")),Lh(c,function(b){b.Aa(b.m().getAttribute("data-action"))}),this.h().e(c,"action",function(b){b=this.MA=b.target;(new xv).open(b.m(),{id:this.data.ka,type:"question"},v(this.rK,this))}),this.VI=c);c.P()?c.D(m):iB(c,new Rs(b,1,j),0,new Nf(5,0,5,0));break;case "share":Y.ia({type:"ga_click_share_question_box",target:b});this.rc();break;case "invite":this.Dw()}};
t.hr=function(b){this.sa.uf();this.sa.tc()&&this.sa.ki("view_comments",parseInt(Ec(b),10)||0)};t.Dw=function(){this.hE.uf();var b=this.hE.tc();this.dispatchEvent(new wv("click!invitation",{category:"invitation",action:(b?"show":"hide")+"_ask_to_answer_card",label:"?",value:this.data.he}))};t.rc=ol(function(){new ku(["分享问题","question",this.data.mb,{qid:this.data.ka}],"tb-webshare-sina")},{ha:"question_question_share"});t.rK=function(b){this.MA.W(b.msg.action);this.MA.dm(b.msg.caption)};a.$v=function(b,c){this.ub=b;this.entryType=c;this.Rl=k;this.dd=m};y($v,T);t=$v.prototype;t.tc=p("dd");t.Ka=function(b){this.dd=!!b};t.Ra=function(){return this.zp.data("votecount")};t.Xh=function(){this.Rl&&"pending"===this.Rl.state()||(this.Rl=("post"===this.entryType?au:dt)(this.ub,this.dd).done(v(this.Vs,this)))};t.Vs=function(b){if(b=La(b))b=$(b),this.zp.replaceWith(b),this.zp=b,this.gb(),this.dispatchEvent("change")};t.gb=function(){var b=this;$("a.more",this.zp).click(function(){b.Ka(j);b.Xh()})};
t.B=function(){this.zp=$(this.g);this.gb()};a.tB=function(b){this.K=$(b);this.cf()};tB.prototype.cf=function(){var b=[this.K.get(0)].concat(this.K.parents().get()),c=$.map(b,function(b){return $(b).data("navigable")})[0],d=c&&$.grep(c.items(),function(c){return~$.inArray(c,b)})[0];this.jX=c;this.PO=d};tB.prototype.getItem=p("PO");a.uB=function(b,c,d,e){Eq.call(this,b,c,d,e)};y(uB,Eq);t=uB.prototype;t.B=function(){uB.n.B.call(this);this.ready(function(){if(this.Ja&&this.Ja.on)this.Ja.on("load",this.ax,m,this)})};
t.ax=function(){var b=new XA(this,j);Qc(this,b);this.h().e(b,"saveContent",function(){var b=!this.Md&&this.Ja.Fh("FullScreenPlugin");b&&JA(b);$(this.lq).text("保存草稿并离开");$(this.g).find(".zu-edit-button span").text("修改（有未发布的编辑草稿）")}).e(b,"clearContent",function(){$(this.lq).text("取消");$(this.g).find(".zu-edit-button span").text("修改")});var c=Ir(this);this.h().e(c,"focus",function(){b.Zo()}).e(c,"blur",function(){b.Yg();this.uK!==this.$e()&&b.at()}).e(this,"saveSuccess",function(){delete $g.Dd;b.Yg();
bB(b)}).e(this,"save_unchanged",function(){delete $g.Dd;b.Yg();bB(b)});b.o(this.Bc);$g.Dd&&$g.Dd[0]&&$(this.lq).text("保存草稿并离开")};
t.sh=function(){this.Bc=L("div","zm-command",[this.nW=$('<div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$取消编辑并删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div>')[0],this.lq=L("a",{"class":"zm-command-cancel",name:"cancel",href:"#"},"取消"),this.Hk=L("a",{"class":"zg-r3px zg-btn-blue",name:"save",href:"#"},"发布")]);this.Ab.appendChild(this.Bc)};
t.Nv=function(){var b=this;$.get("/draft/get",{qid:this.Bo},function(c){c.r||(b.ht(c.msg),b.uK=c.msg)})};t.aD=function(){var b=[];if(!this.disabled){var c="修改";$g.Dd&&$g.Dd[0]&&(c="修改（有未发布的编辑草稿）");b.push('<a href="javascript:;" class="zu-edit-button" name="edit"><i class="zu-edit-button-icon"></i><span>'+c+"</span></a>")}return b.join("")};a.vB=function(){this.Pu=[]};y(vB,Kt);ia(vB);vB.prototype.v=function(b){var c=vB.n.v.call(this,b);F.add(c,"goog-submenu");wB(this,b,c);return c};vB.prototype.o=function(b,c){c=vB.n.o.call(this,b,c);F.add(c,"goog-submenu");wB(this,b,c);var d=Tb("div","goog-menu",c);if(d.length){var e=new St(b.J()),d=d[0];R(d,m);b.J().Ca().body.appendChild(d);e.o(d);b.Vg(e,j)}return c};
vB.prototype.Ha=function(b,c){var d=this.U(b),e=d&&d.lastChild;vB.n.Ha.call(this,b,c);e&&(d.lastChild!=e&&F.has(e,"goog-submenu-arrow"))&&d.appendChild(e)};vB.prototype.ve=function(b){vB.n.ve.call(this,b);var c=b.U(),d=b.J(),d=Sb(d.Ga,"span","goog-submenu-arrow",c)[0];xB(b,d);d!=c.lastChild&&c.appendChild(d);Mc(b.m(),Tc.sk,"true")};
a.wB=function(b,c,d){var e=c.J().v("span");e.className="goog-submenu-arrow";xB(c,e);b.U(d).appendChild(e)},a.xB=function(b,c){b.wd()?(F.add(c,"goog-submenu-arrow-rtl"),wc(c,b.Pp?"◄":"►")):(F.remove(c,"goog-submenu-arrow-rtl"),wc(c,b.Pp?"►":"◄"))};a.yB=function(b,c,d,e){Pt.call(this,b,c,d,e||vB.O())};y(yB,Pt);a.zB=218;t=yB.prototype;t.Gd=k;t.tz=k;t.MD=m;t.jc=k;t.Uq=m;t.Pp=j;t.ZN=m;t.B=function(){yB.n.B.call(this);this.h().e(this.getParent(),"hide",this.HF);this.jc&&AB(this,this.jc,j)};t.ib=function(){this.h().Ea(this.getParent(),"hide",this.HF);this.jc&&(AB(this,this.jc,m),this.Uq||(this.jc.ib(),M(this.jc.m())));yB.n.ib.call(this)};t.w=function(){this.jc&&!this.Uq&&this.jc.G();this.jc=k;yB.n.w.call(this)};
t.nd=function(b,c){yB.n.nd.call(this,b);c&&(this.Va().Rf=j);b||(this.Gd&&Gd.clearTimeout(this.Gd),this.Gd=Jd(this.tg,zB,this))};t.pt=function(){var b=this.getParent();b&&Ls(b)==this&&(BB(this,j),CB(this),this.$W=m)};t.tg=function(){var b=this.jc;b&&b.getParent()==this&&(BB(this,m),Lh(b,function(b){"function"==typeof b.tg&&b.tg()}))};a.DB=function(b){b.Gd&&Gd.clearTimeout(b.Gd);b.tz&&Gd.clearTimeout(b.tz)};t.D=function(b,c){var d=yB.n.D.call(this,b,c);d&&!this.P()&&this.tg();return d};
a.CB=function(b){Lh(b.getParent(),function(b){b!=this&&"function"==typeof b.tg&&(b.tg(),DB(b))},b)};t.Vb=function(b){var c=b.keyCode,d=this.wd()?37:39,e=this.wd()?39:37;if(this.MD){if(!this.Va().Vb(b))if(c==e)this.tg();else return m}else if(this.isEnabled()&&(c==d||c==this.Rx))this.pt(),Ms(this.Va()),DB(this);else return m;b.preventDefault();return j};t.gP=function(){this.jc.getParent()==this&&(DB(this),this.Ml.nd(this),CB(this))};t.HF=function(b){b.target==this.Ml&&(this.tg(),DB(this))};
t.hd=function(b){this.isEnabled()&&(DB(this),this.tz=Jd(this.pt,zB,this));yB.n.hd.call(this,b)};t.Ud=function(b){DB(this);if(this.Nb&8)return yB.n.Ud.call(this,b);this.pt();return j};
a.BB=function(b,c){b.dispatchEvent(Hh(64,c));var d=b.Va();if(c!=d.P()&&(c&&(d.za||d.X(),d.Mb(-1)),b.MD=c,F.enable(b.m(),"goog-submenu-open",c),d.D(c),c)){var d=new Rs(b.m(),b.Pp?6:4,b.ZN),e=b.Va(),g=e.m();e.P()||(g.style.visibility="hidden",R(g,j));d.fa(g,b.Pp?4:6);e.P()||(R(g,m),g.style.visibility="visible")}},a.AB=function(b,c,d){var e=b.h();(d?e.e:e.Ea).call(e,c,"highlight",b.gP)};t.Fa=function(b){this.Va().H(b,j)};t.zi=function(b,c){this.Va().vk(b,c,j)};
t.removeItem=function(b){(b=this.Va().removeChild(b,j))&&b.G()};t.Eh=function(b){return Nh(this.Va(),b)};t.hl=function(){return Mh(this.Va())};t.Hb=function(){return this.Va().Hb()};t.Va=function(){this.jc?this.Uq&&this.jc.getParent()!=this&&Kh(this.jc,this):this.Vg(new St(this.J()),j);this.jc.m()||this.jc.v();return this.jc};t.Vg=function(b,c){var d=this.jc;b!=d&&(d&&(this.tg(),this.za&&AB(this,d,m)),this.jc=b,this.Uq=!c,b&&(Kh(b,this),b.D(m,j),b.zm=m,b.Ie(m),this.za&&AB(this,b,j)))};t.Af=function(b){return this.Va().Af(b)};
Rn("goog-submenu",function(){return new yB(k)});a.EB=function(b,c,d,e){yB.call(this,b,c,d,e)};y(EB,yB);EB.prototype.Vb=function(b){var c=EB.n.Vb.call(this,b),b=parseInt($j[b.keyCode],10);isNaN(b)||this.Va().Mb(b-1);return c};a.fw=function(b,c,d){T.call(this);this.ka=b;this.oa=d;this.DK=c||ch;this.Xu=k};y(fw,T);a.FB={all_can_comment:"允许任何人评论",followee_can_comment:"允许我关注的人评论",nobody_can_comment:"关闭评论"};t=fw.prototype;t.Mx=function(){ou("answer",this.mb,"read")};t.Bj=function(){ou("answer",this.mb,/^\/question\//.test(location.pathname)?"read":"touch")};
t.B=function(){function b(){c();var b=q.Np.Eh(0);b.Va&&b.Va()&&(b.pt(),b.Va().Mb(0))}function c(){GB(q);q.Np.Mb(0)}fw.n.B.call(this);var d=K("zm-item-answer",this.g)||this.g;this.oa=d.getAttribute("data-aid");this.Ee="1"===d.getAttribute("data-isowner");this.mb=d.getAttribute("data-atoken");this.Fg="1"===d.getAttribute("data-deleted");this.cv=+d.getAttribute("data-created");this.hN=+d.getAttribute("data-helpful");this.XN="1"===d.getAttribute("data-good");this.rj="1"===d.getAttribute("data-collapsed");
this.jb=k;this.yf=K("zm-item-answer-author-info",this.g);d=m;!S.ha()&&0<$(this.g).parents('div[data-fixed-summary="1"]').length&&(d=j);var e={};e.ar=!!d;d=this.vt=new Bt(e);this.H(d);d.o(this.g);d.ed()&&me(this.h(),d,"expand",this.Mx);At(this.g,this.Bj,this);this.Tc=this.Tc||K("zm-item-meta",this.g);(this.Oh=K("zm-meta-panel",this.Tc))&&this.h().e(this.Oh,"click",this.Il);if(this.Ee){d=$('[name="comment_opt"]',this.Tc);if(d.length){var e=d.data(),g=new St,h=new OA("禁止转载");h.Wc(!e.copyable);g.Fa(h);
g.Fa(new Rt);this.Yu=[];G.forEach(FB,function(b,c){var d=new OA(b);d.Aa(c);d.Wc(c===this.Xu);this.Yu.push(d);g.Fa(d)},this);g.Fa(new Rt);g.Fa(new Pt("删除"));this.h().e(g,"action",this.VL);HB(this,g);F.add(g.m(),"zg-gray-normal");e=new gz("comment",g);e.Vl=j;jz(e);iz(e);e.nc=mf;e.o(d[0]);this.cW=g}this.yf&&(this.TF=(this.jb=Wa(this.yf.innerHTML,"匿名用户"))?k:this.yf.innerHTML.replace(/src=".+?"/g,'src="'+S[2]+'"'),this.h().e(this.yf,"click",function(b){"cancel-anon"===b.target.name&&Qr(m)}))}else this.dx();
if(d=K("zm-item-vote-info",this.g)){this.gk=new $v(this.oa);this.H(this.gk);this.gk.o(d);d=$(".zm-item-vote-count",this.g);d[0]||(d=$(".zm-item-vote-count",this.Tc));var l=[d[0],$(".zm-votebar .count",this.g)[0]];if(l.length){var n=this.gk;this.gk.on("change",function(){z.forEach(l,function(b){pk(b,n.Ra())})})}}this.Hn();$(this.g).on("contentchange",$.proxy(this.Hn,this));this.Zw();this.gb();d=new tB(this.g);d=nk.UH(d.getItem()||this.g);mk(mk(mk(mk(mk(mk(mk(d.register("v",function(){this.sb&&this.sb.Gt()},
this),{group:"操作",name:"赞同"}).register("d",function(){this.sb&&this.sb.Ft()},this),{group:"操作",name:"反对"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("s c",this.nl,this),{group:"操作",name:"收藏"}).register("t",this.sr,this),{group:"操作",name:"感谢"}).register("c",this.vw,this),{group:"操作",name:"打开评论"}).register("shift+c",this.hr,this),{group:"操作",name:"定位到评论框"});var e=kb?"⌘":"ctrl",q=this;ah.kE&&$("a[name=admin]",this.Oh)[0]&&mk(mk(d.register("meta+.",c),{group:"管理",name:"展开菜单",key:e+
"+."}).register("meta+k",b),{group:"管理",name:"展开折叠子菜单 (Kill)",key:e+"+k"});if(sb&&!Lg&&(d=K("more-actions",this.Tc))){var r={share:{label:"分享",action:this.rc},fav:{label:"收藏",action:this.nl},report:{label:"举报",action:this.rr},nohelp:{label:this.hN?"没有帮助":"撤销没有帮助",action:this.sD}},w=new St,e=function(b){Mh(w)&&w.Fa(new Rt);var c=new Pt(r[b].label);c.Aa(b);w.Fa(c)};e("share");e("fav");this.Ee||(e("nohelp"),S.ha()&&e("report"));e=new gz("operation",w);e.Vl=j;jz(e);iz(e);e.Jl=ba();e.nc=mf;e.o(d);F.add(w.m(),
"zh-answer-more-actions");this.h().e(w,"action",function(b){var c=r[b.target.W()];c&&c.action&&c.action.call(this,b)})}};t.mz=function(b){var c=this.Hn();c&&lq(c,b)};
t.dx=function(){var b=K("zm-votebar",this.g)||K("zm-votebar",this.Oh);if(b){var c=new bu(this.oa);c.o(b);this.sb=c;this.h().e(c,"change",this.YQ).e(c,"action",function(b){b.data.state===cu.de?Y.ia({type:"ga_click_vote_up",target:this}):b.data.state===cu.kg&&Y.ia({type:"ga_click_vote_down",target:this})});(b=K("votenum-mobile",this.Oh))&&(new Yv(c)).o(b)}};
t.Hn=function(){if(this.wp)return this.wp;var b=K("zm-editable-content",this.g),c=this.sb&&this.sb.m();!this.Ee&&(!sb&&S.ha())&&(c&&$(c).is(":visible")&&b&&230<$(b).height())&&(b=this.wp=new oq(k,b),this.H(b),b.ah="votebar",b.wy=50,b.o(c))};t.YQ=function(){this.gk&&this.gk.Xh()};
a.IB=function(b){if(!b.ge&&b.Ee&&ch&&b.oa){b.ge=new uB(m,"/answer/content","content");Qc(b,b.ge);b.ge.Kt=j;b.ge.xv=j;b.ge.cD=cB.prototype.cD;var c=K("zm-item-rich-text",b.g);b.ge.params=["id="+b.ka];b.ge.o(c);b.h().e(b.ge,"shouldUpdateContent",function(b){if(ma(b.data))return m});b.h().e(b.g,"click",function(b){"suggest_edit"===b.target.name&&(this.ge.of(),$(".zh-question-censor-tip",this.g).hide());return j})}};
t.gb=function(){this.yf&&this.h().e(this.yf,"click",this.ra);this.Ee&&(this.wJ=S);this.h().e(Ji,"anon_change",function(b){this.Ee?this.gt(b.jb):this.sb.Pd()===cu.de&&this.gk.Xh()});IB(this);$(this.g).on("focusin focusout",function(b){$(this).toggleClass("focusin","focusin"===b.type)})};t.Ye=function(b){return Ck(this.g,b)};
t.ra=function(b){if(b=(b=this.Ye(b.target))&&b.name)if("edit"===b){b=VA();if(!this.Au){var c=ch.mb;b.Cx=j;b.sG=c;this.h().e(b,"change",this.cy)}this.Au=j;WA(b)}else"complex"===b&&(b=K("zm-item-answer-summary",this.g),c=K("zm-item-rich-text",this.g),R(b,m),R(c,j))};t.cy=function(){var b=VA().aw()||S[4]||"";if(b){var c=K("zu-question-my-bio",this.yf);c.title=b;c.innerHTML=b}};t.Zw=function(){var b=K("zm-item-answer-author-wrap",this.g),b=K("zm-list-avatar",b);Uj.add(b)};
t.gt=function(b){b?this.yf.innerHTML='<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>':this.Ee&&(this.TF?this.yf.innerHTML=this.TF.replace("</h3>","").replace("</H3>","")+'<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>':(b=[],b.push('<h3 class="zm-item-answer-author-wrap">'),b.push(Ws()),b.push(Xs(S,"zm-item-answer-creator")),b.push("</h3>"),this.yf.innerHTML=
b.join("")))};
a.JB=function(b,c){if(!b.sa){b.sa=new Jv(b.oa,"answer",c);b.H(b.sa);Nv(b.sa,b.Tc,$(".toggle-comment",b.Tc)[0]);Wv(b.sa);var d=location.hash.slice(1).split("-"),e=location.pathname.split("/"),e="answer"===e[3]&&e[4];"comment"===d[0]&&d[1]&&e===b.mb&&(b.sa.Ka(j),b.h().e(b.sa,"expand",function(){Lv(this.sa)}))}},a.GB=function(b){if(b.Np)b.Np.D(j);else{var c;var d=$("a[name=admin]",b.Oh)[0];if(d){b.WI=d;zB=0;c=new hB;b.H(c);c.attach(d,5);var e=b.rj?new Pt("取消折叠"):new EB("折叠");e.Aa("collapse");var g=function(b,
c){var d=new Pt(c+1+" "+b.label);d.Aa(b.value);e.Fa(d)};b.rj||zv("answer","collapse").then(function(b){z.forEach(b,g);F.add(e.Va().m(),"manage-menu")});d=new Pt("删除");d.Aa("delete");c.Fa(e);c.Fa(d);c.X(b.g);F.add(c.m(),"manage-menu")}else c=i;c&&(iB(c,new Rs(b.WI,1,j),0,new Nf(5,0,5,0)),b.h().e(c,"action",function(b){var c=b.target,b=c.W(),c=c.m(),d=new hj;"collapse"===b?(d.add("answer_id",this.oa).add("action","collapse2").add("collapse",this.rj?"cancel":"done"),c.setAttribute("data-op",this.rj?
"uncollapse-answer":"collapse-answer"),c.setAttribute("data-action","/manage?"+d.toString()),KB(this,c)):"delete"===b?(d.add("answer_id",this.oa).add("action","remove_answer2"),c.setAttribute("data-op","remove-answer"),c.setAttribute("data-action","/manage?"+d.toString()),KB(this,c)):pa(b)&&(c=new hj,c.add("answer_id",this.oa).add("action","collapse2").add("collapse",this.rj?"cancel":"done").add("reason",b),yv("/manage",c.toString(),v(this.KF,this)))}),HB(b,c),b.Np=c)}};
t.KF=function(){var b=$(this.g);b.hide("fast",function(){b.remove()});this.G()};a.KB=function(b,c){(new xv).open(c,{id:b.oa,type:"answer"},v(b.KF,b))};
t.Il=function(b){var c=this.Ye(b.target),d=c&&c.name;if(d)switch(d){case "addcomment":this.vw();this.sa.tc()&&this.sa.ki("view_comments",parseInt(Ec(c),10)||0);break;case "remove":this.lr();break;case "thanks":Y.ia({type:"ga_click_thank_answer",target:c});this.sr();break;case "comment_opt":if(!this.Xu&&(!this.EB||!this.EB.Xb()))b=new V(j),me(this.h(),b,"success",function(b){if((b=He(b.target))&&!b.r){var c=b.msg;z.forEach(this.Yu,function(b){b.W()===c&&b.Wc(j)});this.Xu=c}else U(b.msg)}),b.ajax("/answer/comment_permission?answer_id="+
this.oa,k,"GET"),this.EB=b;break;case "admin":GB(this);break;case "share":Y.ia({type:"ga_click_share_answer_box",target:c});this.rc();break;case "nohelp":this.sD(b);break;case "report":this.rr();break;case "favo":Y.ia({type:"ga_click_collect_answer_box",target:c}),this.nl()}};t.rr=ol(function(){Ft("answer",this.oa)},{ha:"question_answer_report",ad:j});
t.sD=ol(function(b){var b=b.target,c=!!b.m;Y.ia({type:"ga_click_answer_not_helpful",target:c?b.m():b});this.pv&&"pending"===this.pv.state()&&this.pv.abort();var d,e;e=c?b.xg():b.innerHTML;e=(d=-1<e.indexOf("撤销"))?"没有帮助":"撤销没有帮助";c?b.dm(e):b.innerHTML=e;d=d?"/answer/helpful":"/answer/not_helpful";c||wk(b);this.pv=$.post(d,{aid:this.oa})},{ha:"question_answer_not_helpful",ad:j});t.rc=ol(function(){new ku(["分享回答","answer",this.mb,{aid:this.oa}],"tb-webshare-sina")},{ha:"question_answer_share"});
t.nl=ol(function(){var b=kw.O();pw(b,this.oa);b.show()},{ha:"question_answer_collect",ad:j});t.pK=function(){this.sa||JB(this);this.sa.uf();$(this.Oh).toggleClass("focusin",this.sa.tc())};t.vw=ol(fw.prototype.pK,function(){return{ha:"添加评论"===$.trim($(K("toggle-comment",this.g)).text())?"question_answer_add_comment_start":m}});t.hr=ol(function(b){this.sa&&this.sa.tc()?this.sa.field.focus():this.vw();b.preventDefault()},{ha:"question_answer_add_comment_start"});
t.sr=ol(function(){var b=$("a[name=thanks]",this.Oh)[0];b&&!F.has(b,"disabled")&&(pk(b,"已感谢"),F.add(b,"disabled"),wk(b),$.post("/answer/thanks",{aid:this.oa}))},{ha:"question_answer_thank"});a.HB=function(b,c){b.h().e(c,"show",function(){F.add(this.Tc,"zm-item-meta-has-menu")}).e(c,"hide",function(b){b.currentTarget===b.target&&F.remove(this.Tc,"zm-item-meta-has-menu")})};
t.VL=function(b){var c=b.target,b=c.W();"禁止转载"===b?(b=!c.xe(),$.post("/node/AnswerMetaV2",{method:"set_copyright",params:{answer_id:this.oa,is_copyable:Number(b)}}),$(".copyright",this.Tc).html(b?"":'<span class="zg-bull">&bull;</span> 禁止转载')):"删除"===b?this.lr():b in FB&&$.post("/answer/comment_permission",{answer_id:this.oa,permission:b}).done(v(function(b){b&&!b.r&&z.forEach(this.Yu,function(b){b.Wc(b===c)})},this))};
t.lr=function(){Ai("你确定要删除自己的答案吗？","答案内容不会被永久删除，你还可以撤消本次删除操作。",function(b){b&&(this.Fg=j,this.status=-1,LB(this))},this)};a.LB=function(b){var c=new V(j);me(b.h(),c,"success",function(){R(this.g,!this.Fg);this.Fg?this.bu="set_delete":(IB(this),this.bu="cancel_delete");this.dispatchEvent("change");$(this.g).parent(".zm-item").hide()});c.ajax("/answer/"+(b.Fg?"remove":"unremove"),"aid="+b.oa)};t.m=p("g");a.MB=function(b,c,d){fw.call(this,b,c,d)};y(MB,fw);MB.prototype.o=function(b){MB.n.o.call(this,b);this.Ee&&this.gt(this.DK.jb)};MB.prototype.P=function(){return $(this.g).is(":visible")};a.NB=function(){T.call(this);this.data=ch||{};this.ka=this.data.ka;this.Qn=m;this.Ai={};this.vu=[];this.Sp=[];this.Qh=0;this.Sf=dh&&dh.url_token?dh:k};y(NB,T);t=NB.prototype;t.z=function(){kr.H(this);this.o(document.body)};
t.B=function(){NB.n.B.call(this);var b=J("zh-question-meta-wrap");b&&(this.kG=new sB(this.data),this.H(this.kG),this.kG.o(b));this.cx();var c=this;$(".js-ignore-invite").click(function(){$(".question-invited-by").hide();$.post("/question/askpeople",{qid:c.data.mb,uid:S.De,op:"pass"})});this.fo=new cy;this.h().e(this.fo,"change",this.yy);this.fo.z();this.UG();S.Rg&&$.post("/question/popup",{action:"no_answer",question_token:this.data.mb},function(b){if(b){var c=new kB;c.Ya("提问无人问津？");c.Ha(b);c.fa();
$(".js-gonext",c.g).on("click",function(){var b=$(this).parents('[class^="view"]').attr("class");"view-starting"===b?(c.Ya("第一条"),c.Ad("firsttip")):"view-firsttip"===b?(c.Ya("第二条"),c.Ad("secondtip")):"view-secondtip"===b?(c.Ya("第三条"),c.Ad("thirdtip")):"view-thirdtip"===b&&c.D(m)})}})};
t.UG=function(){this.data.mb=ch.mb;OB(this,j);if(S.ha()&&("close"!==ch.status&&(this.Na=new Do(this.data.Wz,this.data.ka),this.Na.ms=5,this.Na.ps=1,this.Na.PA=j,this.Na.us=j,this.Na.o(K("zm-tag-editor",this.g)),this.h().e(this.Na,["remove_tag","add_tag"],function(){Y.ia("ga_edit_question_topic_changed")}),this.h().e(this.Na,"start_editing",function(){Y.ia("ga_question_topic_edit_finish_changed")}),this.Na.addEventListener("beforeedit",Ux({Sl:j}))),"close"!==ch.status)){var b=J("zh-question-title");
if("false"!==b.getAttribute("data-editable")){this.Yc=new fB(this.data.ka,"/question/title","content",m,j);this.Yc.kC=j;this.Yc.Md=j;this.Yc.Ao=j;var c=$s(this.data.Rg);this.Yc.Pn=c;this.Yc.o(b);this.h().e(this.Yc,"change",function(){Ji.dispatchEvent("question_title_change");document.title=this.Yc.ab()+" - 知乎"});this.h().e(this.Yc,"click_edit",function(){Y.ia("ga_question_title_edit_start")});this.h().e(this.Yc,"cancel_edit",function(){Y.ia("ga_question_title_edit_cancel")});this.h().e(this.Yc,"save_changed",
function(){Y.ia("ga_question_title_edit_save_changed")});this.h().e(this.Yc,"save_unchanged",function(){Y.ia("ga_question_title_edit_save_unchanged")});this.Yc.addEventListener("beforeedit",Ux({Sl:j}))}}this.Tp=J("zh-question-answer-num");this.Vp=J("zh-question-answer-wrap");this.ph=J("zh-question-collapsed-link");this.Sm=J("zh-question-collapsed-wrap");this.jK=J("zh-question-collapsed-num");this.oJ=J("zh-question-answer-form-wrap");this.bk=J("zh-question-notification-summary");this.nm=J("zh-answers-filter");
this.Os=J("zh-add-question-sug");this.Tp&&(this.data.he=+this.Tp.getAttribute("data-num"));this.Vp&&(this.data.uQ=+this.Vp.getAttribute("data-pagesize"));this.ph&&this.h().e(this.ph,"click",this.tS);this.Os&&this.h().e(this.Os,"click",this.mD);this.nm&&Qg&&this.h().e(this.nm,"click",function(b){b.stopPropagation();F.add(this.nm,"activated");me(this.h(),document,"click",function(){F.remove(this.nm,"activated")})});(this.Vu=J("zg-question-suggested-topics"))&&this.h().e(this.Vu,"click",this.YO);this.Fn();
this.h().e(window,"hashchange",function(b){b=b.Ub;b.oldURL&&"writing"===b.oldURL.split("#")[1]||PB(this)});if(b=J("zh-question-answer-wrap")){var d=new Ct({ma:["expandLimit","nodeSource"],Wg:this.data.he>this.data.uQ&&!K("question-page-pager")});this.H(d);this.h().e(d,"itemcreated",function(b){d.H(QB(this,b.item));$("img.lazy",b.item).lazyload({data_attribute:"actualsrc",threshold:400})});d.o(b)}b=S[4];eh&&eh.length&&(b=eh[0][1]);this.wb=new cB(this.data.jb,S,b);this.H(this.wb);this.wb.o(this.oJ);
$g.Dd&&$g.Dd.length?this.wb.Ha($g.Dd[0]):!ah.uc&&B&&this.wb.Ha("<p></p>");if(!this.data.ox&&!this.Qh&&(!this.Sf||!this.Sf.url_token))if(this.data.Am&&this.data.Am.length&&this.data.Am[3]!==S.De)this.wb.Xa(m,"只有 "+Xs(this.data.Am)+" 能回答此问题");else if("normal"===ch.status||$g.Dd)S.Rg||this.wb.of();this.h().e(this.wb,"change",this.ZO);this.h().e(this.wb,"cancel_delete_answer",this.fP);this.wb.ready(function(){var b=this.dr();b&&"writing"===location.hash.slice(1)&&b.execCommand("toggleFullScreen")});RB(this);
PB(this,k);SB(this);this.h().e(Ji,"anon_change",function(b){this.data.jb=b.jb});bh&&setTimeout(function(){location.href=bh},5E3)};t.cx=function(){ou("question",this.data.mb,"read");this.h().e(this,["click!","show!"],function(b){"comment"===b.namespace&&b.xc.fill("category","question_answer").fill("label","question_answer");"invitation"===b.namespace&&b.xc.fill("label","question_page")})};
t.yy=function(){this.fN=j;this.bk=$(this.fo.RO)[0];jc(this.bk,J("zh-question-redirect-info"));R(this.bk,j);ah.uc||(this.Xi=new gq,this.Xi.o(this.bk),Jr(this.Xi));this.h().e(this.bk,"click",this.mD);PB(this)};a.OB=function(b,c){!S.ha()||!c?(TB(b,"zh-question-detail",ha),TB(b,"zh-question-answer-summary",ha)):(TB(b,"zh-question-detail",b.yN),TB(b,"zh-question-answer-summary",b.AN))},a.TB=function(b,c,d){if(c=J(c)){var e=new Bt;b.h().e(e,"expand",d).e(e,"invalid",d);e.o(c)}};
t.yN=function(b){if("close"!==ch.status){b=b.target.m();this.xb=new fB(this.data.ka,"/question/detail","content",j,k,600);var c=$s(this.data.Rg);this.xb.Pn=c;this.xb.ZV=Ek;K("zm-editable-content",b).innerHTML&&(this.xb.Ao=j);this.xb.o(b);this.h().e(this.xb,"click_edit",function(){Y.ia("ga_question_supplement_edit_start")});this.h().e(this.xb,"cancel_edit",function(){Y.ia("ga_question_supplement_edit_cancel")});this.h().e(this.xb,"save_changed",function(){Y.ia("ga_question_supplement_edit_save_changed")});
this.h().e(this.xb,"save_unchanged",function(){Y.ia("ga_question_supplement_edit_save_unchanged")});this.xb.addEventListener("beforeedit",Ux({Sl:j}))}};
t.AN=function(b){var b=b.target.m(),c=J("zh-question-answer-summary-link"),d;if(b&&(ah.kE||!this.data.rS))d=new Eq(j,"/question/summary","content"),d.params=["id="+this.data.ka],d.kq=m,d.o(b);if(c){var e=J("zh-question-answer-summary-wrap");this.h().e(c,"click",function(){d&&(R(e,j),d.of())}).e(e,"click",function(b){"cancel"===b.target.name&&(b=!d.$e(),R(e,!b))})}this.qS=d;this.qS.addEventListener("beforeedit",Ux({Sl:j}))};
t.mD=function(b){if("close"===b.target.name){if(this.Xi&&(mq(this.Xi),lq(this.Xi,m),history.replaceState)){var b=new uf(location.href),c=b.fd();c.remove("q");c.remove("psq");history.replaceState({},"",b.Wf+"?"+c.toString())}R(this.bk,m);R(this.Os,m)}else if("A"===b.target.tagName&&"zh-question-suggest-reask"===b.target.id&&(R(this.Os,m),Y.fireEvent("query_string_change")),c="a"===$(b.target).prop("tagName").toLowerCase()?b.target:this.Ye(b.target,"A"))b.preventDefault(),b.stopPropagation(),b=c.getAttribute("data-source")||
c.href,c=b.indexOf("#"),b=0>c?k:b.substr(c+1),PB(this,b&&decodeURIComponent(b))};
a.SB=function(b){b.data.sq=+b.jK.innerHTML;S.ha()||(b.data.sq=0);R(b.ph,0<b.data.sq);b.Tp&&wc(b.Tp,b.data.he?b.data.he+" 个回答":"还没有回答");b.nm&&R(b.nm,1<b.data.he);R(b.ph,0<b.data.sq)},a.QB=function(b,c,d,e){e=new MB(b.ka,k,e);e.o(c);b.Ai[e.oa]=e;b.Sp.push(e.oa);b.h().e(e,"change",b.by);e.Ee&&(b.Qh=e.oa,e.wJ=S,b.h().e(e.ge,"change",b.EM),b.mg=e);e.rj?e.Ee&&b.Sm.appendChild(e.m()):b.vu.push({added_time:e.cv,vote:d,aid:e.oa});e.Fg&&R(e.m(),m);return e};
t.EM=function(){var b=this.mg,c=b.m(),d=b.ge.ab()[0];R(c,m);d=ec(La(d));ic(d,c);this.Ai[b.oa]=k;this.Sp=z.filter(this.Sp,function(c){return c!==b.oa},this);var e=999;this.vu=z.filter(this.vu,function(c){c.aid===b.oa&&(e=c.vote);return c.aid!==b.oa},this);M(c);b.G();QB(this,d,e,m)};
t.by=function(b){b=b.target;if(b instanceof MB){var c=b.m();switch(b.bu){case "collap":this.Sm.appendChild(c);F.add(c,"zm-item-collapsed");this.data.he--;SB(this);break;case "cancel_collap":this.Vp.appendChild(c);F.remove(c,"zm-item-collapsed");UB(this,c);this.data.he++;SB(this);break;case "set_delete":RB(this);this.data.he--;SB(this);break;case "cancel_delete":UB(this,this.Ai[this.Qh].m()),RB(this),this.data.he++,SB(this)}}};
a.RB=function(b){var c=k,d=k,e,g={suggest:"建议修改",evaluate:"建议修改",close:"关闭"};!$g.Dd&&"normal"!==ch.status&&(d="被"+g[ch.status]+'的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>');b.Qh?(e=b.Ai[b.Qh],c="#answer-"+e.oa,e=e.Fg):b.Sf&&(c="/question/"+ch.mb+"/answer/"+b.Sf.url_token,e=b.Sf.is_delete);c&&(d=e?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':'一个问题你只能回答一次，但你可以对 <a href="'+
c+'">现有的回答</a> 进行修改');S.Rg&&(!b.Qh&&!b.Sf)&&(d='添加回答：<a href="javascript:;" name="answer_my_question">回答自己的提问</a>');b.data.ox&&(d='该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>');d&&b.wb.Xa(m,d)};t.VC=function(b){return this.Ai[b]};a.VB=function(b,c){var d=J("zh-question-collapsed-switcher");c?(d.name="collap",b.FB=j,R(b.Sm,j),F.add(b.ph,"zu-question-collap-title-active")):(b.FB=m,d.name="expand",R(b.Sm,m),F.remove(b.ph,"zu-question-collap-title-active"))};
t.tS=function(b){if((b=Ck(this.ph,b.target))&&b.name)if("expand"===b.name){if(!this.lK){this.lK=j;var c=this,d=this.Sm,b=$.get("/node/QuestionCollapsedAnswerListV2",{params:{question_id:this.data.ka}});b.done(function(b){b=ec(b);VB(c,j);F.remove(d,"zm-question-collapsed-list-loading");d.appendChild(b);z.forEach(nc(d),function(b){b!==e&&QB(c,b,99999)});$("img.lazy",d).lazyload({data_attribute:"actualsrc",threshold:400})});var e=nc(d)[0];e&&(R(e,m),b.done(function(){R(e,j)}));R(d,j);F.add(d,"zm-question-collapsed-list-loading")}VB(this,
j)}else VB(this,m)};t.fP=function(){var b=this.Ai[this.Qh],c;b?(b.Fg=m,b.status=0,LB(b),UB(this,b.m())):(c=this.Sf,b=new V(j),me(this.h(),b,"success",function(){window.location.href="/question/"+ch.mb+"/answer/"+c.url_token}),b.ajax("/answer/unremove","aid="+c.id))};
t.ZO=function(){var b=this.wb.Rp.checked,c={fF:j,title:"确认放弃匿名身份？",content:"你在该问题下的赞同和关注行为将以实名显示。"},d=v(function(){if(!this.xhr||!this.xhr.Xb()){var c=this.wb.$e();if(c){var d=new V(j),h=new hj,l=b?1:0;h.add("id",this.ka).add("content",c).add("anon",l);d.on("success",function(){ch.jb!==l&&Ji.dispatchEvent(new Gr(l));var b=He(this.xhr);b&&!b.r?(b=ec(La(b.msg[0])),this.Vp.appendChild(b),QB(this,b,this.Sp.length,j),RB(this),ch.jb||(this.NO=new NA(this.Ai[this.Qh]),this.NO.show()),S.kL&&$("#answer-my-question-tip").insertAfter($("#zh-question-answer-form-wrap")).show(),
this.data.he++,SB(this)):U(b.msg)},m,this);d.ajax("/answer/add",h.toString());this.xhr=d}}},this);ch.jb&&!b?Ai(c,function(b){b&&d()}):d()};t.Ye=ba();t.YO=function(b){if((b=this.Ye(b.target))&&b.name){var c=b.name;"close"===c?R(this.Vu,m):"addtag"===c&&(this.Na.Me(b.id.split("-")[1],b.innerHTML),R(b,m))}};t.Fn=function(){this.wz=new PA(this.ka);this.wz.z()};
a.PB=function(b,c){if(c=c||location.hash.slice(1)){var d=c.split("-"),e=d[1];"answer"===d[0]&&(d=b.VC(e))&&(d.rj&&!b.FB?UB(b,b.ph):UB(b,d.m()))}},a.UB=function(b,c){if(c){var d=vg(document.body).top,e=b.fN?mg(b.bk).height:0,d={paddingTop:d+e};"number"===$.type(d)&&(d={offsetTop:d});d.OH=us;ts(c,d);wk(c);b.Xi&&b.Xi.pp()}};a.WB=function(){NB.call(this);this.data=ch;this.ka=this.data.ka};y(WB,NB);t=WB.prototype;
t.UG=function(){(this.Jq=J("zh-single-answer-disable-wrap"))&&this.h().e(this.Jq,"click",this.rR);this.vl();this.Fn();var b=$("#zh-question-answer-collestions");b.length&&$("a[name=focus]",b).click(function(){ql(this,"favlist")});OB(this,m);if(b=$("#zh-question-answer-collections > .zh-general-list").get(0)){var c=new Ct({ma:["autoload","nodeSource"]});this.H(c);c.o(b)}if(b=$(".awesome-answer-list").get(0)){var d=new Ct({ma:["expandLimit"],Wg:m});this.H(d);this.h().e(d,"itemcreated",function(b){var c=
new cw;c.o(b.item);d.H(c)});d.o(b)}};t.cx=function(){this.h().e(this,["click!","show!"],function(b){"invitation"===b.namespace&&b.xc.fill("label","answer_page")});WB.n.cx.call(this)};t.rR=function(b){b.target&&b.target.name&&(b=this.Rb,b.Fg=m,b.status=0,LB(b))};
t.vl=function(){var b=K("zm-item-answer",J("zh-question-answer-wrap"));if(b){this.Rb=new MB(this.ka);this.H(this.Rb);this.Rb.o(b);b=this.h();b.e(this.Rb,"change",this.by);if(this.Rb.Ee){b.e(Ji,"anon_change",function(b){var c=b.jb,b=$("#js-sidebar-author-info");if(!$("a[name=focus]",b).length){var g={"0":"fullname",1:"url_token",2:"avatar_path",3:"hash",4:"headline"},h=z.reduce(S,function(b,c,d){b[g[d]]=c;return b},{}),c=Ik(this.xJ,{author:!c&&h});b.html(c)}});var c=this.Rb.ge;c&&b.e(c,"change",function(){var b=
La(c.ab()[0]),b=ec(b);lc(b,this.Rb.g);this.vl(b)})}XB(this);JB(this.Rb,{autofocus:m,KE:j})}};t.VC=function(b){if(this.Rb.oa===b)return this.Rb};t.xJ='<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
t.Fn=function(){this.wz=new PA(this.ka,this.Rb);this.wz.z();var b=J("js-sidebar-author-info");b&&(new Qx(b)).z()};t.by=function(b){b=b.target;if(b instanceof MB)switch(b.bu){case "collap":F.add(b.m(),"zm-item-collapsed");break;case "cancel_collap":F.remove(b.m(),"zm-item-collapsed");break;case "set_delete":case "cancel_delete":XB(this),location.reload()}};
a.XB=function(b){b.Rb?b.Rb.Fg?(b.Jq.innerHTML=b.Rb.Ee?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':"此答案已经被作者删除",R(b.Rb.m(),m)):R(b.Rb.m(),j):b.Jq.innerHTML="此答案已经被作者删除"};a.YB=function(){T.call(this);this.page=1};y(YB,T);YB.prototype.z=function(){var b=K("js-topic-feed-page");this.o(b)};
YB.prototype.B=function(){YB.n.B.call(this);var b=this;this.oA=$(".js-topic-feed-container",this.g);this.oA.find(".js-topic-item").each(function(){var c=new ZB;b.H(c);c.o(this)});this.Gs=new $B;this.Gs.o($(".js-pinned-topics",this.element)[0]);(this.Yb=J("js-load-more"))&&this.h().e(this.Yb,"click",this.ly);$(".instruction .close-normal").click(function(){var b=new V(m);b.ajax("/notifeature?feature=6",k,"GET");vd(b,"success",function(){$(".instruction").fadeOut()})});this.h().e(this.Gs,"change",function(b){$("#tf-"+
b.qH).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')})};a.aC=function(b,c){wc(b,c?"加载中...":"更多")};YB.prototype.ly=function(){aC(this.Yb,j);this.xhr=new V(j);me(this.h(),this.xhr,"complete",v(this.hf,this));var b=new Dk;b.add("page",++this.page);this.xhr.ajax(location.pathname,b.fd())};
YB.prototype.hf=function(){var b=this,c=He(this.xhr);c&&!c.r&&(0<c.msg.length?($(c.msg).each(function(c,e){var g=new ZB;b.H(g);g.o($(e)[0]);b.oA.append(g.m())}),aC(this.Yb,m)):$(this.Yb).hide())};a.ZB=function(){T.call(this)};y(ZB,T);ZB.prototype.B=function(){ZB.n.B.call(this);this.h().e(this.g,"click",v(this.$x,this))};
ZB.prototype.$x=function(b){var c=b.target,b=$(c).attr("data-action"),d=$(this.g).find(".topic-avatar img"),e=d.clone(),g,h=$(this.g).data("id");if("pin-topic"===b)g=this.getParent().Gs,$.post("/pin-topic/add",{tid:h},$.proxy(function(b){!b.r&&b.msg?($(this.g).append($(this.iR({topic:b.msg})).hide().fadeIn()),bC(this)):U(b.msg,2E3)},g)).done(function(b){if(!b.r&&b.msg){wk(c);$(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="zg-gray unpin topic-hover-content" style=""><i class="z-icon-unpin"></i>取消固定</a>');
var b=d.offset(),h=$(g.g).offset();1E3<b.top-h.top?(h=$(".top-nav-topic-selector.current a").offset(),h={top:h.top+20,left:h.left+15,width:"25px",height:"25px",opacity:0.1},e.css({position:"absolute","z-index":"999"}).css("top",b.top).css("left",b.left).appendTo("body").animate(h,300,function(){e.remove()})):e.css({position:"absolute","z-index":"999"}).appendTo("body").css("top",b.top).css("left",b.left).animate({top:h.top-63+$(g.g).height(),left:h.left,width:"-=50px",height:"-=50px",opacity:0.5},
300,function(){e.remove()})}});else if("unpin-topic"===b){var l=this.getParent().Gs,n=function(){var b=$(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')[0];wk(b)},q=$(l.g).find("[data-topicid="+h+"]");q.fadeOut(function(){q.remove();l.xt().done(function(){n&&n()});l.dispatchEvent({type:"change",qH:q.attr("data-topicid")})})}else if("follow"===b||"unfollow"===b)ql(c,"topic",k,["follow","unfollow"]),
$(this.g).fadeOut()};a.$B=function(){T.call(this)};y($B,T);$B.prototype.iR=Ik('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
$B.prototype.B=function(){$B.n.B.call(this);this.h().e(this.g,"click",v(this.$x,this));bC(this)};a.bC=function(b){b.Ef&&b.Ef.G();var c=new ns;c.Nq="pin-topic-moving";os(c,b.g,0);c.z();b.h().e(c,"dragend",v(b.xt,b));b.Ef=c;$("a",b.g).each(function(){b.h().e(this,"mousedown",function(b){b.stopPropagation()})})};
$B.prototype.$x=function(b){var c=this,d=b.target,e=$(d).attr("data-action");if(e){var g=$(d).parents(".js-pin-item");if("up"===e){var b=g.position(),h=g.clone();g.before(h).css({position:"absolute","z-index":"999"}).css("top",b.top).animate({top:$(c.g).position().top},200,function(){h.remove();g.css({position:"relative",top:0}).prependTo(c.g);c.xt()});h.css("opacity",0)}else"remove"===e&&g.fadeOut(function(){g.remove();c.xt();c.dispatchEvent({type:"change",qH:g.attr("data-topicid")})})}else b.stopPropagation()};
$B.prototype.xt=function(){var b=[];$(this.g).find("div.js-pin-item").each(function(){b.push($(this).attr("data-topicid"))});return $.post("/pin-topic",{topic_ids:b.join(",")},ba())};a.cC=function(){T.call(this);this.CC="even";this.Wm="current"};y(cC,T);t=cC.prototype;t.z=function(){kr.H(this);this.o(document.body)};
t.B=function(){cC.n.B.call(this);this.Tt=$("ul.zm-topic-cat-main").children();var b=this.pd=$("div.zh-general-list"),c=new Ct({ma:["autoload","nodeSource"]});this.H(c);c.o(b.get(0));this.h().e(c,"next",this.Op);this.FE=c;b.on("click","a.follow",function(){ql(this,"topic",xa(wk,this),k,{follow_text:"关注"})});O(window,"hashchange",this.BF,m,this);this.BF()||(b.show(),this.Op())};
t.Op=function(){var b=this.pd.show().children();if(!b.length)return this.pd.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>');b.removeClass("no-border "+this.CC);b.filter(":odd").addClass(this.CC);b=b.last();b.index()%2?b.add(b.prev()).addClass("no-border"):b.addClass("no-border");var b=this.gr(),c=b.params&&b.params.topic_id,b=this.Tt.filter(function(){return $(this).attr("data-id")===String(c)});b.length&&b.addClass(this.Wm).siblings().removeClass(this.Wm)};
t.gr=function(){return this.pd.data("init")};t.BF=function(){var b;a:{var c=decodeURIComponent(location.hash.slice(1));if(c&&(b=this.Tt.filter(function(){return $(this).text()===c}),b.length&&this.Tt.filter("."+this.Wm).text()!==c)){b.addClass(this.Wm).siblings().removeClass(this.Wm);b={params:{topic_id:b.data("id")}};var d=this.gr();$.extend(j,d,b);this.pd.attr("data-init",JSON.stringify(d));this.pd.empty();this.FE.Hi();this.FE.Gx();b=j;break a}b=i}return b};a.dC=function(){T.call(this)};y(dC,T);dC.prototype.z=function(){kr.H(this);this.o(document.body)};dC.prototype.B=function(){dC.n.B.call(this);eC(this,"zh-global-logs-wrap");eC(this,"zh-global-logs-questions-wrap");eC(this,"zh-question-log-list-wrap")};a.eC=function(b,c){var d=J(c);if(d){var e=new Ct;b.H(e);e.ma("locationSource",{Es:j});e.o(d);$(d).on("click",'a[name="revert"]',function(){if(Ux({Sl:j})()===m)return m;Cx(this);return m})}};a.fC=function(){T.call(this)};y(fC,T);fC.prototype.z=function(){kr.H(this);this.o(document.body)};fC.prototype.B=function(){fC.n.B.call(this);this.En("zh-question-followers-list-wrap")};fC.prototype.En=function(b){if(b=J(b)){var c=new Ct;this.H(c);c.ma("locationSource");c.o(b)}};a.gC=function(b,c){var d;if(b&&c){d=d||"text-highlight";var e=RegExp(c,"i");$(b).find("*").andSelf().contents().each(function(){if(3===this.nodeType){var b=this,h=b.parentNode;if(!F.has(h,d))for(var l,n;-1!==(l=b.data.search(e));)l=0<l?b.splitText(l):b,b=l.splitText(c.length),n=document.createElement("em"),n.className=d,n.appendChild(l.cloneNode()),h.replaceChild(n,l)}})}};a.hC=function(){tt.call(this,{ma:["autoload","dataPagingSource"]})};y(hC,Ct);hC.prototype.hq=function(){return ec('<button class="feeds-loading"><span>更多</span></button>')};hC.prototype.sz=function(b){this.Ed&&(wc(this.Ed.firstChild,b?"努力加载中...":"更多"),F.enable(this.Ed,"loading",b))};a.iC=function(){T.call(this);this.Og="roundtable";this.Do=ph.roundtable};y(iC,T);iC.prototype.vi=function(){Xv.call(this,"answer");this.Jv="entry-expaneded";this.os="item-footer";this.vp="votebar"};y(iC.prototype.vi,Xv);t=iC.prototype.vi.prototype;
t.Hm=function(){iC.prototype.vi.n.Hm.call(this,{".js-expand":this.Ka,".js-thank":this.sr});this.dx();var b=$(".phone-actions",this.m());if(b.length){var c=new St;c.o($(".menu",b)[0]);c=new gz("operation",c);c.Vl=j;jz(c);iz(c);c.nc=mf;c.o($(".menubutton",b)[0])}var d=new Bt({Zu:"content",jH:"script.content"});this.H(d);d.o(this.m());this.h().e(this,["expand","collapse"],function(b){b.target===this&&d.Ka("expand"===b.type,j)}).e(d,["expand","collapse"],function(b){this.Ka("expand"===b.type)})};
t.dx=function(){var b,c,d=$("."+this.vp,this.m())[0];d&&(b=this.sb=new bu(this.ub,this.entryType),this.H(b),Qc(this,b),b.o(d),(d=$(".js-mobi-vote",this.m())[0])&&(new Yv(b)).o(d));if(d=$(".zm-item-vote-info",this.m())[0])c=new $v(this.ub,this.entryType),this.H(c),Qc(this,c),c.o(d);b&&c&&this.h().e(b,"change",function(){c.Xh()}).e(c,"change",function(){$("[data-bind-votecount]",this.m()).text(c.Ra())})};
t.sr=ol(function(b){if((b=b.target)&&!F.has(b,"thanked"))pk(b,"已感谢"),F.add(b,"thanked"),$.post("/answer/thanks",{aid:this.ub})},{ha:"question_answer_thank"});t.rc=function(){iC.prototype.vi.n.rc.call(this,"分享回答","answer",this.yh,{aid:this.ub})};t.nl=ol(function(){var b=kw.O();pw(b,this.ub);b.show()},{ha:"question_answer_collect",ad:j});
t.fe=function(){iC.prototype.vi.n.fe.call(this);mk(this.$f.register("v",function(){this.sb&&this.sb.Gt()},this),{group:"操作",name:"赞同"});mk(this.$f.register("d",function(){this.sb&&this.sb.Ft()},this),{group:"操作",name:"反对"});mk(mk(mk(mk(mk(this.$f.register("o",this.uf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.gp,this),{group:"操作",name:"打开评论"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("s c",this.nl,this),{group:"操作",name:"收藏"}).register("shift+c",this.Aw,this),{group:"操作",
name:"定位到评论框"})};iC.prototype.FA=function(){Xv.call(this,"question");this.os="item-footer"};y(iC.prototype.FA,Xv);iC.prototype.z=function(){kr.H(this);this.o(document.body);this.Gn();this.Nr();jC();var b=$(".rt-comment-box")[0];if(b){var c=new Jv(this.Do.id,"roundtable");this.H(c);c.o(b)}};iC.prototype.Gn=function(){this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.xc.fill("label","roundtable").fill("category",this.Og)})};
iC.prototype.Nr=function(){function b(b){b=b.getAttribute("data-type");return(b={answer:iC.prototype.vi,question:iC.prototype.FA}[b])?new b:new T}var c=this;$("[data-paging]").each(function(){var d=new hC;d.ma("childConstructor",{factory:b});this.getAttribute("data-navigable")!==k&&d.ma("shortcut",{items:">.item"});c.H(d);d.o(this)})};
a.jC=function(){var b=$(".roundtable-profile");$(".share",b).click(ol(function(){var b=$(this).data();new ku(["分享活动","roundtable",b.token,{roundtable_id:b.id}],"tb-webshare-sina");Y.ia({type:"ga_click_share_roundtable_box",target:this,data:{type:"sina"}})}));$(".follow",b).click(ol(function(){var c=this;ql(c,"roundtable",function(d){$(".label",c).text(d?"取消关注":"关注");var e=$(".followers .count",b),d=Number(e.data("count"))+(d?1:-1);e.length&&(d=Math.max(d,0),e.text(d).data("count",d))},["button-success",
"button-cancel"])}))};a.kC=function(){T.call(this);this.bz=ph.searchKeyword};y(kC,T);
kC.prototype.z=function(){function b(b,d){var g=$(b);$.each(d(),function(b,d){g.on("click",b,function(b){e.apply(k,c(d,b))})})}function c(b,c){return g(b,function(b){return qa(b)?b(c):b})}kr.H(this);this.o(document.body);this.Nr();var d=encodeURIComponent(this.bz);$("ul.list[data-paging]").on("click",".item a[href!=#]",function(b){b=b.currentTarget;b.host&&(b=$(b).closest(".item").index()+1,Mf.set("s-q",d),Mf.set("s-i",b),Mf.set("sid",Pk()))});var e=xa(W,"search"),g=z.map;b(".related-topics",function(){return{"a.avatar-link":["visit_topic",
"search_result_card_topic_avatar"],"a.name-link":["visit_topic","search_result_card_topic"],"a[href$=questions]":["visit_topic_questions","search_result_card_topic"],"a[href$=top-answers]":["visit_topic_topanswers","search_result_card_topic"],"a[href$=followers]":["visit_topic_followers","search_result_card_topic"],"button.zg-btn-follow":["click_follow_topic","search_result_card_topic"],"button.zg-btn-unfollow":["click_unfollow_topic","search_result_card_topic"],'a[href^="/search?"]':["click_search_result_more",
"search_result_card_topic"]}});b(".related-users",function(){return{"a.avatar-link":["visit_people_profile","search_result_card_people_avatar"],"a.name-link":["visit_people_profile","search_result_card_people"],"a[href$=answers]":["visit_people_answers","search_result_card_people"],"a[href$=followers]":["visit_people_followers","search_result_card_people"],"a[href$=posts]":["visit_people_posts","search_result_card_people"],"button.zg-btn-follow":["click_follow_people","search_result_card_people"],
"button.zg-btn-unfollow":["click_unfollow_people","search_result_card_people"],'a[href^="/search?"]':["click_search_result_more","search_result_card_people"]}});b(document.body,function(){var b=xa(Ga,"search_result_%s_more_button");return{"ul.list.questions + .zu-button-more":["click_search_result_more",b("all")],"ul.list.users + .zu-button-more":["click_search_result_more",b("user")],"ul.list.topics + .zu-button-more":["click_search_result_more",b("topic")]}});b(".search-tabs",function(){var b=xa(Ga,
"search_result_tab_%s");return{'a[href^="/search?type=question"]':["click_search_result_tab",b("all")],'a[href^="/search?type=people"]':["click_search_result_tab",b("user")],'a[href^="/search?type=topic"]':["click_search_result_tab",b("topic")]}});b(".range-selector",function(){var b=xa(Ga,"search_result_range_%s");return{'a[href*="range=1d"]':["click_search_result_range",b("1d")],'a[href*="range=1w"]':["click_search_result_range",b("1w")],'a[href*="range=3m"]':["click_search_result_range",b("3m")]}});
b("ul.list.questions",function(){function b(){return function(b){return"search_result_all_list_"+($(b.target).closest(".item").index()+1)+""}}return{"a.question-link":["visit_question",b()],".js-expand, .summary":["click_expand",b()],'a[name="collapse"]':["click_collapse_answer",b()],"a.zg-follow":["click_follow_question",b()],"a.zg-unfollow":["click_unfollow_question",b()]}});b("ul.list.users",function(){function b(c){return function(b){return"search_result_user_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_people_profile",b("_avatar")],"a.name-link":["visit_people_profile",b()],"a[href$=answers]":["visit_people_answers",b()],"a[href$=followers]":["visit_people_followers",b()],"a[href$=posts]":["visit_people_posts",b()],"button.zg-btn-follow":["click_follow_people",b()],"button.zg-btn-unfollow":["click_unfollow_people",b()]}});b("ul.list.topics",function(){function b(c){return function(b){return"search_result_topic_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_topic",b("_avatar")],"a.name-link":["visit_topic",b()],"a[href$=questions]":["visit_topic_questions",b()],"a[href$=followers]":["visit_topic_followers",b()],"button.zg-btn-follow":["click_follow_topic",b()],"button.zg-btn-unfollow":["click_unfollow_topic",b()]}});this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","search").fill("label","search_result_answer")});var h=$("#js-search-question-form");h.length&&h.submit(function(b){b.preventDefault();
b=Hq.O();b.show();Kq(b,$(".title-input",h).val())});gC("[data-highlight]",this.bz)};
kC.prototype.Nr=function(){function b(b){var c=new T;$("li.answer-item",b).each(function(){var b=new iC.prototype.vi;b.os="actions";b.vp="zm-votebar";c.H(b);b.o(this)});return c}var c=this;$("[data-paging]").each(function(){var d=new Ct({ma:["autoload","dataPagingSource"]});d.ma("childConstructor",{factory:b});var e=$(this).data("navigable");e&&d.ma("shortcut",e);c.H(d);d.o(this);ut(d,function(b){gC($("[data-highlight]",b),c.bz)})})};a.lC=function(){};lC.prototype.z=function(){var b=J("zh-invited-member-list");b&&(new Px(b,"/invitation/more","people",["zg-btn-follow","zg-btn-unfollow"],j)).z();(b=J("zh-invited-sina-member-list"))&&(new Px(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j)).z();J("zh-sina-invite")&&(new Ox).z();new Zk(J("invite_friend"))};a.mC=function(b,c){var d=this.F={};G.extend(d,this.defaults,c||{});this.input=b;this.Tb=d.Tb;this.bh=this.zQ();this.Ku=[];this.Ku.push({action:"remove",method:this.removeTag,ev:d.ZQ,R:"删除"});setTimeout(v(this.lg,this))};y(mC,Fd);
ya(mC.prototype,{defaults:{source:"/topic/autocomplete",Tb:k,JK:"",Ou:m,ZS:"/topic/%s",template:'<li data-id="<%=id%>"><a class="tag-link" href="<%=url%>"><%=name%></a></li>',parse:function(b){var c=$(b);return{Ws:j,id:c.data("id"),url:b.href,name:c.text()}},UR:mf,ZK:"canedit",wv:"empty",Mm:"button",ZQ:"remove-button"},wS:function(b){return xt(this.F.ZS,b.url_token)},has:function(b){return!!z.find(this.bh,function(c){return c.name===b.name||c.id===b.id})},iL:function(b){return z.find(this.bh,function(c){return c.name===
b})},uW:function(b){return z.find(this.bh,function(c){return c.id===b})},Sh:function(){var b=!!nc(this.Tb).length;F.enable(this.Tb,this.F.wv,!b);this.dispatchEvent("change")},add:function(b,c){if(b&&(this.has(b)||this.bh.push(b),b.Ws=m,c||this.F.UR.call(this,b)))this.gR(b),b.Ws=j,this.dispatchEvent("add"),this.Sh()},remove:function(b){this.bh=z.filter(this.bh,function(c){return b!==c.id},this);this.dispatchEvent("remove");this.Sh()},HL:function(){return z.filter(this.bh,function(b){return b.Ws!==
m})},GL:function(){return z.map(this.HL(),function(b){return b.id})},gR:function(b){b=ec(this.wG(b));this.Tb.appendChild(b);this.Be(b)},wG:function(b){return Ik(this.F.template,b)},X:function(){this.Tb.innerHTML=z.map(this.bh,this.wG,this).join("")},zQ:function(){return z.map(this.gD(),this.F.parse)},gD:function(){return nc(this.Tb)},lg:function(){var b=this,c=b.F,d=this.input,e={source:c.source,Qj:Gc(b.input,function(b){return"static"!==$.css(b,"position")}),placeholder:this.input.getAttribute("placeholder"),
select:function(d){b.add({id:d.id,name:d.id?d.label:b.input.value,url:b.wS(d),avatar:d.avatar,url_token:d.url_token});return c.JK},filter:function(d){return z.filter(d,function(d){return c.Ou&&!d.id?m:!z.find(b.bh,function(b){return b.Ws&&b.id===d.id})})}},g={Vc:function(b,c,d){d.innerHTML=l(b.data)}};G.extend(g,e||{});var h=new xo(d,g);O(h,"show",function(){1<h.eb.length&&!h.eb[0].id&&Pm(h)});var l=Ik('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
this.Y=h;z.forEach(this.gD(),this.Be,this);O(this.input,"keypress",function(d){var e;if(13===d.keyCode&&!c.Ou&&(e=La(this.value))&&!b.Y.ob())b.add(b.iL(e)||{id:k,name:e,url:"/topic/"+e})});this.Sh()},removeTag:function(b){this.remove($(b).remove().data("id"))},AQ:function(b,c){var d=z.find(this.Ku,function(c){return c.action===b});d&&d.method&&d.method.call(this,c);this.input.focus()},Be:function(b){var c=this.F;F.add(b,c.ZK);z.forEach(this.Ku,function(d){var e=new $n(" ",ko.O());e.kh([c.Mm,d.ev].join(" "));
e.X(b);e.Xa(j);e.Kc(d.R);e.addEventListener("action",function(){this.AQ(d.action,b)},m,this)},this)}});a.nC=function(){this.qA=this.rA=k};
nC.prototype.z=function(){function b(b,c){var g=L("li"),h=L("span","item-label",b);g.appendChild(h);var l=new $n("",ko.O());l.kh("zm-profile-tag-btn zm-profile-tag-btn-del");l.Xa(j);l.Kc("移除动作");l.Aa(c);l.addEventListener("action",function(){var b=l.W();e(b,m);M(g);X.Ts(j);d()});l.X(g);Ya.appendChild(g)}function c(){la.D(X.hl()!==z.filter(X.Hb(),function(b){return!!(b.Z&8)}).length)}function d(){z.forEach(Q,function(b){b.selected||(b=new Ey(b.text,b.value),X.Fa(b))});c()}function e(b,c){var d=z.find(Q,
function(c){return c.value===b});d&&(d.selected=c)}function g(){var b=$.grep(n.get(0).options,function(b){return b.selected});$.map(b,function(b){return b.value})}function h(){q=H.GL();I.val(q.join(","))}var l=$("#rq-settings-ui"),n=$("select.select",l);$(".topics-num",l);$(".actions-num",l);var q=[];this.qA=$("#rq-info-block");l.on("click",".beginedit-button",function(b){b.preventDefault();l.addClass("expanded-view")}).on("click",".exitedit-button",function(b){b.preventDefault();l.removeClass("expanded-view")}).on("click",
".endedit-button",function(b){b.preventDefault();l.get(0).submit()});var r=$(".topic-editor",l),w=$("input.topic-input",r).get(0),E=$("ul.tag-list",r).get(0),H=new mC(w,{Ou:j,Tb:E}),I=$('input[name="topics"]',r);H.on("change",h);n.on("change",g);h();g();r=n.get(0);R(r,m);var Q=r.options,X=new St;X.on("action",function(d){d=d.target;b(d.xg(),d.W());e(d.W(),j);X.removeItem(d);c()});var la=new gz("添加动作",X);la.kh("menu-button");la.X(r.parentNode);la.Vl=j;jz(la);var Ya=L("ul","display-list");d();z.forEach(Q,
function(c){c.selected&&b(c.text,c.value)});r.parentNode.insertBefore(Ya,la.m());var Ma=this,r=$("#rq3-item-list"),Qa={AS:function(b){return $.post("/watch/thank",{id:b,rq_type:"thank"})},OQ:function(b){return $.post("/watch/seen",{id:b,rq_type:"seen"})}};r.on("click",".read-button",function(){var b=$(this).closest(".rq-item"),c=b.data("id");Qa.OQ(c);c=te.text()||0;0<c&&te.text(c-1);var d=Ma.qA,e=Number(Ma.rA.text());setTimeout(function(){d.toggleClass("hidden",!!e)},210);b.slideUp(function(){b.remove()})}).on("click",
".thank-button",function(b){b.preventDefault();var b=$(this),c=b.closest(".rq-item").data("id");b.hasClass("thanked")||(Qa.AS(c),b.addClass("thanked").text("已感谢"))});Dx(r);r=new Tt(r.get(0),location.href,j);r.$F=function(b){return b.getAttribute("data-id")};r.ci("rq-item");r.z();var r=$("#rq3-sidenav-link"),te=$(".zg-num",r);this.rA=te};a.oC=function(){};oC.prototype.z=function(){$("a.js-obfuscate-email").each(function(){var b=$(this),c=b.data("email").split("").reverse().join("");b.attr("href","mailto:"+c).text(c)})};a.pC=function(){};y(pC,T);pC.prototype.z=function(){kr.H(this);this.o(document.body)};pC.prototype.B=function(){pC.n.B.call(this);var b=$("#zh-following-question-item-list").children(".zh-general-list");if(b.length){var c=new Ct;this.H(c);c.ma("nodeSource");c.o(b.get(0))}};a.qC=function(){T.call(this)};y(qC,T);qC.prototype.B=function(){this.h().e(this.g,"click",this.mo)};qC.prototype.mo=function(b){var c=b.target;c&&"rmdraft"===c.name&&Ai("删除草稿","你确定要删除这个草稿吗？",function(b){b&&(Di("/draft/delete",k,"POST","qid="+c.id.split("-")[1]),M(this.g))},this)};a.rC=function(){};y(rC,T);rC.prototype.z=function(){var b=J("zh-draft-page-wrap");b&&this.o(b)};
rC.prototype.B=function(){O(J("zh-clear-all-draft"),"click",function(){Ai("删除所有草稿","你确定要删除所有草稿吗？删除后将无法恢复",function(b){b&&Di("/draft/clear",function(){window.location.href="/draft"},"POST")});return m});this.En()};rC.prototype.En=function(){var b=J("zh-draft-item-list");if(b){var c=new Ct;c.ma("locationSource",{Es:j}).ma("childConstructor",{Ji:qC});c.o(b)}};a.sC=function(){this.Og="explore";this.hL="explore_feed"};y(sC,T);sC.prototype.z=function(){kr.H(this);this.o(document.body)};
sC.prototype.B=function(){sC.n.B.call(this);var b=this,c=$("#js-explore-tab");if(c.length){var d=$(".tab-panel",c),e=$(".tab-nav",c),g=k;e.children().click(function(){g=Zb(document)});c=function(){var c={"daily-hot":0,"monthly-hot":1}[window.location.hash.slice(1)]||0;e.removeClass("active").eq(c).addClass("active");c=d.hide().eq(c).show().children("[data-type]");if(!c.data("inited")){c.data("inited",j);var h={daily:$x,monthly:by}[c.data("type")],h=new tC(h);h.ma("expandLimit");b.H(h);h.o(c[0])}g&&
window.scrollTo(g.x,g.y)};this.h().e(window,"hashchange",c);c()}this.bx();if(c=$("#zh-recommend-list-full>.zh-general-list")[0]){var h=new Ct;h.ma("nodeSource");ut(h,function(b){var c=iw(b);c&&(h.H(c),c.o(b))});this.H(h);h.o(c)}this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category",this.Og).fill("label",this.hL)})};sC.prototype.bx=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=ay(b).done(function(b){c.html(b)}))})};
a.tC=function(b){tt.call(this,{source:function(){return b($(this.Hb()).last().data("offset")).then(function(b){return{results:b}})},ma:["autoload"]})};y(tC,Ct);tC.prototype.B=function(){tC.n.B.call(this);this.ma("childConstructor",{Ji:cw})};a.uC=function(){T.call(this)};y(uC,T);uC.prototype.z=function(){kr.H(this);this.o(document.body)};uC.prototype.B=function(){uC.n.B.call(this);this.En()};uC.prototype.En=function(){var b=J("js-suggest-people");if(b){var c=0,d=new Ct({source:function(){return $.get("",{start:c+20,limit:20}).then(function(b){if(!b.r)return b=b.msg,b.hasmore&&(c+=20),{results:b.htmls,next:Boolean(b.hasmore)}})}});this.H(d);d.o(b)}};a.vC=function(b){function c(b,c){var d;d=d||"slug";return{source:b,filter:function(b){return b.filter(function(b){return c.every(function(c){return c[d]!==b[d]})})},select:function(b){c.push(b);return""}}}this.ct=b;b.activityUrl="";var b=this.ct,d=b.roundtable;b.topicsSuggestOpitons=c("/r/ac/topics",d.topics);b.organizationsSuggestOpitons=c("/r/ac/topics",d.organizations);b.presentersSuggestOpitons=c("/r/ac/users",d.presenters);b.guestsSuggestOpitons=c("/r/ac/users",d.guests)};vC.$inject=["$scope"];
vC.prototype.removeTag=function(b,c){b.splice((0,z.indexOf)(b,c),1)};vC.prototype.moveupTag=function(b,c){var d=(0,z.indexOf)(b,c);0<d&&(b.splice(d,1),b.splice(d-1,0,c))};vC.prototype.onActvityUrlChange=function(){var b=this.ct,c=b.activityUrl,d=b.roundtable.activityUrls;c&&-1===(0,z.indexOf)(d,c)&&(d.push(c),b.activityUrl="")};
vC.prototype.submit=function(b,c){var d="create"===c,e={roundtable:JSON.stringify(b)};if(d&&3>b.activityUrls.length)return U("请至少添加三条动态");$.post(location.pathname+location.search,e).then(function(d){d.success?"create"===c?(U(d.message||"活动创建成功，请等待审核"),setTimeout(function(){location.href="/roundtable"},3E3)):(U(d.message||"活动修改成功"),setTimeout(function(){location.href="/roundtable/"+b.slug},3E3)):U(d.message||"提交失败")})};a.wC=function(b,c){var d={Ce:5,className:"ui-suggest",Zh:"row",GC:200};G.extend(d,c||{});var e=d.X;e&&(d.Vc=ha,d.X=function(b,c){e.apply(this,arguments)!==m&&(b.Yf=Ub(b.Zh,c))});xo.call(this,b,d);var g=this.M;g.className=d.className;g.Zh=d.Zh;g.$n=d.GC};y(wC,xo);a.xC=function(b,c){return function(d,e,g){$(e).datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"});c(function(){$(e).datetimepicker("update",new Date(b(g.ngModel)(d)))})}};xC.$inject=["$parse","$timeout"];
a.yC=function(){return{scope:{id:"@id",avatar:"=avatar"},link:function(b,c){var d=new cx(4,b.id,"xl");d.o(c);d.addEventListener("success",function(){b.$apply(function(){b.avatar.id=d.getData().id})})}}},a.zC=function(b){return{scope:{options:"=suggestOptions"},link:function(c,d,e){var g,h,e={uR:'<div class="row"><img class="avatar" src="[[avatar | avatarUrl]]"><span class="name">[[name]]</span></div>',GC:100,source:e.source,Qj:d.parent()[0],X:function(b,c,d){c.innerHTML=d.map(function(b){return h(b.data)}).join("")}};
h=b(e.uR);angular.extend(e,c.options);if(e.select){var l=e.select;e.select=function(b){return c.$apply(function(){return l(b)})}}g=new wC(d[0],e);return c.$on("destroy",function(){return g.G()})}}};zC.$inject=["$interpolate"];a.AC=function(){return function(b,c){return"string"===typeof b?b:b.template.replace("{id}",b.id).replace("{size}",c||"xs")}},a.BC=function(b){b.startSymbol("[[").endSymbol("]]")};BC.$inject=["$interpolateProvider"];a.CC=function(){iC.call(this);this.Do=ph.roundtable};y(CC,iC);
CC.prototype.z=function(){kr.H(this);this.o(document.body);var b=$(".add-pending-activities-form");if(b.length){var c=$(".url",b),d=$(".time",b);d.datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"}).datetimepicker("update",new Date);var e=this.Do;b.submit(function(b){function g(b){b.success?(U("添加成功"),setTimeout(function(){location.reload()},3E3)):U(b.message||"提交失败")}b.preventDefault();if(!c.val())return U("回答或问题地址必须填写");if(!d.val())return U("发布时间必须填写");
var b=(b=c.val().match(/\/question\/\d+\/answer\/(\d+)/))&&b[1],h=c.val().match(/\/question\/(\d+)/),h=h&&h[1];b?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"answer",url_token:b},g):h?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"question",url_token:h},g):U("回答或问题地址不正确")})}var g=this.Do;$(".feeds.pending-questions").on("click",".add",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+
g.slug,{action:"approve_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})}).on("click",".remove",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+g.slug,{action:"ignore_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})});var h=this.Do;$(".feeds.pending-activities").on("click",".remove",function(){var b=$(this).data(),c=$(this).closest(".item");
$.post("/roundtable/"+h.slug,{action:"remove_pending_activity",type:b.type,url_token:b.token}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})});jC();this.Nr()};Ca("ZH.entryQuestionLog",function(){(new dC).z()});Ca("ZH.entryQuestionFollowersPage",function(){(new fC).z()});Ca("ZH.entrySQ",function(){(new NB).z()});Ca("ZH.entrySA",function(){(new WB).z()});Ca("ZH.entryL",function(){(new dy).z()});Ca("ZH.entryT",function(){(new Wx).z()});Ca("ZH.entryTS",function(){(new cC).z()});Ca("ZH.entryP",function(){(new Ex).z()});Ca("ZH.entrySearch",function(){(new kC).z()});Ca("ZH.entryPM",function(){(new Gt).z()});Ca("ZH.entryPMDetail",function(){(new Ht).z()});
Ca("ZH.entryHelp",function(){(new pt).z()});Ca("ZH.entryInvite",function(){(new lC).z()});Ca("ZH.entryTest",ba());Ca("ZH.entrySettings",function(){(new Kx).z()});Ca("ZH.entryTopicFeed",function(){(new YB).z()});Ca("ZH.entryTest",function(){(new Ts.CV).z()});Ca("ZH.entryRQ3",function(){(new nC).z()});Ca("ZH.entryTerms",function(){(new oC).z()});Ca("ZH.entryHome",function(){(new Cy).z()});Ca("ZH.entryQuestionFollowing",function(){(new pC).z()});Ca("ZH.entryDraft",function(){(new rC).z()});
Ca("ZH.entryExplore",function(){(new sC).z()});Ca("ZH.entryLookup",function(){(new uC).z()});Ca("ZH.entryCC",function(){$(function(){$("#js-apply-button").click(ol(function(){$.post("/classical-chinese");var b=$(this),c=b.data("num");b.text("您已申請使用").addClass("disabled");$(".apply-num").text("已有 "+(c+1)+" 人申請")}))})});Ca("ZH.entryRb",function(){(new iC).z()});
Ca("ZH.entryRbEdit",function(){var b=angular.module("roundtableApp",[]);b.controller("RoundtableFormCtrl",vC);b.directive("uiAvatarEditor",yC);b.directive("uiSuggest",zC);b.directive("uiTimepicker",xC);b.filter("avatarUrl",AC);b.config(BC);angular.bootstrap(document.body,["roundtableApp"])});Ca("ZH.entryRbPending",function(){(new CC).z()});Hf("app");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js